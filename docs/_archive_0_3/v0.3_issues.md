SSUES_v0.3.md
# Milestone v0.3 – Funnel Backend, Parametrisierbares Design & Mobile UI System

Zielzeitraum: 2–3 Wochen  
Scope:
- Mobile Question UI (Card-Stack + Swipe)
- Funnel Engine v2 (JSON-Config)
- Parametrisierbares Designsystem
- Redaktionelle Seiten (MDX)
- QA / Stabilisierung

---

# EPIC A — Mobile UI System (Card-Stack + Swipe)

---

## Issue A1 — Mobile Question Component (Core Layout)
**Labels:** mobile, frontend, funnel, v0.3

**Beschreibung:**  
Implementiere eine neue mobil-optimierte Frage-Komponente `<MobileQuestionCard />` im Card-Stack-Design.

**Aufgaben:**  
- Vollbild-Card-Komponente entwickeln  
- Layout für Frage, Antworten & Progressbar  
- Große tappbare Antwort-Buttons (44px+)  
- State-Management integrieren  

**Acceptance Criteria:**  
- Aktiv ab <640px  
- UI ist touch-optimiert  
- Buttons haben klare active/press States  
- Funktioniert fehlerfrei auf iOS & Android

---

## Issue A2 — Swipe Navigation (Framer Motion)
**Labels:** mobile, motion, frontend, v0.3

**Beschreibung:**  
Implementiere Swipe-Gesten für Weiter/Zurück Navigation.

**Aufgaben:**  
- Framer Motion integrieren  
- Swipe left → Next  
- Swipe right → Previous  
- Enter/Exit/Snap-back Animationen  
- Swipe-Locking & Debounce  

**Acceptance Criteria:**  
- Animation flüssig (<16ms Frame Budget)  
- Zu schwache Swipes schnappen korrekt zurück  
- Keine Doppelaktionen  

---

## Issue A3 — Mobile Answer Buttons (Variants)
**Labels:** mobile, ui, design-system, v0.3

**Beschreibung:**  
Erstelle eine konsistente mobile Variantenbibliothek für Antworten.

**Aufgaben:**  
- Scale-Chips (0–4)  
- Yes/No Buttons  
- Multi-Select Buttons  
- Animationen für Idle, Hover, Active  

**Acceptance Criteria:**  
- Alle Antworttypen funktionieren  
- WCAG Touch-Target erfüllt  
- Darstellung über JSON konfigurierbar  

---

## Issue A4 — Responsive Layout Switcher (`useIsMobile()`)
**Labels:** frontend, responsive, v0.3

**Beschreibung:**  
Automatischer Wechsel zwischen Mobile UI & Desktop UI.

**Aufgaben:**  
- Implementiere Hook `useIsMobile()`  
- Mobile Layout <640px  
- Desktop Layout ≥640px  
- Edge Cases (iPad mini) prüfen  

**Acceptance Criteria:**  
- UI wechselt ohne Reload  
- Keine doppelte UI  
- Navigation bleibt identisch  

---

## Issue A5 — Mobile Funnel Integration (Save-on-Tap)
**Labels:** mobile, backend, funnel, v0.3

**Beschreibung:**  
Mobile UI muss dieselbe JSON-Config wie Desktop nutzen und Antworten beim Tippen speichern.

**Aufgaben:**  
- Auto-Save bei Tap  
- Verarbeitung der neuen JSON-Felder  
  - `mobile_layout`  
  - `answer_display`  
  - `swipe_enabled`  
- Fehlerbehandlung mobile-first  

**Acceptance Criteria:**  
- Identisches API-Verhalten wie Desktop  
- Kein Doppel-Submit  
- Conditional Logic funktioniert sauber  

---

# EPIC B — Funnel Engine v2 (Backend + Config)

---

## Issue B1 — Erweiterte JSON Funnel Config
**Labels:** backend, config, funnel, v0.3

**Beschreibung:**  
Funnel-Config erweitern, um UI und redaktionelle Inhalte zu steuern.

**Neue Felder:**  
- `mobile_layout`  
- `answer_display`  
- `swipe_enabled`  
- `mdx_before`  
- `mdx_after`  

**Acceptance Criteria:**  
- Felder optional & rückwärtskompatibel  
- UI reagiert korrekt auf Config  
- Keine Schemaänderung nötig  

---

## Issue B2 — Answer Validation v2 (Mobile Behavior)
**Labels:** backend, validation, v0.3

**Beschreibung:**  
Neue Validierungslogik, die Auto-Save und mobile UX unterstützt.

**Aufgaben:**  
- Auto-Save implementieren  
- Validierungsfehler nur bei Navigation zeigen  
- Server-Validierung ergänzen  

**Acceptance Criteria:**  
- Kein Weiter ohne Antwort  
- Desktop-Verhalten unberührt  
- API rejectet leere Antworten sauber  

---

## Issue B3 — Navigation API Optimization (Next/Previous)
**Labels:** backend, performance, v0.3

**Beschreibung:**  
Mobile Navigation erfordert unter 150ms API-Antwortzeit.

**Aufgaben:**  
- Endpunkte optimieren  
- Race Conditions vermeiden  
- Strukturierte Logging-Events  

**Acceptance Criteria:**  
- 95% der Requests <200ms  
- Next/Previous fühlt sich „instant“ an  
- Keine Doppel-Requests  

---

# EPIC C — Parametrisierbares Designsystem

---

## Issue C1 — Global Design Tokens (Spacing, Typography, Motion)
**Labels:** design-system, frontend, v0.3

**Beschreibung:**  
Einheitliches Set neuer Design Tokens für Mobile & Desktop.

**Aufgaben:**  
- Spacing Scale erweitern  
- Font Scale Mobile (+2px)  
- Motion Tokens definieren  
- Tailwind Config aktualisieren  

**Acceptance Criteria:**  
- Tokens sind global nutzbar  
- Mobile & Desktop konsistent  

---

## Issue C2 — Neue Mobile Components (shadcn Erweiterungen)
**Labels:** frontend, ui, design-system, v0.3

**Beschreibung:**  
Mobile-spezifische shadcn-Komponenten entwickeln.

**Aufgaben:**  
- `<MobileCard />`  
- `<MobileProgress />`  
- `<MobileAnswerButton />`  
- Stateful interaktive UI-Elemente  

**Acceptance Criteria:**  
- Komponenten wirken „native-like“  
- Voll kompatibel mit Designs & Tokens  

---

# EPIC D — Redaktionelle Seiten (MDX)

---

## Issue D1 — MDX Support für Funnel Intro/Outro Pages
**Labels:** content, frontend, v0.3

**Beschreibung:**  
Funnel sollen redaktionelle MDX-Pages anzeigen können.

**Aufgaben:**  
- MDX Loader integrieren  
- Mobile-first Layout  
- Typografie & Lesbarkeit optimieren  

**Acceptance Criteria:**  
- MDX rendert zuverlässig  
- Bilder, Listen & Text funktionieren sauber  
- Responsive Design gewährleistet  

---

## Issue D2 — JSON-Steuerung der MDX Seiten
**Labels:** backend, config, content, v0.3

**Beschreibung:**  
Einbindung der neuen Content-Pages über JSON-Config.

**Aufgaben:**  
- Neue Felder `mdx_before` & `mdx_after`  
- Reihenfolgenlogik im Funnel implementieren  
- Routing entsprechend erweitern  

**Acceptance Criteria:**  
- MDX-Seiten erscheinen exakt an den definierten Positionen  
- Keine UI-Jumps oder Layoutbrüche  

---

# EPIC E — QA & Stabilisierung

---

## Issue E1 — Device Testing (iPhone + Android)
**Labels:** qa, testing, mobile, v0.3

**Beschreibung:**  
Systematisches Testen der neuen Mobile-Funnel-UI (inkl. Navigation, Save-on-Tap, Content-Pages) auf gängigen mobilen Endgeräten.

**Aufgaben:**  
- Testmatrix definieren:  
  - iPhone SE + aktuelles iPhone-Modell (Safari)  
  - Android (aktuelles Samsung oder vergleichbar, Chrome)  
- End-to-End Flows testen:  
  - Funnel starten (Neues `assessment` in `assessments` angelegt)  
  - Fragen beantworten (`assessment_answers`)  
  - Ergebnis ansehen (`reports`, ggf. `patient_measures`)  
  - Content-Pages öffnen (aus `content_pages`)  
- Auffälligkeiten dokumentieren (Screenshots, kurze Beschreibung, ggf. Log-Auszüge)

**Acceptance Criteria:**  
- Alle kritischen Flows sind auf den getesteten Geräten durchspielbar  
- Es gibt kein UI-Blocking durch unhandled Errors  
- Gefundene Bugs sind entweder gefixt oder als Folge-Issues dokumentiert

**Testing Documentation:**  
- **Comprehensive Guide:** `docs/E1_MOBILE_DEVICE_TESTING.md` - Full testing procedures and flows
- **Quick Checklist:** `docs/E1_QUICK_TESTING_CHECKLIST.md` - Print-friendly checklist for testing
- **Testing Tips:** `docs/E1_TESTING_TIPS.md` - Tips, tricks, and best practices
- **Bug Template:** `.github/ISSUE_TEMPLATE/mobile_device_bug.md` - Standardized bug reporting  

---

## Issue E2 — Recovery & Resume Test Cases
**Labels:** qa, ux, v0.3

**Aufgaben:**  
- Reload während Frage  
- Browser Back Button  
- Netzwerkverlust  
- State-Restore über Supabase  

**Acceptance Criteria:**  
- User verliert niemals Antworten  
- Funnel bricht nie ab  
- Flow bleibt vollständig konsistent  

---

## Issue E3 — Performance Optimization
**Labels:** performance, frontend, v0.3

**Aufgaben:**  
- Bundle Analysis  
- Lazy Loading  
- Memoization  
- FPS Monitoring für Swipe  

**Acceptance Criteria:**  
- Swipe 55–60 FPS  
- LCP <2.5s  
- Lighthouse Score ≥85  

---

# Ende der Datei
