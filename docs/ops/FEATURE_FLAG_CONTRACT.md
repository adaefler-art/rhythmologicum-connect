# Feature Flag Contract Matrix

Generated by scripts/dev/flag-audit/scan.js

## Single Source of Truth

| Flag | Description | Scope | Runtime | Interpretation | Risk |
| --- | --- | --- | --- | --- | --- |
| AMY_ENABLED |  | unknown | client, unknown | helper:parseEnvBoolean, unknown | HIGH |
| ANTHROPIC_API_KEY |  | unknown | unknown | unknown | LOW |
| ANTHROPIC_API_TOKEN |  | unknown | unknown | unknown | LOW |
| ANTHROPIC_MODEL |  | unknown | unknown | unknown | LOW |
| APP_NAME |  | unknown | unknown | unknown | LOW |
| APP_VERSION |  | unknown | unknown | unknown | LOW |
| BASE_SHA |  | unknown | unknown | unknown | LOW |
| CHARTS_ENABLED |  | unknown | client, unknown | helper:parseEnvBoolean, unknown | HIGH |
| CLINICIAN_DASHBOARD_ENABLED |  | unknown | unknown | helper:parseEnvBoolean, unknown | HIGH |
| CONTENT_API_ENABLED |  | unknown | unknown | unknown | LOW |
| DEV_COMPONENTS_PAGE |  | unknown | unknown | unknown | LOW |
| DEV_ENDPOINT_CATALOG |  | unknown | unknown | eq_1, unknown | HIGH |
| DEV_FIXTURE__ |  | unknown | unknown | unknown | LOW |
| DEV_FIXTURE__ASSESSMENTS |  | unknown | client, unknown | unknown | HIGH |
| DEV_FIXTURE__QUESTIONS |  | unknown | client, unknown | unknown | HIGH |
| DEV_QUICK_FILLS |  | unknown | client, unknown | unknown | HIGH |
| DEV_SETUP |  | unknown | unknown | unknown | LOW |
| E73_3_IMPLEMENTATION_SUMMARY |  | unknown | unknown | unknown | LOW |
| E73_3_SECURITY_SUMMARY |  | unknown | unknown | unknown | LOW |
| E73_4_RESULT_SSOT |  | unknown | unknown | eq_true, unknown | HIGH |
| E73_5_IMPLEMENTATION_SUMMARY |  | unknown | unknown | unknown | LOW |
| E73_5_RULES_VS_CHECKS_MATRIX |  | unknown | unknown | unknown | LOW |
| ENGINE_BASE_URL |  | unknown | unknown | unknown | LOW |
| GITHUB_TOKEN |  | unknown | unknown | unknown | LOW |
| HEAD_SHA |  | unknown | unknown | unknown | LOW |
| LINT_BASE_REF |  | unknown | unknown | unknown | LOW |
| NEW_FEATURE_ENABLED |  | unknown | unknown | helper:parseEnvBoolean, unknown | HIGH |
| NEXT_PHASE |  | unknown | unknown | unknown | LOW |
| NEXT_PUBLIC_BASE_URL |  | unknown | unknown | unknown | LOW |
| NEXT_PUBLIC_DEV_HARNESS_ENABLED |  | unknown | unknown | eq_true, unknown | HIGH |
| NEXT_PUBLIC_FEATURE_AMY_ENABLED | Enable/disable AMY AI assistant (default: true) | unknown | unknown | unknown | LOW |
| NEXT_PUBLIC_FEATURE_CHARTS_ENABLED | Enable/disable charts in clinician views (default: true) | unknown | unknown | unknown | LOW |
| NEXT_PUBLIC_FEATURE_CLINICIAN_DASHBOARD_ENABLED | Enable/disable clinician dashboard (default: true) | unknown | unknown | helper:parseEnvBoolean, unknown | HIGH |
| NEXT_PUBLIC_FEATURE_NEW_FEATURE_ENABLED |  | unknown | unknown | unknown | LOW |
| NEXT_PUBLIC_FEATURE_PROCESSING_RESULTS_ENABLED | Enable/disable processing results endpoint (default: false) | unknown | client, unknown | unknown | LOW |
| NEXT_PUBLIC_LOGROCKET_ID |  | unknown | unknown | unknown | LOW |
| NEXT_PUBLIC_PILOT_ENABLED |  | unknown | unknown | eq_true, unknown | HIGH |
| NEXT_PUBLIC_PILOT_ENV |  | unknown | unknown | unknown | LOW |
| NEXT_PUBLIC_SENTRY_DSN |  | unknown | unknown | unknown | LOW |
| NEXT_PUBLIC_SUPABASE_ANON_KEY |  | unknown | unknown | truthy, unknown | HIGH |
| NEXT_PUBLIC_SUPABASE_URL |  | unknown | unknown | unknown | LOW |
| NODE_ENV |  | unknown | unknown | unknown | LOW |
| PATIENT_BASE_URL |  | unknown | unknown | unknown | LOW |
| PILOT_ADMIN_COOKIE |  | unknown | unknown | unknown | LOW |
| PILOT_AUTH_COOKIE |  | unknown | unknown | unknown | LOW |
| PILOT_BASE_URL |  | unknown | unknown | unknown | LOW |
| PILOT_ENV |  | unknown | unknown | unknown | LOW |
| PILOT_FLOW_EVENTS |  | unknown | unknown | unknown | LOW |
| PILOT_NOT_ELIGIBLE |  | unknown | unknown | unknown | LOW |
| PILOT_ORG_ALLOWLIST |  | unknown | unknown | unknown | LOW |
| PILOT_PATIENT_COOKIE |  | unknown | unknown | unknown | LOW |
| PILOT_READINESS_CHECKLIST |  | unknown | unknown | unknown | LOW |
| PILOT_SMOKE_TESTS |  | unknown | unknown | unknown | LOW |
| PILOT_SPINE |  | unknown | unknown | unknown | LOW |
| PILOT_USER_ALLOWLIST |  | unknown | unknown | unknown | LOW |
| PROCESSING_RESULTS_ENABLED |  | unknown | client, unknown | helper:parseEnvBoolean, unknown | HIGH |
| REVIEW_SAMPLING_PERCENTAGE |  | unknown | unknown | unknown | LOW |
| REVIEW_SAMPLING_SALT |  | unknown | unknown | unknown | LOW |
| STUDIO_BASE_URL |  | unknown | unknown | unknown | LOW |
| SUPABASE |  | unknown | unknown | unknown | LOW |
| SUPABASE_SERVICE_KEY |  | unknown | unknown | unknown | LOW |
| SUPABASE_SERVICE_ROLE_KEY |  | unknown | unknown | unknown | LOW |
| SUPABASE_URL |  | unknown | unknown | unknown | LOW |
| TEST_API_BASE |  | unknown | unknown | unknown | LOW |
| USAGE_TELEMETRY_ENABLED |  | unknown | unknown | truthy, unknown | HIGH |
| VERCEL_ENV |  | unknown | unknown | unknown | LOW |
| VERCEL_URL |  | unknown | unknown | unknown | LOW |

## Inconsistencies

- Flags with >1 interpretation: AMY_ENABLED, CHARTS_ENABLED, CLINICIAN_DASHBOARD_ENABLED, DEV_ENDPOINT_CATALOG, E73_4_RESULT_SSOT, NEW_FEATURE_ENABLED, NEXT_PUBLIC_DEV_HARNESS_ENABLED, NEXT_PUBLIC_FEATURE_CLINICIAN_DASHBOARD_ENABLED, NEXT_PUBLIC_PILOT_ENABLED, NEXT_PUBLIC_SUPABASE_ANON_KEY, PROCESSING_RESULTS_ENABLED, USAGE_TELEMETRY_ENABLED
- Flags read in client code but not NEXT_PUBLIC_*: AMY_ENABLED, CHARTS_ENABLED, DEV_FIXTURE__ASSESSMENTS, DEV_FIXTURE__QUESTIONS, DEV_QUICK_FILLS, PROCESSING_RESULTS_ENABLED
- Flags only referenced in dev/tests: none
- Flags ending in _ENABLED but used as truthy: USAGE_TELEMETRY_ENABLED

## Recommended Standard

- Helper: flagEnabled(value) accepts: '1', 'true', 'yes', 'on'
- Deployment value: '1'
- Prefer helper usage over direct comparisons

## Deployment Checklist

### patient

- Required env: NEXT_PUBLIC_SUPABASE_URL, NEXT_PUBLIC_SUPABASE_ANON_KEY, ENGINE_BASE_URL
- Feature flags expected: none detected

### studio

- Required env: NEXT_PUBLIC_SUPABASE_URL, NEXT_PUBLIC_SUPABASE_ANON_KEY
- Feature flags expected: none detected

### legacy

- Required env: none specified
- Feature flags expected: none detected

### engine

- Required env: NEXT_PUBLIC_SUPABASE_URL, NEXT_PUBLIC_SUPABASE_ANON_KEY, SUPABASE_SERVICE_ROLE_KEY
- Note: SUPABASE_SERVICE_ROLE_KEY required in prod server runtime
- Feature flags expected: none detected
