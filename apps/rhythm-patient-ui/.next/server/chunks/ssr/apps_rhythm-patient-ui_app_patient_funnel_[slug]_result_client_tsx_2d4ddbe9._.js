module.exports=[56449,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(14091),f=a.i(67733);a.i(59620);var g=a.i(86071),h=a.i(63156),i=a.i(90441),j=a.i(46822),k=a.i(63548);a.i(14240);var l=a.i(76756);function m({score:a,maxScore:c=100,level:d="medium",label:e="Stresslevel",description:f="Ihre aktuelle Bewertung"}){let g=(()=>{switch(d){case"low":return{bg:"bg-green-50",border:"border-green-200",text:"text-green-900",icon:"âœ“",iconBg:"bg-green-100",badge:"bg-green-100 text-green-800"};case"high":return{bg:"bg-red-50",border:"border-red-200",text:"text-red-900",icon:"âš ",iconBg:"bg-red-100",badge:"bg-red-100 text-red-800"};default:return{bg:"bg-amber-50",border:"border-amber-200",text:"text-amber-900",icon:"â—†",iconBg:"bg-amber-100",badge:"bg-amber-100 text-amber-800"}}})(),h=void 0!==a?Math.round(a/c*100):0;return(0,b.jsx)(k.Card,{padding:"lg",radius:"2xl",shadow:"lg",border:!0,className:`${g.bg} ${g.border} border-2`,children:(0,b.jsxs)("div",{className:"flex items-start gap-4",children:[(0,b.jsx)("div",{className:`flex-shrink-0 w-14 h-14 sm:w-16 sm:h-16 ${g.iconBg} rounded-full flex items-center justify-center`,children:(0,b.jsx)("span",{className:"text-2xl sm:text-3xl",children:g.icon})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("p",{className:"text-sm sm:text-base text-slate-600 mb-1",children:f}),(0,b.jsx)("h3",{className:`text-2xl sm:text-3xl md:text-4xl font-bold ${g.text} mb-2`,style:{lineHeight:l.typography.lineHeight.tight},children:void 0!==a?`${a}/${c}`:"â€”"}),(0,b.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,b.jsx)("span",{className:`inline-block px-3 py-1 rounded-full text-xs sm:text-sm font-semibold ${g.badge}`,children:e}),h>0&&(0,b.jsxs)("span",{className:"text-xs sm:text-sm text-slate-600",children:[h,"%"]})]})]})]})})}function n({segments:a=[],title:c="Stressverteilung",description:d="Ãœbersicht Ihrer Stressbereiche"}){let e=a.reduce((a,b)=>a+b.value,0),f=a.length>0?a:[{label:"KÃ¶rperlich",value:30,color:"bg-red-500"},{label:"Emotional",value:45,color:"bg-amber-500"},{label:"Kognitiv",value:25,color:"bg-primary-500"}];return(0,b.jsxs)(k.Card,{padding:"lg",radius:"xl",shadow:"md",border:!0,className:"bg-white",children:[(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("h3",{className:"text-lg sm:text-xl font-bold text-slate-900 mb-1",style:{lineHeight:l.typography.lineHeight.tight},children:c}),(0,b.jsx)("p",{className:"text-sm sm:text-base text-slate-600",children:d})]}),(0,b.jsx)("div",{className:"mb-4",children:(0,b.jsx)("div",{className:"h-3 sm:h-4 bg-slate-200 rounded-full overflow-hidden flex",children:f.map((a,c)=>{let d=e>0?a.value/e*100:0;return(0,b.jsx)("div",{className:`${a.color} transition-all duration-300`,style:{width:`${d}%`},title:`${a.label}: ${Math.round(d)}%`},c)})})}),(0,b.jsx)("div",{className:"flex flex-wrap gap-3",children:f.map((a,c)=>{let d=e>0?Math.round(a.value/e*100):0;return(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("div",{className:`w-3 h-3 sm:w-4 sm:h-4 ${a.color} rounded-sm`}),(0,b.jsxs)("span",{className:"text-xs sm:text-sm text-slate-700",children:[a.label,(0,b.jsxs)("span",{className:"text-slate-500 ml-1",children:["(",d,"%)"]})]})]},c)})}),0===a.length&&(0,b.jsx)("div",{className:"mt-4 p-3 bg-slate-50 border border-slate-200 rounded-lg",children:(0,b.jsx)("p",{className:"text-xs sm:text-sm text-slate-600 italic",children:"ðŸ’¡ Diese Visualisierung wird basierend auf Ihren konkreten Antworten erstellt, sobald die detaillierte Auswertung verfÃ¼gbar ist."})})]})}function o({actions:a,title:c="NÃ¤chste Schritte",description:d="Was kÃ¶nnen Sie jetzt tun?"}){return 0===a.length?null:(0,b.jsxs)(k.Card,{padding:"lg",radius:"xl",shadow:"md",border:!0,className:"bg-gradient-to-br from-sky-50 to-blue-50 dark:from-sky-900/20 dark:to-blue-900/20 border-sky-200 dark:border-sky-800",children:[(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)("span",{className:"text-2xl",children:"ðŸŽ¯"}),(0,b.jsx)("h3",{className:"text-lg sm:text-xl font-bold text-slate-900 dark:text-slate-100",style:{lineHeight:l.typography.lineHeight.tight},children:c})]}),(0,b.jsx)("p",{className:"text-sm sm:text-base text-slate-700 dark:text-slate-300",children:d})]}),(0,b.jsx)("div",{className:"space-y-3",children:a.map((a,c)=>(0,b.jsx)("div",{className:"bg-white dark:bg-slate-800 border border-sky-200 dark:border-sky-800 rounded-lg p-4 hover:shadow-md transition-shadow",children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("div",{className:"flex-shrink-0 w-8 h-8 bg-sky-100 dark:bg-sky-900/40 text-sky-700 dark:text-sky-400 rounded-full flex items-center justify-center font-bold text-sm",children:a.icon||`${c+1}`}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsx)("h4",{className:"text-base sm:text-lg font-semibold text-slate-900 dark:text-slate-100 mb-1",style:{lineHeight:l.typography.lineHeight.tight},children:a.title}),(0,b.jsx)("p",{className:"text-sm sm:text-base text-slate-700 dark:text-slate-300 mb-2",style:{lineHeight:l.typography.lineHeight.relaxed},children:a.description}),(a.actionLabel||a.actionUrl||a.onClick)&&(0,b.jsx)("div",{children:a.actionUrl?(0,b.jsxs)("a",{href:a.actionUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-block text-sm sm:text-base font-medium text-sky-700 dark:text-sky-400 hover:text-sky-900 dark:hover:text-sky-300 hover:underline",children:[a.actionLabel||"Mehr erfahren"," â†’"]}):a.onClick?(0,b.jsxs)("button",{onClick:a.onClick,className:"text-sm sm:text-base font-medium text-sky-700 dark:text-sky-400 hover:text-sky-900 dark:hover:text-sky-300 hover:underline",children:[a.actionLabel||"Mehr erfahren"," â†’"]}):null})]})]})},c))})]})}var p=a.i(62180),q=a.i(58348);function r({text:a,title:c="Ihre persÃ¶nliche Auswertung",icon:d="ðŸ¤–"}){return a&&""!==a.trim()?(0,b.jsxs)(k.Card,{padding:"lg",radius:"xl",shadow:"md",border:!0,className:"bg-white",children:[(0,b.jsxs)("div",{className:"mb-4 pb-4 border-b border-slate-200",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-2xl",children:d}),(0,b.jsx)("h3",{className:"text-lg sm:text-xl font-bold text-slate-900",style:{lineHeight:l.typography.lineHeight.tight},children:c})]}),(0,b.jsx)("p",{className:"text-xs sm:text-sm text-slate-500 mt-1",children:"Erstellt von AMY, Ihrer digitalen Gesundheitsassistentin"})]}),(0,b.jsx)("div",{className:"amy-text-content prose prose-slate max-w-none",style:{fontSize:l.typography.fontSize.base,lineHeight:l.typography.lineHeight.relaxed},children:(0,b.jsx)(p.default,{remarkPlugins:[q.default],components:{h1:({children:a})=>(0,b.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-900 mb-3",style:{lineHeight:l.typography.lineHeight.tight},children:a}),h2:({children:a})=>(0,b.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-slate-900 mb-3 mt-6",style:{lineHeight:l.typography.lineHeight.tight},children:a}),h3:({children:a})=>(0,b.jsx)("h3",{className:"text-lg sm:text-xl font-semibold text-slate-900 mb-2 mt-4",style:{lineHeight:l.typography.lineHeight.tight},children:a}),p:({children:a})=>(0,b.jsx)("p",{className:"text-sm sm:text-base text-slate-700 mb-4",style:{lineHeight:l.typography.lineHeight.relaxed},children:a}),ul:({children:a})=>(0,b.jsx)("ul",{className:"list-disc list-inside space-y-2 mb-4 text-sm sm:text-base text-slate-700",children:a}),ol:({children:a})=>(0,b.jsx)("ol",{className:"list-decimal list-inside space-y-2 mb-4 text-sm sm:text-base text-slate-700",children:a}),li:({children:a})=>(0,b.jsx)("li",{style:{lineHeight:l.typography.lineHeight.relaxed},children:a}),strong:({children:a})=>(0,b.jsx)("strong",{className:"font-semibold text-slate-900",children:a}),em:({children:a})=>(0,b.jsx)("em",{className:"italic text-slate-800",children:a}),code:({children:a})=>(0,b.jsx)("code",{className:"px-1.5 py-0.5 bg-slate-100 text-slate-800 rounded text-sm font-mono",children:a}),blockquote:({children:a})=>(0,b.jsx)("blockquote",{className:"border-l-4 border-sky-500 pl-4 py-2 my-4 bg-sky-50 text-slate-700 italic",children:a}),a:({href:a,children:c})=>(0,b.jsx)("a",{href:a,target:"_blank",rel:"noopener noreferrer",className:"text-sky-700 hover:text-sky-900 underline",children:c})},children:a})})]}):null}function s({reports:a}){return 0===a.length?(0,b.jsx)("div",{className:"bg-white border border-slate-200 rounded-xl p-8 shadow-sm",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full mb-4",style:{backgroundColor:"var(--color-neutral-100)"},children:(0,b.jsx)("span",{className:"text-3xl",children:"ðŸ“„"})}),(0,b.jsx)("h3",{className:"text-lg font-bold text-slate-900 mb-2",children:"Keine Berichte verfÃ¼gbar"}),(0,b.jsx)("p",{className:"text-sm text-slate-600",children:"Es sind noch keine Berichte fÃ¼r dieses Assessment vorhanden."}),(0,b.jsx)("p",{className:"text-sm text-slate-600 mt-2",children:"Berichte werden automatisch erstellt, sobald Ihr Assessment ausgewertet wurde."})]})}):(0,b.jsxs)("div",{className:"bg-white border border-slate-200 rounded-xl p-6 shadow-sm",children:[(0,b.jsxs)("div",{className:"flex items-start gap-3 mb-4",children:[(0,b.jsx)("span",{className:"text-2xl flex-shrink-0",children:"ðŸ“š"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h3",{className:"text-lg sm:text-xl font-bold text-slate-900",children:"Ihre Berichte"}),(0,b.jsx)("p",{className:"text-sm text-slate-600 mt-1",children:1===a.length?"1 Bericht verfÃ¼gbar":`${a.length} Berichte verf\xfcgbar`})]})]}),(0,b.jsx)("div",{className:"space-y-3",children:a.map(a=>(0,b.jsx)("div",{className:"border border-slate-200 rounded-lg p-4 hover:bg-slate-50 transition-colors",children:(0,b.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)("span",{className:"text-lg",children:"ðŸ“„"}),(0,b.jsx)("span",{className:"font-medium text-slate-900",children:"Assessment-Bericht"})]}),a.report_text_short&&(0,b.jsx)("p",{className:"text-sm text-slate-600 mb-2 line-clamp-2",children:a.report_text_short}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-3 text-xs text-slate-500",children:[(0,b.jsx)("span",{children:new Intl.DateTimeFormat("de-DE",{dateStyle:"medium",timeStyle:"short"}).format(new Date(a.created_at))}),a.risk_level&&(0,b.jsxs)("span",{className:"flex items-center gap-1",children:["â€¢",(0,b.jsx)("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${"low"===a.risk_level?"bg-green-100 text-green-800":"moderate"===a.risk_level?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:"low"===a.risk_level?"Niedriges Risiko":"moderate"===a.risk_level?"Moderates Risiko":"Hohes Risiko"})]})]})]}),(0,b.jsx)("button",{onClick:()=>{alert("Download-Funktion wird in KÃ¼rze verfÃ¼gbar sein.")},className:"flex-shrink-0 px-3 py-2 text-sm text-sky-700 hover:text-sky-900 hover:bg-sky-50 rounded transition-colors","aria-label":"Bericht anzeigen",children:"Anzeigen"})]})},a.id))})]})}function t({outcomes:a}){return a?null===a.score_numeric&&null===a.sleep_score&&null===a.risk_level?(0,b.jsx)("div",{className:"bg-white border border-slate-200 rounded-xl p-6 shadow-sm",children:(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full mb-4",style:{backgroundColor:"var(--color-neutral-100)"},children:(0,b.jsx)("span",{className:"text-3xl",children:"ðŸ“Š"})}),(0,b.jsx)("h3",{className:"text-lg font-bold text-slate-900 mb-2",children:"Auswertung wird vorbereitet"}),(0,b.jsx)("p",{className:"text-sm text-slate-600",children:"Ihre detaillierten Ergebnisse werden in KÃ¼rze verfÃ¼gbar sein."})]})}):(0,b.jsxs)("div",{className:"bg-white border border-slate-200 rounded-xl p-6 shadow-sm",children:[(0,b.jsxs)("div",{className:"flex items-start gap-3 mb-4",children:[(0,b.jsx)("span",{className:"text-2xl flex-shrink-0",children:"ðŸ“Š"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h3",{className:"text-lg sm:text-xl font-bold text-slate-900",children:"Wichtige Ergebnisse"}),(0,b.jsx)("p",{className:"text-sm text-slate-600 mt-1",children:"Zusammenfassung Ihrer Bewertung"})]})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[null!==a.score_numeric&&(0,b.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4",children:[(0,b.jsx)("div",{className:"text-xs text-slate-500 uppercase tracking-wide mb-2",children:"Stress-Level"}),(0,b.jsxs)("div",{className:"text-2xl font-bold text-slate-900 mb-1",children:[a.score_numeric,(0,b.jsx)("span",{className:"text-base text-slate-500",children:"/100"})]}),(0,b.jsx)("div",{className:"w-full bg-slate-200 rounded-full h-2",children:(0,b.jsx)("div",{className:"h-2 rounded-full bg-sky-600",style:{width:`${a.score_numeric}%`}})})]}),null!==a.sleep_score&&(0,b.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4",children:[(0,b.jsx)("div",{className:"text-xs text-slate-500 uppercase tracking-wide mb-2",children:"Schlaf-QualitÃ¤t"}),(0,b.jsxs)("div",{className:"text-2xl font-bold text-slate-900 mb-1",children:[a.sleep_score,(0,b.jsx)("span",{className:"text-base text-slate-500",children:"/100"})]}),(0,b.jsx)("div",{className:"w-full bg-slate-200 rounded-full h-2",children:(0,b.jsx)("div",{className:"h-2 rounded-full bg-indigo-600",style:{width:`${a.sleep_score}%`}})})]}),a.risk_level&&(0,b.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4",children:[(0,b.jsx)("div",{className:"text-xs text-slate-500 uppercase tracking-wide mb-2",children:"Risiko-Einstufung"}),(0,b.jsx)("div",{className:`inline-flex items-center px-3 py-1.5 rounded-full text-sm font-semibold ${"low"===a.risk_level?"bg-green-100 text-green-800":"moderate"===a.risk_level?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:"low"===a.risk_level?"âœ“ Niedrig":"moderate"===a.risk_level?"âš  Moderat":"âš  Hoch"}),(0,b.jsx)("p",{className:"text-xs text-slate-600 mt-2",children:"low"===a.risk_level?"Gute BewÃ¤ltigungsstrategien":"moderate"===a.risk_level?"UnterstÃ¼tzung empfohlen":"Professionelle Beratung empfohlen"})]})]}),a.total_reports>0&&(0,b.jsx)("div",{className:"mt-4 pt-4 border-t border-slate-200",children:(0,b.jsxs)("p",{className:"text-xs text-slate-500 text-center",children:["Basierend auf ",a.total_reports," ",1===a.total_reports?"Bericht":"Berichten"]})})]}):null}function u({status:a,missingDataFields:c=[]}){if(!a)return null;let d="needs_more_data"===a,e=d?{icon:"ðŸ“‹",title:"Weitere Angaben erforderlich",description:"Um Ihre Betreuung optimal zu gestalten, benÃ¶tigen wir noch einige zusÃ¤tzliche Informationen.",bgColor:"from-amber-50 to-orange-50 dark:from-amber-900/20 dark:to-orange-900/20",borderColor:"border-amber-200 dark:border-amber-800",statusLabel:"Daten ergÃ¤nzen",statusColor:"text-amber-700 dark:text-amber-400"}:{icon:"âœ…",title:"Assessment vollstÃ¤ndig",description:"Ihre Angaben sind vollstÃ¤ndig und werden fÃ¼r die weitere Betreuung verwendet.",bgColor:"from-emerald-50 to-green-50 dark:from-emerald-900/20 dark:to-green-900/20",borderColor:"border-emerald-200 dark:border-emerald-800",statusLabel:"Bereit zur Auswertung",statusColor:"text-emerald-700 dark:text-emerald-400"};return(0,b.jsxs)(k.Card,{padding:"lg",radius:"xl",shadow:"md",border:!0,className:`bg-gradient-to-br ${e.bgColor} ${e.borderColor}`,children:[(0,b.jsxs)("div",{className:"flex items-start gap-3 mb-4",children:[(0,b.jsx)("span",{className:"text-3xl flex-shrink-0",children:e.icon}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,b.jsx)("h3",{className:"text-lg sm:text-xl font-bold text-slate-900 dark:text-slate-100",style:{lineHeight:l.typography.lineHeight.tight},children:e.title}),(0,b.jsx)("span",{className:`text-xs sm:text-sm font-semibold px-2 py-1 rounded-full ${e.statusColor} bg-white dark:bg-slate-800`,children:e.statusLabel})]}),(0,b.jsx)("p",{className:"text-sm sm:text-base text-slate-700 dark:text-slate-300",children:e.description})]})]}),d&&c.length>0&&(0,b.jsxs)("div",{className:"mt-4 pt-4 border-t border-amber-200 dark:border-amber-800",children:[(0,b.jsx)("h4",{className:"text-sm sm:text-base font-semibold text-slate-900 dark:text-slate-100 mb-2",children:"Fehlende Informationen:"}),(0,b.jsx)("ul",{className:"space-y-1",children:c.map((a,c)=>{var d;return(0,b.jsxs)("li",{className:"text-sm text-slate-700 dark:text-slate-300 flex items-center gap-2",children:[(0,b.jsx)("span",{className:"text-amber-600 dark:text-amber-400",children:"â€¢"}),(0,b.jsx)("span",{children:{sleep_quality:"SchlafqualitÃ¤t",stress_triggers:"StressauslÃ¶ser",daily_routine:"Tagesablauf",exercise_frequency:"BewegungshÃ¤ufigkeit",nutrition_habits:"ErnÃ¤hrungsgewohnheiten",social_support:"Soziale UnterstÃ¼tzung",work_stress:"Arbeitsstress",family_history:"Familienanamnese"}[d=a]||`[${d}]`})]},c)})})]})]})}var v=a.i(8184),w=a.i(1026),x=a.i(73570),y=a.i(64791);let z=(0,a.i(70106).default)("stethoscope",[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]]);var A=a.i(12127);function B({reasons:a,correlationId:d,onCtaClick:e}){let[f,g]=(0,c.useState)(null),h=a=>{g(a),e?.(a)};return(0,b.jsxs)(k.Card,{padding:"lg",radius:"xl",shadow:"lg",border:!0,className:"bg-gradient-to-br from-red-50 to-orange-50 dark:from-red-900/20 dark:to-orange-900/20 border-red-300 dark:border-red-800",children:[(0,b.jsxs)("div",{className:"flex items-start gap-3 mb-4",children:[(0,b.jsx)("div",{className:"flex-shrink-0 w-12 h-12 bg-red-100 dark:bg-red-900/40 rounded-full flex items-center justify-center",children:(0,b.jsx)(x.AlertTriangle,{className:"w-6 h-6 text-red-600 dark:text-red-400"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h3",{className:"text-xl font-bold text-red-900 dark:text-red-100 mb-2",style:{lineHeight:l.typography.lineHeight.tight},children:"Wichtiger Hinweis zu Ihrem Ergebnis"}),(0,b.jsx)("p",{className:"text-sm text-red-800 dark:text-red-200",children:A.ESCALATION_DISCLAIMER.intro})]})]}),(0,b.jsxs)("div",{className:"mb-6 p-4 bg-white dark:bg-slate-800 rounded-lg border border-red-200 dark:border-red-800",children:[(0,b.jsx)("p",{className:"text-sm text-slate-700 dark:text-slate-300 mb-2",children:(0,b.jsxs)("strong",{children:[A.ESCALATION_DISCLAIMER.title,":"]})}),(0,b.jsx)("ul",{className:"space-y-1 text-sm text-slate-700 dark:text-slate-300",children:a.map((a,c)=>(0,b.jsxs)("li",{className:"flex items-start gap-2",children:[(0,b.jsx)("span",{className:"text-red-600 dark:text-red-400 flex-shrink-0",children:"â€¢"}),(0,b.jsx)("span",{children:a})]},c))})]}),(0,b.jsxs)("div",{className:"mb-6 p-4 bg-red-100 dark:bg-red-900/30 rounded-lg",children:[(0,b.jsx)(w.EmergencyContactInfo,{variant:"compact",title:A.RED_FLAG_EMERGENCY_WARNING.title,showAll:!1}),(0,b.jsx)("p",{className:"text-sm text-red-800 dark:text-red-200 mt-2 ml-6",children:A.RED_FLAG_EMERGENCY_WARNING.urgentAction})]}),(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)(v.Button,{variant:"danger",size:"lg",fullWidth:!0,onClick:()=>h("video_consultation"),disabled:null!==f,className:"flex items-center justify-center gap-2",children:[(0,b.jsx)(y.Video,{className:"w-5 h-5"}),"video_consultation"===f?"Wird vorbereitet...":"Video-Sprechstunde anfordern"]}),(0,b.jsxs)(v.Button,{variant:"outline",size:"lg",fullWidth:!0,onClick:()=>h("doctor_appointment"),disabled:null!==f,className:"flex items-center justify-center gap-2",children:[(0,b.jsx)(z,{className:"w-5 h-5"}),"doctor_appointment"===f?"Wird vorbereitet...":"Arzttermin vereinbaren"]})]}),(0,b.jsxs)("p",{className:"mt-4 text-xs text-slate-500 dark:text-slate-400 text-center",children:["Correlation ID: ",d.substring(0,16),"..."]})]})}var C=a.i(83160),D=a.i(35958);let E=["request_id","correlation_id","algorithm_version","prompt_version","report_version","version","safety_score","finding_count","status_from","status_to","assigned_to_role","reason","consent_type","granted","rollout_percent","rollout_percent_from","rollout_percent_to","is_active","assessment_id","report_id","task_id","funnel_id","version_id","consent_id","config_key","consent_version","profile_updated","review_id","job_id","decision_reason","has_notes","deletion_reason","scheduled_for","retention_period_days","records_deleted","records_anonymized","executed_by","anonymization_reason","kpi_event","funnel_slug","drop_off_reason","current_step_id","step_order_index","duration_seconds","duration_before_drop_seconds","started_at","completed_at","time_to_report_seconds","report_created_at","error_type"],F=["content","text","notes","answers","answer","response","extracted_data","clinical_notes","patient_notes","observation","diagnosis","medication","name","email","phone","address","ssn","dob","date_of_birth"];function G(a,b=5e3){if(!a||"object"!=typeof a)return{};let c={},d=0;for(let[e,f]of Object.entries(a)){let a=e.toLowerCase();if(F.some(b=>a.includes(b))){c[e]="[REDACTED]";continue}let g=E.includes(e);if("number"==typeof f||"boolean"==typeof f)c[e]=f,d+=String(f).length;else if("string"==typeof f){let b=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(f),h=f.length<=100&&!/[<>{}]/.test(f);g||b||h&&a.includes("id")?(c[e]=f,d+=f.length):c[e]="[REDACTED]"}else null==f?c[e]=f:"object"!=typeof f||Array.isArray(f)?c[e]="[REDACTED]":(c[e]=G(f,b-d),d+=JSON.stringify(c[e]).length);if(d>b){console.warn("[audit/log] Metadata/diff size exceeded limit, truncating");break}}return c}async function H(a){Date.now();try{let b,c;if(!a.entity_type)return{success:!1,error:"entity_type is required"};if(!a.entity_id)return{success:!1,error:"entity_id is required"};if(!a.action)return{success:!1,error:"action is required"};if(!a.source)return{success:!1,error:"source is required"};let d=(b=D.env.NEXT_PUBLIC_SUPABASE_URL||D.env.SUPABASE_URL,c=D.env.SUPABASE_SERVICE_ROLE_KEY||D.env.SUPABASE_SERVICE_KEY,b&&c?(0,C.createClient)(b,c,{auth:{persistSession:!1}}):(console.error("[audit/log] Missing Supabase credentials"),null));if(!d)return console.error("[audit/log] Cannot create Supabase client"),{success:!1,error:"Supabase client unavailable"};let e=G(a.metadata||{}),f={};a.diff?.before&&(f.before=G(a.diff.before)),a.diff?.after&&(f.after=G(a.diff.after)),a.diff?.changes&&(f.changes=G(a.diff.changes));let g={org_id:a.org_id||null,actor_user_id:a.actor_user_id||null,actor_role:a.actor_role||null,source:a.source,entity_type:a.entity_type,entity_id:a.entity_id,action:a.action,diff:f||{},metadata:e||{}},{data:h,error:i}=await d.from("audit_log").insert(g).select("id").single();if(i)return console.error("[audit/log] Failed to insert audit event",{error:i,entity_type:a.entity_type,entity_id:a.entity_id,action:a.action}),{success:!1,error:i.message};return Date.now(),{success:!0,audit_id:h.id}}catch(a){return console.error("[audit/log] Unexpected error logging audit event",a),{success:!1,error:a instanceof Error?a.message:"Unknown error"}}}var I=a.i(41975);async function J(a,b,c,d){return await H({entity_type:I.AUDIT_ENTITY_TYPE.ASSESSMENT,entity_id:a,action:I.AUDIT_ACTION.FLAG,source:I.AUDIT_SOURCE.SYSTEM,metadata:{correlation_id:b,red_flag_severity:c,red_flag_source:d}})}let K="Fehler beim Laden der Ergebnisse.";function L({slug:a,assessmentId:k,reports:l,keyOutcomes:p}){let q=(0,d.useRouter)(),v=(0,f.useIsMobile)(),[w,x]=(0,c.useState)(!0),[y,z]=(0,c.useState)(null),[A,C]=(0,c.useState)(null),[D,E]=(0,c.useState)([]),[F,G]=(0,c.useState)(!1),[H,I]=(0,c.useState)(null),L=A?.funnel??a,M=A?.funnelTitle??"";if((0,c.useEffect)(()=>{(async()=>{try{var b;let c,d;x(!0),z(null);let e=await fetch(`/api/funnels/${a}/assessments/${k}/result`,{credentials:"include"});if(!e.ok){let a=await e.json().catch(()=>null),b=a?.error?.message||K;throw Error(b)}let f=await e.json();if(!f.success||!f.data)throw Error(f.error?.message||K);if("completed"!==f.data.status){C(f.data),x(!1);return}C(f.data);let g=(b={assessmentId:f.data.id,reportId:l[0]?.id,riskLevel:p?.risk_level||null,workupStatus:f.data.workupStatus||null,missingDataFields:f.data.missingDataFields||[]},c=[],d=`esc-${"undefined"!=typeof crypto&&"randomUUID"in crypto?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).slice(2,11)}`}`,"high"===b.riskLevel&&c.push({severity:"critical",source:"report_risk_level",reason:"Hohes Stressniveau erkannt â€“ Ã¤rztliche RÃ¼cksprache empfohlen",triggeredBy:b.reportId?[b.reportId]:void 0}),{shouldEscalate:c.length>0,redFlags:c,correlationId:d});if(g.shouldEscalate){I({shouldEscalate:!0,reasons:g.redFlags.map(a=>a.reason),correlationId:g.correlationId});let a=g.redFlags[0];a&&await J(f.data.id,g.correlationId,a.severity,a.source).catch(a=>{console.error("[escalation] Failed to log offer shown:",a)})}try{let a=await fetch(`/api/funnels/${f.data.funnel}/content-pages`);if(a.ok){let b=await a.json();E(b),G(0===b.length)}else E([]),G(!0)}catch(a){console.error("Error loading content pages:",a),E([]),G(!0)}x(!1)}catch(a){console.error("Error loading result:",a),z(a instanceof Error?a.message:K),x(!1)}})()},[k,a,q]),w)return(0,b.jsx)("main",{className:"flex items-center justify-center bg-muted py-20",children:(0,b.jsx)(g.LoadingSpinner,{size:"md",text:"Ergebnisse werden geladenâ€¦"})});if(y||!A)return(0,b.jsx)("main",{className:"flex items-center justify-center bg-muted py-20 px-4",children:(0,b.jsx)(h.ErrorState,{title:"Fehler",message:y||"Ergebnisse konnten nicht geladen werden.",onRetry:()=>q.push("/patient/dashboard"),retryText:"ZurÃ¼ck zum Dashboard"})});let N=(0,e.getResultPages)(D),O=(0,e.getInfoPages)(D),P=[..."needs_more_data"===A.workupStatus?[{title:"ZusÃ¤tzliche Fragen beantworten",description:"ErgÃ¤nzen Sie fehlende Informationen, um eine vollstÃ¤ndige Auswertung zu ermÃ¶glichen.",actionLabel:"Fragen beantworten",onClick:()=>q.push(`/patient/funnel/${L}`)}]:[],{title:"Termin besprechen",description:"Ihre Ergebnisse werden von Ihrem Behandlungsteam eingesehen und beim nÃ¤chsten Termin besprochen."},{title:"Ressourcen ansehen",description:"Entdecken Sie hilfreiche Artikel und Strategien zum Umgang mit Stress und zur StÃ¤rkung Ihrer Resilienz.",...N.length>0||O.length>0?{actionLabel:"Ressourcen ansehen",actionUrl:`/patient/funnel/${L}/content/${N[0]?.slug||O[0]?.slug}`}:{}},{title:"Verlauf ansehen",description:"Verfolgen Sie Ihre Assessments Ã¼ber die Zeit und erkennen Sie Muster in Ihrer Historie.",actionLabel:"Zur Historie",onClick:()=>q.push("/patient/history")}],Q=async a=>{if(A&&H)try{await fetch("/api/escalation/log-click",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({assessmentId:A.id,correlationId:H.correlationId,offerType:a})}).catch(a=>{console.error("[escalation] Failed to log CTA click:",a)}),q.push(`/patient/escalation?type=${a}&correlation=${encodeURIComponent(H.correlationId)}`)}catch(a){console.error("[escalation] Error handling CTA click:",a)}};return(0,b.jsxs)(b.Fragment,{children:[v&&(0,b.jsx)(i.default,{variant:"with-title",title:"Ergebnisse",subtitle:M||"Assessment",showBack:!0}),(0,b.jsx)("main",{className:"min-h-screen bg-muted px-4 pt-8 sm:py-12",style:{paddingBottom:"calc(6rem + env(safe-area-inset-bottom))"},children:(0,b.jsxs)(j.default,{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"text-center",children:[(0,b.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-full mb-4",style:{backgroundColor:"var(--color-success-light)"},children:(0,b.jsx)("span",{className:"text-3xl sm:text-4xl",children:"âœ“"})}),(0,b.jsx)("h1",{className:"text-2xl sm:text-3xl md:text-4xl font-bold mb-2",style:{color:"var(--foreground)"},children:"Assessment abgeschlossen!"}),(0,b.jsxs)("p",{className:"text-base sm:text-lg",style:{color:"var(--color-neutral-600)"},children:[M||"Ihr Assessment"," wurde erfolgreich gespeichert"]}),A.completedAt&&!Number.isNaN(Date.parse(A.completedAt))&&(0,b.jsx)("p",{className:"text-sm mt-2",style:{color:"var(--color-neutral-500)"},children:new Intl.DateTimeFormat("de-DE",{dateStyle:"medium",timeStyle:"short"}).format(new Date(A.completedAt))})]}),H?.shouldEscalate&&(0,b.jsx)(B,{reasons:H.reasons,correlationId:H.correlationId,onCtaClick:Q}),(0,b.jsx)(u,{status:A.workupStatus||null,missingDataFields:A.missingDataFields||[]}),(0,b.jsx)("div",{className:"bg-white border border-slate-200 rounded-xl p-6 shadow-sm",children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("span",{className:"text-2xl flex-shrink-0",children:"ðŸ§¾"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h3",{className:"text-lg sm:text-xl font-bold text-slate-900 mb-2",children:A.result?.summaryTitle||"Ergebnis wird vorbereitet"}),(0,b.jsx)("ul",{className:"text-sm sm:text-base text-slate-600 space-y-1 list-disc pl-5",children:(A.result?.summaryBullets?.length?A.result.summaryBullets:["Ihre Antworten wurden gespeichert.","Die Auswertung ist in Vorbereitung.","Bitte prÃ¼fen Sie spÃ¤ter erneut."]).map((a,c)=>(0,b.jsx)("li",{children:a},c))}),A.result?.derived?.cardiovascularAgeYears!==void 0&&(0,b.jsxs)("p",{className:"text-sm text-slate-500 mt-3",children:["Erfasste Altersangabe: ",A.result.derived.cardiovascularAgeYears??"â€”"]})]})]})}),(0,b.jsx)(t,{outcomes:p}),(0,b.jsx)(s,{reports:l}),p&&null!==p.score_numeric&&(0,b.jsx)(m,{score:p.score_numeric,maxScore:100,level:"low"===p.risk_level?"low":"high"===p.risk_level?"high":"medium",label:"Stress-Level",description:"Ihre Gesamtbewertung"}),(0,b.jsx)(r,{text:`## Vielen Dank f\xfcr Ihre Teilnahme

Ihre Antworten sind nun gesichert und werden f\xfcr die weitere Betreuung verwendet.

### Ihre n\xe4chsten Schritte

${"needs_more_data"===A.workupStatus?`Es werden noch einige zus\xe4tzliche Informationen ben\xf6tigt, um eine vollst\xe4ndige Auswertung zu erm\xf6glichen. Bitte beantworten Sie die fehlenden Fragen \xfcber die Schaltfl\xe4che "Zus\xe4tzliche Fragen beantworten" in den n\xe4chsten Schritten.

`:""}Ihre Angaben helfen Ihrem Behandlungsteam dabei, ein besseres Verst\xe4ndnis Ihrer aktuellen Situation zu entwickeln. Die Ergebnisse werden vertraulich behandelt und nur mit autorisiertem medizinischem Personal geteilt.

### Wie geht es weiter?

Bei Ihrem n\xe4chsten Termin k\xf6nnen die Ergebnisse gemeinsam besprochen werden. Ihr Behandlungsteam wird Sie \xfcber weitere Schritte informieren.`,title:"Ihre Zusammenfassung",icon:"ðŸ¤–"}),(0,b.jsx)(n,{}),(0,b.jsx)(o,{actions:P}),(N.length>0||O.length>0)&&(0,b.jsx)("div",{className:"bg-white border border-slate-200 rounded-xl p-6 shadow-sm",children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("span",{className:"text-2xl flex-shrink-0",children:"ðŸ“š"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h3",{className:"text-lg sm:text-xl font-bold text-slate-900 mb-2",children:"Weitere Ressourcen"}),(0,b.jsx)("p",{className:"text-sm sm:text-base text-slate-600 mb-4",children:"Erfahren Sie mehr Ã¼ber Stress, Resilienz und praktische Strategien:"}),(0,b.jsxs)("div",{className:"grid gap-2",children:[N.map(a=>(0,b.jsxs)("a",{href:`/patient/funnel/${L}/content/${a.slug}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-sm sm:text-base text-sky-700 hover:text-sky-900 hover:underline font-medium p-2 hover:bg-sky-50 rounded transition-colors",children:[(0,b.jsx)("span",{children:"ðŸ“„"}),(0,b.jsx)("span",{children:a.title})]},a.id)),O.map(a=>(0,b.jsxs)("a",{href:`/patient/funnel/${L}/content/${a.slug}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-sm sm:text-base text-sky-700 hover:text-sky-900 hover:underline font-medium p-2 hover:bg-sky-50 rounded transition-colors",children:[(0,b.jsx)("span",{children:"ðŸ“„"}),(0,b.jsx)("span",{children:a.title})]},a.id))]})]})]})}),F&&0===N.length&&0===O.length&&(0,b.jsx)("div",{className:"bg-white border border-slate-200 rounded-xl p-6 shadow-sm",children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("span",{className:"text-2xl flex-shrink-0",children:"ðŸ“š"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h3",{className:"text-lg sm:text-xl font-bold text-slate-900 mb-2",children:"Inhalte noch nicht verfÃ¼gbar"}),(0,b.jsx)("p",{className:"text-sm sm:text-base text-slate-600",children:"FÃ¼r dieses Assessment sind aktuell noch keine zusÃ¤tzlichen Inhalte hinterlegt."})]})]})}),(0,b.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-4",children:[(0,b.jsx)("button",{onClick:()=>q.push("/patient/dashboard?refresh=funnel"),className:"w-full sm:flex-1 px-6 py-4 bg-sky-600 text-white rounded-xl text-base font-semibold hover:bg-sky-700 active:bg-sky-800 transition-colors shadow-md",style:{minHeight:"56px"},children:"Zum Dashboard"}),(0,b.jsx)("button",{onClick:()=>q.push("/patient/history"),className:"w-full sm:flex-1 px-6 py-4 bg-slate-200 text-slate-700 rounded-xl text-base font-semibold hover:bg-slate-300 active:bg-slate-400 transition-colors",style:{minHeight:"56px"},children:"Meine Assessments"})]}),(0,b.jsx)("div",{className:"bg-white border border-slate-200 rounded-xl p-5 shadow-sm",children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)("span",{className:"text-2xl flex-shrink-0",children:"ðŸ”’"}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("h3",{className:"text-base sm:text-lg font-bold text-slate-900 mb-2",children:"Ihre Daten sind sicher"}),(0,b.jsx)("p",{className:"text-sm sm:text-base text-slate-600",children:"Alle Ihre Antworten wurden verschlÃ¼sselt gespeichert und unterliegen strengen Datenschutzrichtlinien. Nur autorisiertes medizinisches Personal hat Zugriff auf Ihre Daten."})]})]})})]})})]})}a.s(["default",()=>L],56449)}];

//# sourceMappingURL=apps_rhythm-patient-ui_app_patient_funnel_%5Bslug%5D_result_client_tsx_2d4ddbe9._.js.map