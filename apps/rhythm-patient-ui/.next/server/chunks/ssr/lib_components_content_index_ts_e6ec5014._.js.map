{"version":3,"sources":["../../../../../../lib/contracts/funnelManifest.ts","../../../../../../lib/utils/urlSecurity.ts","../../../../../../lib/components/content/blocks/HeroBlockRenderer.tsx","../../../../../../lib/components/content/blocks/TextBlockRenderer.tsx","../../../../../../lib/components/content/blocks/ImageBlockRenderer.tsx","../../../../../../lib/components/content/blocks/VideoBlockRenderer.tsx","../../../../../../lib/components/content/blocks/MarkdownBlockRenderer.tsx","../../../../../../lib/components/content/blocks/CTABlockRenderer.tsx","../../../../../../lib/components/content/blocks/DividerBlockRenderer.tsx","../../../../../../lib/components/content/SectionRenderer.tsx","../../../../../../lib/components/content/PageRenderer.tsx","../../../../../../lib/components/content/ContentBlockRenderer.tsx","../../../../../../lib/components/content/CardRenderer.tsx","../../../../../../app/components/StandardContentContainer.tsx"],"sourcesContent":["/**\n * Funnel Plugin Manifest Schemas (V05-I02.2)\n * \n * This file defines the versioned \"Plugin Manifest\" structure for funnels.\n * All funnel versions store their configuration in JSONB fields validated by these schemas.\n * \n * **NO MAGIC STRINGS**: All question types, section types, and step types come from registry.\n * \n * Structure:\n * - FunnelQuestionnaireConfigSchema: Steps, questions, validation logic\n * - FunnelContentManifestSchema: Content pages, sections, assets\n * - Algorithm bundle version: String pointer to algorithm version\n * - Prompt version: String for content/report generation\n */\n\nimport { z } from 'zod'\nimport { NODE_TYPE, QUESTION_TYPE, type NodeType, type QuestionType } from './registry'\nimport { isValidUrl } from '@/lib/utils/urlSecurity'\n\nfunction normalizeQuestionType(value: unknown): unknown {\n  if (typeof value !== 'string') return value\n\n  const normalized = value.toLowerCase().trim()\n  if (Object.values(QUESTION_TYPE).includes(normalized as QuestionType)) {\n    return normalized\n  }\n\n  // Compatibility layer for older/looser DB values.\n  // Keep this mapping narrow + deterministic so QuestionRenderer still receives only registry types.\n  const aliases: Record<string, QuestionType> = {\n    // single choice\n    'single_choice': QUESTION_TYPE.RADIO,\n    'single-choice': QUESTION_TYPE.RADIO,\n    'select_one': QUESTION_TYPE.RADIO,\n    'select-one': QUESTION_TYPE.RADIO,\n    'multiple_choice': QUESTION_TYPE.RADIO,\n\n    // multiple select\n    'multi_choice': QUESTION_TYPE.CHECKBOX,\n    'multi-choice': QUESTION_TYPE.CHECKBOX,\n    'select_many': QUESTION_TYPE.CHECKBOX,\n    'select-many': QUESTION_TYPE.CHECKBOX,\n    'multiple_select': QUESTION_TYPE.CHECKBOX,\n    'multiple-select': QUESTION_TYPE.CHECKBOX,\n\n    // text\n    'short_text': QUESTION_TYPE.TEXT,\n    'short-text': QUESTION_TYPE.TEXT,\n    'string': QUESTION_TYPE.TEXT,\n\n    // textarea\n    'long_text': QUESTION_TYPE.TEXTAREA,\n    'long-text': QUESTION_TYPE.TEXTAREA,\n    'paragraph': QUESTION_TYPE.TEXTAREA,\n\n    // number\n    'integer': QUESTION_TYPE.NUMBER,\n    'float': QUESTION_TYPE.NUMBER,\n    'decimal': QUESTION_TYPE.NUMBER,\n\n    // scale/rating\n    'likert': QUESTION_TYPE.SCALE,\n    'likert_scale': QUESTION_TYPE.SCALE,\n    'likert-scale': QUESTION_TYPE.SCALE,\n    'rating': QUESTION_TYPE.SCALE,\n\n    // slider/range\n    'range': QUESTION_TYPE.SLIDER,\n  }\n\n  return aliases[normalized] ?? normalized\n}\n\n// IMPORTANT: keep this optional at the *object key* level.\n// Using `.transform()` directly can turn it into a required key with `string | undefined`.\nconst nullableString = z\n  .preprocess((value) => (value === null ? undefined : value), z.string().optional())\n  .optional()\n\n// ============================================================\n// Questionnaire Config Schema\n// ============================================================\n\n/**\n * V05-I06.4 Security: Safe URL validator for Zod schemas\n * Rejects javascript:, data:, vbscript:, file: and other dangerous protocols\n */\nconst safeUrlValidator = z.string().refine(\n  (url) => {\n    // Empty/undefined is OK for optional fields\n    if (!url || url.trim() === '') return true\n    return isValidUrl(url, false)\n  },\n  {\n    message: 'URL must use http:, https:, mailto:, tel:, or be a relative path. Dangerous protocols (javascript:, data:, vbscript:, file:) are not allowed.',\n  }\n)\n\n/**\n * Validation rule for question\n */\nexport const QuestionValidationSchema = z.object({\n  required: z.boolean().optional(),\n  min: z.number().optional(),\n  max: z.number().optional(),\n  pattern: z.string().optional(),\n  message: z.string().optional(),\n})\n\nexport type QuestionValidation = z.infer<typeof QuestionValidationSchema>\n\n/**\n * Option for radio/checkbox questions\n */\nexport const QuestionOptionSchema = z.object({\n  value: z.string(),\n  label: z.string(),\n  helpText: nullableString,\n})\n\nexport type QuestionOption = z.infer<typeof QuestionOptionSchema>\n\n/**\n * Individual question in questionnaire\n */\nexport const QuestionConfigSchema = z.object({\n  id: z.string(),\n  key: z.string(),\n  type: z.preprocess(\n    normalizeQuestionType,\n    z.enum([\n      QUESTION_TYPE.RADIO,\n      QUESTION_TYPE.CHECKBOX,\n      QUESTION_TYPE.TEXT,\n      QUESTION_TYPE.TEXTAREA,\n      QUESTION_TYPE.NUMBER,\n      QUESTION_TYPE.SCALE,\n      QUESTION_TYPE.SLIDER,\n    ] as [QuestionType, ...QuestionType[]]),\n  ),\n  label: z.string(),\n  helpText: nullableString,\n  required: z.boolean().default(false),\n  options: z.array(QuestionOptionSchema).optional(),\n  validation: QuestionValidationSchema.optional(),\n  minValue: z.number().optional(),\n  maxValue: z.number().optional(),\n})\n\nexport type QuestionConfig = z.infer<typeof QuestionConfigSchema>\n\n/**\n * Conditional logic for step/question visibility\n */\nexport const ConditionalLogicSchema = z.object({\n  type: z.enum(['show', 'hide', 'skip']),\n  conditions: z.array(\n    z.object({\n      questionId: z.string(),\n      operator: z.enum(['eq', 'neq', 'gt', 'gte', 'lt', 'lte', 'in', 'notIn']),\n      value: z.union([z.string(), z.number(), z.boolean(), z.array(z.string())]),\n    }),\n  ),\n  logic: z.enum(['and', 'or']).default('and'),\n})\n\nexport type ConditionalLogic = z.infer<typeof ConditionalLogicSchema>\n\n/**\n * Step in questionnaire flow\n */\nexport const QuestionnaireStepSchema = z.object({\n  id: z.string(),\n  title: z.string(),\n  description: z.string().optional(),\n  questions: z.array(QuestionConfigSchema),\n  conditionalLogic: ConditionalLogicSchema.optional(),\n})\n\nexport type QuestionnaireStep = z.infer<typeof QuestionnaireStepSchema>\n\n/**\n * Complete questionnaire configuration\n */\nexport const FunnelQuestionnaireConfigSchema = z.object({\n  version: z.string().default('1.0'),\n  steps: z.array(QuestionnaireStepSchema),\n  conditionalLogic: z.array(ConditionalLogicSchema).optional(),\n  metadata: z.record(z.string(), z.any()).optional(),\n})\n\nexport type FunnelQuestionnaireConfig = z.infer<typeof FunnelQuestionnaireConfigSchema>\n\n// ============================================================\n// Content Manifest Schema\n// ============================================================\n\n/**\n * Section types for content pages\n * These are the allowed types for sections within content pages\n */\nexport const SECTION_TYPE = {\n  HERO: 'hero',\n  TEXT: 'text',\n  IMAGE: 'image',\n  VIDEO: 'video',\n  MARKDOWN: 'markdown',\n  CTA: 'cta',\n  DIVIDER: 'divider',\n} as const\n\nexport type SectionType = typeof SECTION_TYPE[keyof typeof SECTION_TYPE]\n\n/**\n * Content section within a page\n * \n * V05-I06.2 Hardening: Added strict bounds and validation\n * V05-I06.4 Security: Added URL validation for content fields\n * - key: max 200 chars (prevent DoS)\n * - contentRef: max 2048 chars (URL/path length limit)\n * - orderIndex: non-negative integer (deterministic sorting)\n * - content.url, content.href: validated against dangerous protocols\n * - No unknown keys allowed (strict mode via .strict())\n */\nexport const ContentSectionSchema = z\n  .object({\n    key: z.string().min(1).max(200),\n    type: z.enum([\n      SECTION_TYPE.HERO,\n      SECTION_TYPE.TEXT,\n      SECTION_TYPE.IMAGE,\n      SECTION_TYPE.VIDEO,\n      SECTION_TYPE.MARKDOWN,\n      SECTION_TYPE.CTA,\n      SECTION_TYPE.DIVIDER,\n    ] as [SectionType, ...SectionType[]]),\n    contentRef: z.string().max(2048).optional(),\n    content: z.record(z.string(), z.any()).optional(),\n    orderIndex: z.number().int().nonnegative().optional(),\n  })\n  .strict()\n  .refine(\n    (section) => {\n      // Validate URLs in content object for security\n      if (!section.content) return true\n      \n      // Check href field (CTA blocks)\n      if ('href' in section.content && typeof section.content.href === 'string') {\n        if (!isValidUrl(section.content.href, false)) {\n          return false\n        }\n      }\n      \n      // Check url field (Image, Video blocks)\n      if ('url' in section.content && typeof section.content.url === 'string') {\n        if (!isValidUrl(section.content.url, false)) {\n          return false\n        }\n      }\n      \n      // Check backgroundImage field (Hero blocks)\n      if ('backgroundImage' in section.content && typeof section.content.backgroundImage === 'string') {\n        if (section.content.backgroundImage && !isValidUrl(section.content.backgroundImage, false)) {\n          return false\n        }\n      }\n      \n      return true\n    },\n    {\n      message: 'Content URLs must use safe protocols (http:, https:, mailto:, tel:, or relative paths). Dangerous protocols (javascript:, data:, vbscript:, file:) are not allowed.',\n    }\n  )\n\nexport type ContentSection = z.infer<typeof ContentSectionSchema>\n\n/**\n * Content page definition\n * \n * V05-I06.2 Hardening: Added strict bounds\n * - slug: max 200 chars, alphanumeric + hyphens\n * - title: max 500 chars\n * - description: max 2000 chars\n * - sections: max 100 sections per page\n * - No unknown keys allowed (strict mode)\n */\nexport const ContentPageSchema = z\n  .object({\n    slug: z\n      .string()\n      .min(1)\n      .max(200)\n      .regex(/^[a-z0-9-]+$/, 'Slug must be lowercase alphanumeric with hyphens'),\n    title: z.string().min(1).max(500),\n    description: z.string().max(2000).optional(),\n    sections: z.array(ContentSectionSchema).max(100),\n    metadata: z.record(z.string(), z.any()).optional(),\n  })\n  .strict()\n\nexport type ContentPage = z.infer<typeof ContentPageSchema>\n\n/**\n * Complete content manifest\n * \n * V05-I06.2 Hardening: Added strict bounds\n * - version: max 20 chars\n * - pages: max 50 pages per manifest\n * - assets: max 200 assets per manifest\n * - asset key: max 200 chars\n * - asset url: max 2048 chars\n * - No unknown keys allowed (strict mode)\n */\nexport const FunnelContentManifestSchema = z\n  .object({\n    version: z.string().max(20).default('1.0'),\n    pages: z.array(ContentPageSchema).max(50),\n    assets: z\n      .array(\n        z\n          .object({\n            key: z.string().min(1).max(200),\n            type: z.enum(['image', 'video', 'audio', 'document']),\n            url: safeUrlValidator.min(1).max(2048),\n            metadata: z.record(z.string(), z.any()).optional(),\n          })\n          .strict(),\n      )\n      .max(200)\n      .optional(),\n    metadata: z.record(z.string(), z.any()).optional(),\n  })\n  .strict()\n\nexport type FunnelContentManifest = z.infer<typeof FunnelContentManifestSchema>\n\n// ============================================================\n// Complete Plugin Manifest\n// ============================================================\n\n/**\n * Complete funnel plugin manifest\n * This represents all configuration data for a funnel version\n */\nexport const FunnelPluginManifestSchema = z.object({\n  questionnaire_config: FunnelQuestionnaireConfigSchema,\n  content_manifest: FunnelContentManifestSchema,\n  algorithm_bundle_version: z.string(),\n  prompt_version: z.string(),\n})\n\nexport type FunnelPluginManifest = z.infer<typeof FunnelPluginManifestSchema>\n\n// ============================================================\n// Helper Functions\n// ============================================================\n\n/**\n * Type guard to check if a value is a valid section type\n */\nexport function isValidSectionType(value: unknown): value is SectionType {\n  return typeof value === 'string' && Object.values(SECTION_TYPE).includes(value as SectionType)\n}\n\n/**\n * Validates and parses questionnaire config from JSONB\n * @throws ZodError if validation fails\n */\nexport function parseQuestionnaireConfig(\n  json: unknown,\n): FunnelQuestionnaireConfig {\n  return FunnelQuestionnaireConfigSchema.parse(json)\n}\n\n/**\n * Safely parses questionnaire config with error handling\n * @returns Parsed config or null if invalid\n */\nexport function safeParseQuestionnaireConfig(\n  json: unknown,\n): FunnelQuestionnaireConfig | null {\n  const result = FunnelQuestionnaireConfigSchema.safeParse(json)\n  return result.success ? result.data : null\n}\n\n/**\n * Validates and parses content manifest from JSONB\n * @throws ZodError if validation fails\n */\nexport function parseContentManifest(json: unknown): FunnelContentManifest {\n  return FunnelContentManifestSchema.parse(json)\n}\n\n/**\n * Safely parses content manifest with error handling\n * @returns Parsed manifest or null if invalid\n */\nexport function safeParseContentManifest(json: unknown): FunnelContentManifest | null {\n  const result = FunnelContentManifestSchema.safeParse(json)\n  return result.success ? result.data : null\n}\n\n/**\n * Validates and parses complete plugin manifest\n * @throws ZodError if validation fails\n */\nexport function parsePluginManifest(json: unknown): FunnelPluginManifest {\n  return FunnelPluginManifestSchema.parse(json)\n}\n\n/**\n * Safely parses complete plugin manifest with error handling\n * @returns Parsed manifest or null if invalid\n */\nexport function safeParsePluginManifest(json: unknown): FunnelPluginManifest | null {\n  const result = FunnelPluginManifestSchema.safeParse(json)\n  return result.success ? result.data : null\n}\n","/**\n * URL Security Validation (V05-I06.2 Hardening)\n * \n * Validates URLs to prevent XSS and other security issues\n * Denies javascript:, data:, vbscript:, and other dangerous protocols\n */\n\n/**\n * Allowed URL protocols for content blocks\n */\nconst ALLOWED_PROTOCOLS = ['http:', 'https:', 'mailto:', 'tel:']\n\n/**\n * Maximum URL length to prevent buffer overflow attacks\n */\nconst MAX_URL_LENGTH = 2048\n\n/**\n * Validates a URL for security\n * \n * Rejects:\n * - javascript: URLs (XSS)\n * - data: URLs (unless explicitly allowed)\n * - vbscript: URLs (XSS)\n * - file: URLs (local file access)\n * - Overly long URLs (DoS)\n * \n * @param url - URL to validate\n * @param allowDataUrls - Whether to allow data: URLs (default: false)\n * @returns true if URL is safe, false otherwise\n */\nexport function isValidUrl(url: string | undefined, allowDataUrls = false): boolean {\n  if (!url || typeof url !== 'string') {\n    return false\n  }\n\n  // Check length\n  if (url.length > MAX_URL_LENGTH) {\n    return false\n  }\n\n  // Trim and normalize\n  const trimmed = url.trim().toLowerCase()\n\n  // Empty after trim\n  if (trimmed.length === 0) {\n    return false\n  }\n\n  // Check for dangerous protocols (always forbidden)\n  const dangerousProtocols = ['javascript:', 'vbscript:', 'file:', 'about:']\n  \n  for (const protocol of dangerousProtocols) {\n    if (trimmed.startsWith(protocol)) {\n      return false\n    }\n  }\n\n  // Handle data: URLs separately\n  if (trimmed.startsWith('data:')) {\n    return allowDataUrls\n  }\n\n  // Relative URLs are OK (start with /, ./, ../)\n  if (trimmed.startsWith('/') || trimmed.startsWith('./') || trimmed.startsWith('../')) {\n    return true\n  }\n\n  // Check for allowed protocols\n  try {\n    const parsed = new URL(url)\n    return ALLOWED_PROTOCOLS.includes(parsed.protocol)\n  } catch {\n    // If URL parsing fails, allow relative URLs that don't look suspicious\n    // This handles cases like \"page.html\" or \"#anchor\"\n    return !trimmed.includes(':')\n  }\n}\n\n/**\n * Sanitizes a URL by returning it only if valid, otherwise returns fallback\n * \n * @param url - URL to sanitize\n * @param fallback - Fallback URL if invalid (default: '#')\n * @param allowDataUrls - Whether to allow data: URLs (default: false)\n * @returns Sanitized URL or fallback\n */\nexport function sanitizeUrl(\n  url: string | undefined,\n  fallback = '#',\n  allowDataUrls = false,\n): string {\n  return isValidUrl(url, allowDataUrls) ? url! : fallback\n}\n\n/**\n * Gets safe link props for external links\n * Adds rel=\"noopener noreferrer\" for external links\n * \n * @param href - Link href\n * @returns Object with href and optional rel/target\n */\nexport function getSafeLinkProps(href: string): {\n  href: string\n  rel?: string\n  target?: string\n} {\n  const sanitized = sanitizeUrl(href)\n\n  // Check if external link (starts with http:// or https://)\n  const isExternal =\n    sanitized.startsWith('http://') || sanitized.startsWith('https://')\n\n  if (isExternal) {\n    return {\n      href: sanitized,\n      rel: 'noopener noreferrer',\n      target: '_blank',\n    }\n  }\n\n  return { href: sanitized }\n}\n","/**\n * Hero Block Renderer (V05-I06.2)\n * \n * Renders hero section with title, subtitle, and optional background\n */\n\n'use client'\n\nimport React from 'react'\nimport { type ContentSection } from '@/lib/contracts/funnelManifest'\n\nexport type HeroBlockRendererProps = {\n  section: ContentSection\n}\n\n/**\n * Hero Block - Large header section for page introduction\n * \n * Expected content fields:\n * - title: string (required)\n * - subtitle?: string (optional)\n * - backgroundImage?: string (optional)\n * - alignment?: 'left' | 'center' | 'right' (optional, default 'center')\n */\nexport function HeroBlockRenderer({ section }: HeroBlockRendererProps) {\n  const content = section.content || {}\n  const title = content.title as string | undefined\n  const subtitle = content.subtitle as string | undefined\n  const backgroundImage = content.backgroundImage as string | undefined\n  const alignment = (content.alignment as string | undefined) || 'center'\n\n  const alignmentClass = {\n    left: 'text-left',\n    center: 'text-center',\n    right: 'text-right',\n  }[alignment] || 'text-center'\n\n  return (\n    <div\n      className={`hero-block rounded-lg bg-gradient-to-r from-sky-500 to-sky-600 dark:from-sky-700 dark:to-sky-800 p-8 ${alignmentClass}`}\n      data-section-key={section.key}\n      style={backgroundImage ? { backgroundImage: `url(${backgroundImage})`, backgroundSize: 'cover', backgroundPosition: 'center' } : undefined}\n    >\n      {title && (\n        <h1 className=\"text-3xl md:text-4xl font-bold text-white mb-2\">\n          {title}\n        </h1>\n      )}\n      {subtitle && (\n        <p className=\"text-lg text-sky-50\">\n          {subtitle}\n        </p>\n      )}\n    </div>\n  )\n}\n","/**\n * Text Block Renderer (V05-I06.2)\n * \n * Renders simple text content block\n */\n\n'use client'\n\nimport React from 'react'\nimport { type ContentSection } from '@/lib/contracts/funnelManifest'\n\nexport type TextBlockRendererProps = {\n  section: ContentSection\n}\n\n/**\n * Text Block - Simple text content with optional title\n * \n * Expected content fields:\n * - title?: string (optional)\n * - text: string (required)\n * - alignment?: 'left' | 'center' | 'right' (optional, default 'left')\n */\nexport function TextBlockRenderer({ section }: TextBlockRendererProps) {\n  const content = section.content || {}\n  const title = content.title as string | undefined\n  const text = content.text as string | undefined\n  const alignment = (content.alignment as string | undefined) || 'left'\n\n  const alignmentClass = {\n    left: 'text-left',\n    center: 'text-center',\n    right: 'text-right',\n  }[alignment] || 'text-left'\n\n  return (\n    <div\n      className={`text-block bg-white dark:bg-slate-800 rounded-lg p-6 ${alignmentClass}`}\n      data-section-key={section.key}\n    >\n      {title && (\n        <h3 className=\"text-xl font-semibold text-slate-900 dark:text-slate-100 mb-3\">\n          {title}\n        </h3>\n      )}\n      {text && (\n        <p className=\"text-slate-700 dark:text-slate-300 whitespace-pre-wrap\">\n          {text}\n        </p>\n      )}\n    </div>\n  )\n}\n","/**\n * Image Block Renderer (V05-I06.2)\n * \n * Renders image content block\n * \n * V05-I06.2 Hardening: URL security validation\n * - Validates image URLs to prevent XSS\n * - Allows data: URLs for inline images\n */\n\n'use client'\n\nimport React from 'react'\nimport { type ContentSection } from '@/lib/contracts/funnelManifest'\nimport { sanitizeUrl } from '@/lib/utils/urlSecurity'\n\nexport type ImageBlockRendererProps = {\n  section: ContentSection\n}\n\n/**\n * Image Block - Image with optional caption\n * \n * Expected content fields:\n * - url: string (required) - can also use contentRef\n * - alt: string (required for accessibility)\n * - caption?: string (optional)\n * - width?: number (optional)\n * - height?: number (optional)\n * \n * Security:\n * - URLs are validated to prevent XSS attacks\n * - data: URLs are allowed for inline images\n * - Dangerous protocols (javascript:) are rejected\n */\nexport function ImageBlockRenderer({ section }: ImageBlockRendererProps) {\n  const content = section.content || {}\n  const url = (content.url as string | undefined) || section.contentRef || ''\n  const alt = (content.alt as string | undefined) || 'Image'\n  const caption = content.caption as string | undefined\n  const width = content.width as number | undefined\n  const height = content.height as number | undefined\n\n  // Sanitize URL (allow data: URLs for inline images)\n  const safeUrl = sanitizeUrl(url, '', true)\n\n  return (\n    <div\n      className=\"image-block bg-white dark:bg-slate-800 rounded-lg p-4\"\n      data-section-key={section.key}\n    >\n      {safeUrl && (\n        <>\n          <img\n            src={safeUrl}\n            alt={alt}\n            width={width}\n            height={height}\n            className=\"w-full h-auto rounded\"\n            loading=\"lazy\"\n          />\n          {caption && (\n            <p className=\"mt-2 text-sm text-slate-600 dark:text-slate-400 text-center\">\n              {caption}\n            </p>\n          )}\n        </>\n      )}\n    </div>\n  )\n}\n","/**\n * Video Block Renderer (V05-I06.2)\n * \n * Renders video content block\n * \n * V05-I06.2 Hardening: URL security validation\n * - Validates video URLs to prevent XSS\n * - Validates poster URLs\n */\n\n'use client'\n\nimport React from 'react'\nimport { type ContentSection } from '@/lib/contracts/funnelManifest'\nimport { sanitizeUrl } from '@/lib/utils/urlSecurity'\n\nexport type VideoBlockRendererProps = {\n  section: ContentSection\n}\n\n/**\n * Video Block - Video player with optional caption\n * \n * Expected content fields:\n * - url: string (required) - can also use contentRef\n * - caption?: string (optional)\n * - poster?: string (optional thumbnail)\n * - controls?: boolean (optional, default true)\n * \n * Security:\n * - URLs are validated to prevent XSS attacks\n * - Dangerous protocols (javascript:, data:) are rejected\n */\nexport function VideoBlockRenderer({ section }: VideoBlockRendererProps) {\n  const content = section.content || {}\n  const url = (content.url as string | undefined) || section.contentRef || ''\n  const caption = content.caption as string | undefined\n  const poster = content.poster as string | undefined\n  const controls = (content.controls as boolean | undefined) ?? true\n\n  // Sanitize URLs (no data: URLs for video sources)\n  const safeUrl = sanitizeUrl(url, '', false)\n  const safePoster = poster ? sanitizeUrl(poster, '', true) : undefined\n\n  return (\n    <div\n      className=\"video-block bg-white dark:bg-slate-800 rounded-lg p-4\"\n      data-section-key={section.key}\n    >\n      {safeUrl && (\n        <>\n          <video\n            src={safeUrl}\n            poster={safePoster}\n            controls={controls}\n            className=\"w-full h-auto rounded\"\n            preload=\"metadata\"\n          >\n            Your browser does not support the video tag.\n          </video>\n          {caption && (\n            <p className=\"mt-2 text-sm text-slate-600 dark:text-slate-400 text-center\">\n              {caption}\n            </p>\n          )}\n        </>\n      )}\n    </div>\n  )\n}\n","/**\n * Markdown Block Renderer (V05-I06.2)\n * \n * Renders markdown content using react-markdown\n * \n * V05-I06.2 Hardening: Security measures\n * - Raw HTML is NOT rendered (skipHtml: true)\n * - Markdown content is sanitized by react-markdown\n * - Links automatically get safe attributes\n */\n\n'use client'\n\nimport React from 'react'\nimport { type ContentSection } from '@/lib/contracts/funnelManifest'\nimport ReactMarkdown from 'react-markdown'\nimport remarkGfm from 'remark-gfm'\nimport { type Components } from 'react-markdown'\n\nexport type MarkdownBlockRendererProps = {\n  section: ContentSection\n}\n\n/**\n * Custom link component with security attributes\n * Adds rel=\"noopener noreferrer\" for external links\n */\nconst SafeLink: Components['a'] = ({ href, children, ...props }) => {\n  const isExternal = href?.startsWith('http://') || href?.startsWith('https://')\n\n  if (isExternal) {\n    return (\n      <a\n        href={href}\n        rel=\"noopener noreferrer\"\n        target=\"_blank\"\n        {...props}\n      >\n        {children}\n      </a>\n    )\n  }\n\n  return <a href={href} {...props}>{children}</a>\n}\n\n/**\n * Markdown Block - Renders markdown content\n * \n * Expected content fields:\n * - markdown: string (required) - markdown content\n * - contentRef can also be used to reference external markdown file\n * \n * Security:\n * - Raw HTML is disabled (skipHtml: true)\n * - External links get rel=\"noopener noreferrer\"\n * - All content is sanitized by react-markdown\n */\nexport function MarkdownBlockRenderer({ section }: MarkdownBlockRendererProps) {\n  const content = section.content || {}\n  const markdown = (content.markdown as string | undefined) || section.contentRef || ''\n\n  return (\n    <div\n      className=\"markdown-block bg-white dark:bg-slate-800 rounded-lg p-6 prose prose-slate dark:prose-invert max-w-none\"\n      data-section-key={section.key}\n    >\n      {markdown && (\n        <ReactMarkdown\n          remarkPlugins={[remarkGfm]}\n          skipHtml={true}\n          components={{\n            a: SafeLink,\n            table: ({ children, ...props }) => (\n              <div className=\"w-full overflow-x-auto\">\n                <table className=\"w-full min-w-[640px]\" {...props}>\n                  {children}\n                </table>\n              </div>\n            ),\n            th: ({ children, ...props }) => (\n              <th className=\"whitespace-nowrap\" {...props}>\n                {children}\n              </th>\n            ),\n          }}\n        >\n          {markdown}\n        </ReactMarkdown>\n      )}\n    </div>\n  )\n}\n","/**\n * CTA (Call-to-Action) Block Renderer (V05-I06.2)\n * \n * Renders call-to-action button/link\n * \n * V05-I06.2 Hardening: URL security validation\n * - Validates URLs to prevent XSS (javascript:, data:, etc.)\n * - External links get rel=\"noopener noreferrer\"\n */\n\n'use client'\n\nimport React from 'react'\nimport { type ContentSection } from '@/lib/contracts/funnelManifest'\nimport Link from 'next/link'\nimport { getSafeLinkProps } from '@/lib/utils/urlSecurity'\n\nexport type CTABlockRendererProps = {\n  section: ContentSection\n}\n\n/**\n * CTA Block - Call-to-action button or link\n * \n * Expected content fields:\n * - text: string (required) - button text\n * - href: string (required) - link destination\n * - variant?: 'primary' | 'secondary' | 'outline' (optional, default 'primary')\n * - alignment?: 'left' | 'center' | 'right' (optional, default 'center')\n * \n * Security:\n * - URLs are validated to prevent XSS attacks\n * - Dangerous protocols (javascript:, data:) are rejected\n * - External links get rel=\"noopener noreferrer\"\n */\nexport function CTABlockRenderer({ section }: CTABlockRendererProps) {\n  const content = section.content || {}\n  const text = content.text as string | undefined\n  const href = content.href as string | undefined\n  const variant = (content.variant as string | undefined) || 'primary'\n  const alignment = (content.alignment as string | undefined) || 'center'\n\n  const variantClasses = {\n    primary: 'bg-sky-600 hover:bg-sky-700 text-white',\n    secondary: 'bg-slate-600 hover:bg-slate-700 text-white',\n    outline: 'border-2 border-sky-600 text-sky-600 hover:bg-sky-50 dark:border-sky-400 dark:text-sky-400 dark:hover:bg-slate-800',\n  }[variant] || 'bg-sky-600 hover:bg-sky-700 text-white'\n\n  const alignmentClass = {\n    left: 'justify-start',\n    center: 'justify-center',\n    right: 'justify-end',\n  }[alignment] || 'justify-center'\n\n  if (!text || !href) {\n    return (\n      <div\n        className={`cta-block flex ${alignmentClass} py-4`}\n        data-section-key={section.key}\n      />\n    )\n  }\n\n  // Get safe link props with URL validation\n  const linkProps = getSafeLinkProps(href)\n\n  return (\n    <div\n      className={`cta-block flex ${alignmentClass} py-4`}\n      data-section-key={section.key}\n    >\n      <Link\n        {...linkProps}\n        className={`px-6 py-3 rounded-lg font-semibold transition-colors duration-200 ${variantClasses}`}\n      >\n        {text}\n      </Link>\n    </div>\n  )\n}\n","/**\n * Divider Block Renderer (V05-I06.2)\n * \n * Renders visual divider/separator\n */\n\n'use client'\n\nimport React from 'react'\nimport { type ContentSection } from '@/lib/contracts/funnelManifest'\n\nexport type DividerBlockRendererProps = {\n  section: ContentSection\n}\n\n/**\n * Divider Block - Visual separator between content sections\n * \n * Expected content fields:\n * - style?: 'solid' | 'dashed' | 'dotted' (optional, default 'solid')\n * - spacing?: 'sm' | 'md' | 'lg' (optional, default 'md')\n */\nexport function DividerBlockRenderer({ section }: DividerBlockRendererProps) {\n  const content = section.content || {}\n  const style = (content.style as string | undefined) || 'solid'\n  const spacing = (content.spacing as string | undefined) || 'md'\n\n  const styleClasses = {\n    solid: 'border-solid',\n    dashed: 'border-dashed',\n    dotted: 'border-dotted',\n  }[style] || 'border-solid'\n\n  const spacingClasses = {\n    sm: 'my-2',\n    md: 'my-4',\n    lg: 'my-8',\n  }[spacing] || 'my-4'\n\n  return (\n    <hr\n      className={`divider-block border-slate-200 dark:border-slate-700 ${styleClasses} ${spacingClasses}`}\n      data-section-key={section.key}\n    />\n  )\n}\n","/**\n * Section Renderer (V05-I06.2)\n * \n * Renders individual content sections based on type\n * Type-safe switch on SECTION_TYPE from registry\n * Fail-closed: Unknown types → error\n */\n\n'use client'\n\nimport React from 'react'\nimport { type ContentSection, SECTION_TYPE, isValidSectionType } from '@/lib/contracts/funnelManifest'\nimport { HeroBlockRenderer } from './blocks/HeroBlockRenderer'\nimport { TextBlockRenderer } from './blocks/TextBlockRenderer'\nimport { ImageBlockRenderer } from './blocks/ImageBlockRenderer'\nimport { VideoBlockRenderer } from './blocks/VideoBlockRenderer'\nimport { MarkdownBlockRenderer } from './blocks/MarkdownBlockRenderer'\nimport { CTABlockRenderer } from './blocks/CTABlockRenderer'\nimport { DividerBlockRenderer } from './blocks/DividerBlockRenderer'\n\nexport type SectionRendererProps = {\n  section: ContentSection\n  onBlockTypeError?: (blockType: string, sectionKey: string) => void\n}\n\n/**\n * UnsupportedBlockTypeError\n * Thrown when encountering unknown block type (fail-closed behavior)\n */\nexport class UnsupportedBlockTypeError extends Error {\n  constructor(public blockType: string, public sectionKey: string) {\n    super(`Unsupported block type: \"${blockType}\" in section \"${sectionKey}\"`)\n    this.name = 'UnsupportedBlockTypeError'\n  }\n}\n\n/**\n * Section Renderer - Type-safe switch on section type\n * \n * Uses registry SECTION_TYPE for type checking\n * Unknown types → controlled error (no silent fallbacks)\n */\nexport function SectionRenderer({ section, onBlockTypeError }: SectionRendererProps) {\n  // Type guard validation (should already be validated by Zod, but double-check)\n  if (!isValidSectionType(section.type)) {\n    const error = new UnsupportedBlockTypeError(section.type, section.key)\n    \n    if (onBlockTypeError) {\n      onBlockTypeError(section.type, section.key)\n      return null\n    }\n    \n    throw error\n  }\n\n  // Type-safe switch on SECTION_TYPE (exhaustive)\n  switch (section.type) {\n    case SECTION_TYPE.HERO:\n      return <HeroBlockRenderer section={section} />\n    \n    case SECTION_TYPE.TEXT:\n      return <TextBlockRenderer section={section} />\n    \n    case SECTION_TYPE.IMAGE:\n      return <ImageBlockRenderer section={section} />\n    \n    case SECTION_TYPE.VIDEO:\n      return <VideoBlockRenderer section={section} />\n    \n    case SECTION_TYPE.MARKDOWN:\n      return <MarkdownBlockRenderer section={section} />\n    \n    case SECTION_TYPE.CTA:\n      return <CTABlockRenderer section={section} />\n    \n    case SECTION_TYPE.DIVIDER:\n      return <DividerBlockRenderer section={section} />\n    \n    default: {\n      // TypeScript exhaustiveness check\n      const _exhaustiveCheck: never = section.type\n      const error = new UnsupportedBlockTypeError(String(_exhaustiveCheck), section.key)\n      \n      if (onBlockTypeError) {\n        onBlockTypeError(String(_exhaustiveCheck), section.key)\n        return null\n      }\n      \n      throw error\n    }\n  }\n}\n","/**\n * Page Renderer (V05-I06.2)\n * \n * Renders a single content page from manifest\n * Orchestrates section rendering in deterministic order\n */\n\n'use client'\n\nimport React from 'react'\nimport { type ContentPage } from '@/lib/contracts/funnelManifest'\nimport { SectionRenderer } from './SectionRenderer'\n\nexport type PageRendererProps = {\n  page: ContentPage\n  onBlockTypeError?: (blockType: string, sectionKey: string) => void\n}\n\n/**\n * Renders a content page with optional title/description\n * Sections rendered in deterministic order with stable sorting\n * \n * V05-I06.2 Hardening: Stable sort with explicit tie-breakers\n * - Primary: orderIndex (ascending)\n * - Secondary: original array index (ascending)\n * - Tertiary: section key (lexicographic)\n */\nexport function PageRenderer({ page, onBlockTypeError }: PageRendererProps) {\n  // Create sections with original index for stable sorting\n  const sectionsWithIndex = page.sections.map((section, originalIndex) => ({\n    section,\n    originalIndex,\n  }))\n\n  // Stable deterministic sort\n  const sortedSections = [...sectionsWithIndex].sort((a, b) => {\n    const aOrder = a.section.orderIndex\n    const bOrder = b.section.orderIndex\n\n    // Both have orderIndex: sort by orderIndex\n    if (aOrder !== undefined && bOrder !== undefined) {\n      if (aOrder !== bOrder) {\n        return aOrder - bOrder\n      }\n      // Tie-breaker 1: original index\n      if (a.originalIndex !== b.originalIndex) {\n        return a.originalIndex - b.originalIndex\n      }\n      // Tie-breaker 2: key (lexicographic)\n      return a.section.key.localeCompare(b.section.key)\n    }\n\n    // Only a has orderIndex: a comes first\n    if (aOrder !== undefined) {\n      return -1\n    }\n\n    // Only b has orderIndex: b comes first\n    if (bOrder !== undefined) {\n      return 1\n    }\n\n    // Neither has orderIndex: preserve original order\n    return a.originalIndex - b.originalIndex\n  })\n\n  return (\n    <div className=\"content-page\" data-page-slug={page.slug}>\n      {/* Optional page title/description */}\n      {page.title && (\n        <div className=\"content-page-header mb-6\">\n          <h2 className=\"text-2xl font-bold text-slate-900 dark:text-slate-100\">\n            {page.title}\n          </h2>\n          {page.description && (\n            <p className=\"mt-2 text-slate-600 dark:text-slate-400\">\n              {page.description}\n            </p>\n          )}\n        </div>\n      )}\n\n      {/* Sections stack */}\n      <div className=\"content-sections-stack space-y-4\">\n        {sortedSections.map(({ section }) => (\n          <SectionRenderer\n            key={section.key}\n            section={section}\n            onBlockTypeError={onBlockTypeError}\n          />\n        ))}\n      </div>\n    </div>\n  )\n}\n","/**\n * Content Block Renderer (V05-I06.2)\n * \n * Manifest-driven content renderer for mobile UI v0.5.\n * Renders content blocks (cards/sections stack) from FunnelContentManifest.\n * \n * **NO MAGIC STRINGS**: All block types from SECTION_TYPE registry.\n * **DETERMINISTIC**: Same manifest input → identical render order and structure.\n * **FAIL-CLOSED**: Unknown block types → controlled error, no silent fallbacks.\n * \n * Usage:\n * ```tsx\n * // Server Component loads manifest\n * const manifest = await loadFunnelVersion(slug)\n * \n * // Client Component renders blocks\n * <ContentBlockRenderer manifest={manifest.manifest.content_manifest} />\n * ```\n */\n\n'use client'\n\nimport React from 'react'\nimport { type FunnelContentManifest, type ContentPage } from '@/lib/contracts/funnelManifest'\nimport { PageRenderer } from './PageRenderer'\n\nexport type ContentBlockRendererProps = {\n  /**\n   * Validated content manifest from funnel version\n   * Must be validated server-side before passing to renderer\n   */\n  manifest: FunnelContentManifest\n  \n  /**\n   * Optional: Specific page slug to render\n   * If provided, only renders that page\n   * If omitted, renders all pages in manifest order\n   */\n  pageSlug?: string\n  \n  /**\n   * Optional: Custom error handler for unsupported block types\n   * If omitted, throws error\n   */\n  onBlockTypeError?: (blockType: string, sectionKey: string) => void\n}\n\n/**\n * Content Block Renderer - Main orchestrator\n * \n * Renders content manifest as UI stack (pages → sections → blocks)\n * Preserves manifest order for deterministic rendering\n */\nexport function ContentBlockRenderer({\n  manifest,\n  pageSlug,\n  onBlockTypeError,\n}: ContentBlockRendererProps) {\n  // Filter to specific page if slug provided\n  const pages = pageSlug\n    ? manifest.pages.filter((p) => p.slug === pageSlug)\n    : manifest.pages\n\n  // Empty manifest → empty valid UI\n  if (pages.length === 0) {\n    return null\n  }\n\n  // Render pages in manifest order (deterministic)\n  return (\n    <div className=\"content-block-renderer\">\n      {pages.map((page) => (\n        <PageRenderer\n          key={page.slug}\n          page={page}\n          onBlockTypeError={onBlockTypeError}\n        />\n      ))}\n    </div>\n  )\n}\n","/**\n * Card Renderer (V05-I06.2)\n * \n * Optional wrapper component for rendering content in card format\n * Can be used to wrap sections for consistent card styling\n */\n\n'use client'\n\nimport { type ReactNode } from 'react'\n\nexport type CardRendererProps = {\n  children: ReactNode\n  title?: string\n  className?: string\n}\n\n/**\n * Card Renderer - Wraps content in card styling\n * \n * Provides consistent card appearance across different content blocks\n * Optional title for card header\n */\nexport function CardRenderer({ children, title, className = '' }: CardRendererProps) {\n  return (\n    <div className={`card-renderer bg-white dark:bg-slate-800 rounded-lg shadow-sm border border-slate-200 dark:border-slate-700 ${className}`}>\n      {title && (\n        <div className=\"card-header border-b border-slate-200 dark:border-slate-700 px-6 py-4\">\n          <h3 className=\"text-lg font-semibold text-slate-900 dark:text-slate-100\">\n            {title}\n          </h3>\n        </div>\n      )}\n      <div className=\"card-body p-6\">\n        {children}\n      </div>\n    </div>\n  )\n}\n","import type { ReactNode } from 'react'\n\ntype StandardContentContainerProps = {\n  children: ReactNode\n  className?: string\n}\n\nexport default function StandardContentContainer({\n  children,\n  className = '',\n}: StandardContentContainerProps) {\n  return (\n    <div\n      className={`mx-auto flex w-full max-w-6xl flex-col px-4 ${className}`.trim()}\n    >\n      {children}\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}