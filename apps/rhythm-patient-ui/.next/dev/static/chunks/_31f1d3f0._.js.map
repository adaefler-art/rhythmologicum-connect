{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/work/rhythmologicum-connect/rhythmologicum-connect/lib/logging/logger.ts"],"sourcesContent":["/**\n * B8: Structured Logging Utility\n * \n * Provides consistent, structured logging across the application.\n * Supports multiple log levels and JSON formatting for better monitoring.\n * \n * TODO: Integrate with production error tracking service (Sentry recommended)\n * See: docs/MONITORING_INTEGRATION.md for integration guide\n */\n\nexport enum LogLevel {\n  INFO = 'info',\n  WARN = 'warn',\n  ERROR = 'error',\n}\n\nexport type LogContext = {\n  userId?: string\n  assessmentId?: string\n  stepId?: string\n  questionId?: string\n  endpoint?: string\n  requestId?: string // E6.2.8: Add correlation ID support\n  [key: string]: unknown\n}\n\ntype LogEntry = {\n  timestamp: string\n  level: LogLevel\n  message: string\n  context?: LogContext\n  error?: {\n    message: string\n    stack?: string\n    name?: string\n    digest?: string\n    cause?: string\n    [key: string]: unknown\n  }\n}\n\nconst SENSITIVE_ERROR_KEYS = new Set([\n  'authorization',\n  'cookie',\n  'set-cookie',\n  'token',\n  'accessToken',\n  'refreshToken',\n  'password',\n  'secret',\n  'body',\n  'request',\n  'headers',\n])\n\nfunction safeStringifyCause(cause: unknown): string | undefined {\n  if (cause === undefined || cause === null) return undefined\n  if (cause instanceof Error) return cause.message\n  if (typeof cause === 'string') return cause\n  try {\n    return JSON.stringify(cause, (key, value) => {\n      if (SENSITIVE_ERROR_KEYS.has(key)) return '[REDACTED]'\n      return value\n    })\n  } catch {\n    return undefined\n  }\n}\n\n/**\n * Core logging function with structured output\n * \n * TODO: Integrate with Sentry for production error tracking\n * See: docs/MONITORING_INTEGRATION.md\n */\nfunction log(level: LogLevel, message: string, context?: LogContext, error?: unknown): void {\n  const entry: LogEntry = {\n    timestamp: new Date().toISOString(),\n    level,\n    message,\n  }\n\n  if (context) {\n    entry.context = context\n  }\n\n  if (error) {\n    const normalizedError =\n      error instanceof Error\n        ? {\n            message: error.message,\n            stack: error.stack,\n            name: error.name,\n            digest: typeof (error as { digest?: unknown }).digest === 'string'\n              ? (error as { digest?: string }).digest\n              : undefined,\n            cause: safeStringifyCause((error as { cause?: unknown }).cause),\n          }\n        : {\n            message: typeof error === 'string' ? error : JSON.stringify(error),\n          }\n\n    entry.error = normalizedError\n  }\n\n  // Output as JSON for structured logging\n  const logOutput = JSON.stringify(entry)\n\n  // Route to appropriate console method\n  switch (level) {\n    case LogLevel.ERROR:\n      console.error(logOutput)\n      break\n    case LogLevel.WARN:\n      console.warn(logOutput)\n      break\n    case LogLevel.INFO:\n    default:\n      console.log(logOutput)\n      break\n  }\n}\n\n/**\n * Log info-level message\n */\nexport function logInfo(message: string, context?: LogContext): void {\n  log(LogLevel.INFO, message, context)\n}\n\n/**\n * Log warning-level message\n */\nexport function logWarn(message: string, context?: LogContext): void {\n  log(LogLevel.WARN, message, context)\n}\n\n/**\n * Log error-level message\n */\nexport function logError(message: string, context?: LogContext, error?: unknown): void {\n  log(LogLevel.ERROR, message, context, error)\n}\n\n/**\n * Specialized logging functions for common scenarios\n */\n\nexport function logUnauthorized(context: LogContext): void {\n  logWarn('Unauthorized access attempt', {\n    ...context,\n    type: 'unauthorized',\n  })\n}\n\nexport function logForbidden(context: LogContext, reason: string): void {\n  logWarn(`Forbidden access attempt: ${reason}`, {\n    ...context,\n    type: 'forbidden',\n    reason,\n  })\n}\n\nexport function logStepSkipping(context: LogContext, attemptedStepId: string): void {\n  logWarn('Step-skipping attempt detected', {\n    ...context,\n    type: 'step_skipping',\n    attemptedStepId,\n  })\n}\n\nexport function logValidationFailure(\n  context: LogContext,\n  missingQuestions: Array<{ questionKey: string }>,\n): void {\n  logInfo('Validation failed', {\n    ...context,\n    type: 'validation_failure',\n    missingCount: missingQuestions.length,\n    missingQuestions: missingQuestions.map((q) => q.questionKey),\n  })\n}\n\nexport function logDatabaseError(context: LogContext, error: unknown): void {\n  logError('Database error', context, error)\n}\n\n/**\n * Log expected \"not found\" scenarios (PGRST116 etc.) - warn level, not error\n */\nexport function logNotFound(resource: string, context: LogContext): void {\n  logWarn(`${resource} not found`, {\n    ...context,\n    type: 'not_found',\n    resource,\n  })\n}\n\nexport function logApiRequest(endpoint: string, method: string, context?: LogContext): void {\n  logInfo(`API Request: ${method} ${endpoint}`, {\n    ...context,\n    endpoint,\n    method,\n    type: 'api_request',\n  })\n}\n\n/**\n * Log assessment lifecycle events\n */\n\nexport function logAssessmentStarted(context: LogContext): void {\n  logInfo('Assessment started', {\n    ...context,\n    type: 'assessment_started',\n  })\n}\n\nexport function logAssessmentCompleted(context: LogContext): void {\n  logInfo('Assessment completed', {\n    ...context,\n    type: 'assessment_completed',\n  })\n}\n\n/**\n * V061-I02: Log access to incomplete assessment result\n */\nexport function logIncompleteAssessmentAccess(context: LogContext, status: string): void {\n  logWarn('Access to incomplete assessment result', {\n    ...context,\n    type: 'incomplete_assessment_access',\n    status,\n  })\n}\n\nexport function logAssessmentError(context: LogContext, error: unknown): void {\n  logError('Assessment error', context, error)\n}\n\n/**\n * Log major flow errors for monitoring\n */\n\nexport function logClinicianFlowError(context: LogContext, error: unknown): void {\n  logError('Clinician flow error', { ...context, area: 'clinician' }, error)\n}\n\nexport function logPatientFlowError(context: LogContext, error: unknown): void {\n  logError('Patient flow error', { ...context, area: 'patient' }, error)\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 218, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/work/rhythmologicum-connect/rhythmologicum-connect/apps/rhythm-patient-ui/app/patient/error.tsx"],"sourcesContent":["'use client'\n\nimport { ErrorState } from '@/lib/ui'\nimport { useEffect } from 'react'\nimport { logError } from '@/lib/logging/logger'\n\n/**\n * Error boundary for patient routes\n * \n * This component is displayed when an error occurs in patient pages.\n * Part of V0.4-E6 Technical Cleanup & Stability Layer.\n */\nexport default function PatientError({\n  error,\n  reset,\n}: {\n  error: Error & { digest?: string }\n  reset: () => void\n}) {\n  useEffect(() => {\n    // Log the error\n    logError('Patient route error', { type: 'ui_error', area: 'patient' }, error)\n  }, [error])\n\n  return (\n    <div className=\"w-full min-h-screen flex items-center justify-center bg-white px-4\">\n      <ErrorState\n        title=\"Ein Fehler ist aufgetreten\"\n        message=\"Beim Laden der Seite ist ein Fehler aufgetreten. Bitte versuchen Sie es erneut.\"\n        onRetry={reset}\n        centered\n      />\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AAAA;AACA;AACA;;;AAJA;;;;AAYe,SAAS,aAAa,EACnC,KAAK,EACL,KAAK,EAIN;;IACC,IAAA,0KAAS;kCAAC;YACR,gBAAgB;YAChB,IAAA,uIAAQ,EAAC,uBAAuB;gBAAE,MAAM;gBAAY,MAAM;YAAU,GAAG;QACzE;iCAAG;QAAC;KAAM;IAEV,qBACE,6LAAC;QAAI,WAAU;kBACb,cAAA,6LAAC,yIAAU;YACT,OAAM;YACN,SAAQ;YACR,SAAS;YACT,QAAQ;;;;;;;;;;;AAIhB;GAtBwB;KAAA"}}]
}