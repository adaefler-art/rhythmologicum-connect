{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/work/rhythmologicum-connect/rhythmologicum-connect/app/components/MobileHeader.tsx"],"sourcesContent":["'use client'\n\nimport React from 'react'\nimport { useRouter } from 'next/navigation'\nimport { ArrowLeft, Settings, Info } from 'lucide-react'\nimport { spacing, typography, shadows, colors } from '@/lib/design-tokens'\n\nexport type MobileHeaderVariant = 'minimal' | 'with-title' | 'with-action'\n\nexport type MobileHeaderProps = {\n  /**\n   * Display variant of the header\n   * - 'minimal': Only back button\n   * - 'with-title': Back button + title\n   * - 'with-action': Back button + title + action icon\n   */\n  variant?: MobileHeaderVariant\n  /**\n   * Title to display in the header\n   */\n  title?: string\n  /**\n   * Optional subtitle/breadcrumb text\n   */\n  subtitle?: string\n  /**\n   * Show back button (default: true)\n   */\n  showBack?: boolean\n  /**\n   * Custom back navigation handler\n   * If not provided, uses router.back()\n   */\n  onBack?: () => void\n  /**\n   * Action icon type ('settings' or 'info')\n   */\n  actionIcon?: 'settings' | 'info'\n  /**\n   * Handler for action icon click\n   */\n  onAction?: () => void\n  /**\n   * Additional CSS classes\n   */\n  className?: string\n}\n\n/**\n * MobileHeader Component\n * \n * Global mobile navigation header for all /patient/* pages.\n * Provides consistent back navigation and optional title/actions.\n * \n * Features:\n * - Sticky positioning with elevated z-index\n * - Touch-friendly 44px minimum hit areas\n * - Accessible focus management\n * - Three variants: minimal, with-title, with-action\n * - Consistent design tokens\n * \n * UX Pattern:\n * [‚Üê Back] [Title/Subtitle] [Action Icon]\n * \n * @example\n * // Minimal - just back button\n * <MobileHeader variant=\"minimal\" />\n * \n * @example\n * // With title\n * <MobileHeader variant=\"with-title\" title=\"Stress Assessment\" />\n * \n * @example\n * // With action icon\n * <MobileHeader \n *   variant=\"with-action\" \n *   title=\"Ergebnisse\"\n *   actionIcon=\"info\"\n *   onAction={() => console.log('Info clicked')}\n * />\n */\nexport default function MobileHeader({\n  variant = 'with-title',\n  title,\n  subtitle,\n  showBack = true,\n  onBack,\n  actionIcon = 'settings',\n  onAction,\n  className = '',\n}: MobileHeaderProps) {\n  const router = useRouter()\n\n  const handleBack = () => {\n    if (onBack) {\n      onBack()\n    } else {\n      router.back()\n    }\n  }\n\n  // Render action icon based on type\n  const renderActionIcon = () => {\n    if (!onAction) return null\n\n    const iconProps = {\n      size: 20,\n      strokeWidth: 2,\n      'aria-hidden': true,\n    }\n\n    return (\n      <button\n        type=\"button\"\n        onClick={onAction}\n        className=\"shrink-0 flex items-center justify-center rounded-full bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 active:bg-slate-300 dark:active:bg-slate-500 transition-colors focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-2\"\n        style={{\n          width: '44px',\n          height: '44px',\n        }}\n        aria-label={actionIcon === 'settings' ? 'Einstellungen' : 'Information'}\n      >\n        {actionIcon === 'settings' ? (\n          <Settings {...iconProps} className=\"text-slate-700 dark:text-slate-300\" />\n        ) : (\n          <Info {...iconProps} className=\"text-slate-700 dark:text-slate-300\" />\n        )}\n      </button>\n    )\n  }\n\n  return (\n    <header\n      className={`sticky top-0 bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 transition-colors duration-150 ${className}`}\n      style={{\n        zIndex: 50,\n        boxShadow: shadows.sm,\n      }}\n    >\n      <div\n        className=\"flex items-center gap-3\"\n        style={{\n          padding: `${spacing.sm} ${spacing.md}`,\n          minHeight: '56px',\n        }}\n      >\n        {/* Back Button */}\n        {showBack && (\n          <button\n            type=\"button\"\n            onClick={handleBack}\n            className=\"shrink-0 flex items-center justify-center rounded-full bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 active:bg-slate-300 dark:active:bg-slate-500 transition-colors focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-2\"\n            style={{\n              width: '44px',\n              height: '44px',\n            }}\n            aria-label=\"Zur√ºck\"\n          >\n            <ArrowLeft\n              size={20}\n              strokeWidth={2}\n              className=\"text-slate-700 dark:text-slate-300\"\n              aria-hidden={true}\n            />\n          </button>\n        )}\n\n        {/* Title Section */}\n        {(variant === 'with-title' || variant === 'with-action') && (\n          <div className=\"flex-1 min-w-0\">\n            {subtitle && (\n              <p\n                className=\"text-xs font-medium text-sky-600 dark:text-sky-400 uppercase tracking-wide truncate\"\n                style={{ fontSize: typography.fontSize.xs }}\n              >\n                {subtitle}\n              </p>\n            )}\n            {title && (\n              <h1\n                className=\"font-semibold text-slate-900 dark:text-slate-100 truncate\"\n                style={{\n                  fontSize: typography.fontSize.lg,\n                  lineHeight: typography.lineHeight.tight,\n                }}\n              >\n                {title}\n              </h1>\n            )}\n          </div>\n        )}\n\n        {/* Action Icon */}\n        {variant === 'with-action' && renderActionIcon()}\n      </div>\n    </header>\n  )\n}\n"],"names":[],"mappings":";;;;;AAGA;AACA;AAAA;AAAA;AACA;AAAA;;;AALA;;;;AAiFe,SAAS,aAAa,EACnC,UAAU,YAAY,EACtB,KAAK,EACL,QAAQ,EACR,WAAW,IAAI,EACf,MAAM,EACN,aAAa,UAAU,EACvB,QAAQ,EACR,YAAY,EAAE,EACI;;IAClB,MAAM,SAAS,IAAA,kJAAS;IAExB,MAAM,aAAa;QACjB,IAAI,QAAQ;YACV;QACF,OAAO;YACL,OAAO,IAAI;QACb;IACF;IAEA,mCAAmC;IACnC,MAAM,mBAAmB;QACvB,IAAI,CAAC,UAAU,OAAO;QAEtB,MAAM,YAAY;YAChB,MAAM;YACN,aAAa;YACb,eAAe;QACjB;QAEA,qBACE,6LAAC;YACC,MAAK;YACL,SAAS;YACT,WAAU;YACV,OAAO;gBACL,OAAO;gBACP,QAAQ;YACV;YACA,cAAY,eAAe,aAAa,kBAAkB;sBAEzD,eAAe,2BACd,6LAAC,yNAAQ;gBAAE,GAAG,SAAS;gBAAE,WAAU;;;;;qCAEnC,6LAAC,6MAAI;gBAAE,GAAG,SAAS;gBAAE,WAAU;;;;;;;;;;;IAIvC;IAEA,qBACE,6LAAC;QACC,WAAW,CAAC,uHAAuH,EAAE,WAAW;QAChJ,OAAO;YACL,QAAQ;YACR,WAAW,qIAAO,CAAC,EAAE;QACvB;kBAEA,cAAA,6LAAC;YACC,WAAU;YACV,OAAO;gBACL,SAAS,GAAG,qIAAO,CAAC,EAAE,CAAC,CAAC,EAAE,qIAAO,CAAC,EAAE,EAAE;gBACtC,WAAW;YACb;;gBAGC,0BACC,6LAAC;oBACC,MAAK;oBACL,SAAS;oBACT,WAAU;oBACV,OAAO;wBACL,OAAO;wBACP,QAAQ;oBACV;oBACA,cAAW;8BAEX,cAAA,6LAAC,gOAAS;wBACR,MAAM;wBACN,aAAa;wBACb,WAAU;wBACV,eAAa;;;;;;;;;;;gBAMlB,CAAC,YAAY,gBAAgB,YAAY,aAAa,mBACrD,6LAAC;oBAAI,WAAU;;wBACZ,0BACC,6LAAC;4BACC,WAAU;4BACV,OAAO;gCAAE,UAAU,wIAAU,CAAC,QAAQ,CAAC,EAAE;4BAAC;sCAEzC;;;;;;wBAGJ,uBACC,6LAAC;4BACC,WAAU;4BACV,OAAO;gCACL,UAAU,wIAAU,CAAC,QAAQ,CAAC,EAAE;gCAChC,YAAY,wIAAU,CAAC,UAAU,CAAC,KAAK;4BACzC;sCAEC;;;;;;;;;;;;gBAOR,YAAY,iBAAiB;;;;;;;;;;;;AAItC;GApHwB;;QAUP,kJAAS;;;KAVF"}},
    {"offset": {"line": 166, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/work/rhythmologicum-connect/rhythmologicum-connect/apps/rhythm-patient-ui/app/patient/dashboard/components/DashboardHeader.tsx"],"sourcesContent":["'use client'\n\nimport { typography } from '@/lib/design-tokens'\n\nexport interface DashboardHeaderProps {\n  /** Optional greeting name */\n  greeting?: string\n}\n\n/**\n * Dashboard Header Component\n * \n * Displays a greeting and subtitle for the dashboard.\n * Part of E6.5.4 implementation.\n * \n * Features:\n * - Optional personalized greeting\n * - Responsive typography\n * - Dark mode support\n * \n * @example\n * <DashboardHeader greeting=\"Max\" />\n * \n * @example\n * <DashboardHeader />\n */\nexport function DashboardHeader({ greeting }: DashboardHeaderProps) {\n  return (\n    <div className=\"space-y-2\">\n      <h1\n        className=\"font-bold leading-tight text-slate-900 dark:text-slate-100\"\n        style={{\n          fontSize: typography.fontSize['2xl'],\n          lineHeight: typography.lineHeight.tight,\n        }}\n      >\n        {greeting ? `Willkommen zur√ºck, ${greeting}` : 'Willkommen zur√ºck'}\n      </h1>\n      <p className=\"text-slate-600 dark:text-slate-400\">\n        Ihr pers√∂nliches Gesundheits-Dashboard\n      </p>\n    </div>\n  )\n}\n\nexport default DashboardHeader\n"],"names":[],"mappings":";;;;;;;AAEA;AAAA;AAFA;;;AA0BO,SAAS,gBAAgB,EAAE,QAAQ,EAAwB;IAChE,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBACC,WAAU;gBACV,OAAO;oBACL,UAAU,wIAAU,CAAC,QAAQ,CAAC,MAAM;oBACpC,YAAY,wIAAU,CAAC,UAAU,CAAC,KAAK;gBACzC;0BAEC,WAAW,CAAC,mBAAmB,EAAE,UAAU,GAAG;;;;;;0BAEjD,6LAAC;gBAAE,WAAU;0BAAqC;;;;;;;;;;;;AAKxD;KAjBgB;uCAmBD"}},
    {"offset": {"line": 220, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/work/rhythmologicum-connect/rhythmologicum-connect/apps/rhythm-patient-ui/app/patient/dashboard/components/AMYSlot.tsx"],"sourcesContent":["'use client'\n\nimport { Card } from '@/lib/ui'\n\n/**\n * AMY Slot Component\n * \n * Placeholder component for AMY (AI Assistant) integration.\n * Will be wired in E6.6 with actual AMY functionality.\n * Part of E6.5.4 implementation.\n * \n * Features:\n * - Visual placeholder for AMY assistant\n * - Responsive design\n * - Dark mode support\n * - Ready for E6.6 integration\n * \n * @example\n * <AMYSlot />\n */\nexport function AMYSlot() {\n  return (\n    <Card padding=\"lg\" radius=\"lg\">\n      <div className=\"flex items-start gap-4\">\n        <div className=\"w-12 h-12 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center flex-shrink-0\">\n          <span className=\"text-2xl\" role=\"img\" aria-label=\"AMY Assistant\">\n            ü§ñ\n          </span>\n        </div>\n        <div className=\"flex-1\">\n          <h3 className=\"text-lg font-semibold text-slate-900 dark:text-slate-100 mb-2\">\n            AMY - Ihr pers√∂nlicher Assistent\n          </h3>\n          <p className=\"text-sm text-slate-600 dark:text-slate-400\">\n            AMY wird bald verf√ºgbar sein, um Ihnen personalisierte Einblicke und Empfehlungen zu\n            bieten.\n          </p>\n        </div>\n      </div>\n    </Card>\n  )\n}\n\nexport default AMYSlot\n"],"names":[],"mappings":";;;;;;;AAEA;AAAA;AAFA;;;AAoBO,SAAS;IACd,qBACE,6LAAC,6HAAI;QAAC,SAAQ;QAAK,QAAO;kBACxB,cAAA,6LAAC;YAAI,WAAU;;8BACb,6LAAC;oBAAI,WAAU;8BACb,cAAA,6LAAC;wBAAK,WAAU;wBAAW,MAAK;wBAAM,cAAW;kCAAgB;;;;;;;;;;;8BAInE,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAG,WAAU;sCAAgE;;;;;;sCAG9E,6LAAC;4BAAE,WAAU;sCAA6C;;;;;;;;;;;;;;;;;;;;;;;AAQpE;KArBgB;uCAuBD"}},
    {"offset": {"line": 304, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/work/rhythmologicum-connect/rhythmologicum-connect/lib/api/contracts/triage/index.ts"],"sourcesContent":["/**\n * Triage API Contracts - E6.6.2\n *\n * Versioned schemas for AMY triage endpoints.\n * Stable, testable, governance-ready contracts with strict validation.\n *\n * @module lib/api/contracts/triage\n */\n\nimport { z } from 'zod'\n\n// ============================================================\n// Schema Version\n// ============================================================\n\n/**\n * Current schema version for triage contracts\n */\nexport const TRIAGE_SCHEMA_VERSION = 'v1' as const\n\n// ============================================================\n// Constants & Enums\n// ============================================================\n\n/**\n * Triage tier levels\n */\nexport const TRIAGE_TIER = {\n  INFO: 'INFO',\n  ASSESSMENT: 'ASSESSMENT',\n  ESCALATE: 'ESCALATE',\n} as const\n\nexport type TriageTier = typeof TRIAGE_TIER[keyof typeof TRIAGE_TIER]\n\n/**\n * Next action after triage\n */\nexport const TRIAGE_NEXT_ACTION = {\n  SHOW_CONTENT: 'SHOW_CONTENT',\n  START_FUNNEL_A: 'START_FUNNEL_A',\n  START_FUNNEL_B: 'START_FUNNEL_B',\n  RESUME_FUNNEL: 'RESUME_FUNNEL',\n  SHOW_ESCALATION: 'SHOW_ESCALATION',\n} as const\n\nexport type TriageNextAction = typeof TRIAGE_NEXT_ACTION[keyof typeof TRIAGE_NEXT_ACTION]\n\n/**\n * Red flag allowlist - only these values are permitted\n * Based on existing escalation types in lib/types/escalation.ts\n */\nexport const RED_FLAG_ALLOWLIST = [\n  'report_risk_level',\n  'workup_check',\n  'answer_pattern',\n] as const satisfies readonly string[]\n\nexport type RedFlagType = typeof RED_FLAG_ALLOWLIST[number]\n\n/**\n * Age range buckets for patient context (no PHI)\n */\nexport const AGE_RANGE_BUCKET = {\n  UNDER_18: 'UNDER_18',\n  AGE_18_30: 'AGE_18_30',\n  AGE_31_50: 'AGE_31_50',\n  AGE_51_65: 'AGE_51_65',\n  OVER_65: 'OVER_65',\n} as const\n\nexport type AgeRangeBucket = typeof AGE_RANGE_BUCKET[keyof typeof AGE_RANGE_BUCKET]\n\n// ============================================================\n// Input Validation Constants\n// ============================================================\n\nexport const TRIAGE_INPUT_MIN_LENGTH = 10\nexport const TRIAGE_INPUT_MAX_LENGTH = 800\nexport const TRIAGE_INPUT_VERY_LARGE_THRESHOLD = TRIAGE_INPUT_MAX_LENGTH * 2 // 1600 chars\nexport const TRIAGE_RATIONALE_MAX_LENGTH = 280\nexport const TRIAGE_RATIONALE_MAX_BULLETS = 3\n\n// ============================================================\n// Request Schema - TriageRequestV1\n// ============================================================\n\n/**\n * Optional patient context (anonymized, no PHI)\n */\nexport const PatientContextLiteSchema = z.object({\n  ageRange: z.enum([\n    AGE_RANGE_BUCKET.UNDER_18,\n    AGE_RANGE_BUCKET.AGE_18_30,\n    AGE_RANGE_BUCKET.AGE_31_50,\n    AGE_RANGE_BUCKET.AGE_51_65,\n    AGE_RANGE_BUCKET.OVER_65,\n  ]).optional(),\n}).optional()\n\nexport type PatientContextLite = z.infer<typeof PatientContextLiteSchema>\n\n/**\n * Triage Request V1 Schema\n *\n * AC2: Input is bounded and validated\n */\nexport const TriageRequestV1Schema = z.object({\n  inputText: z.string()\n    .min(TRIAGE_INPUT_MIN_LENGTH, `Input must be at least ${TRIAGE_INPUT_MIN_LENGTH} characters`)\n    .max(TRIAGE_INPUT_MAX_LENGTH, `Input must not exceed ${TRIAGE_INPUT_MAX_LENGTH} characters`),\n  locale: z.string().optional(),\n  patientContext: PatientContextLiteSchema,\n})\n\nexport type TriageRequestV1 = z.infer<typeof TriageRequestV1Schema>\n\n// ============================================================\n// Response Schema - TriageResultV1\n// ============================================================\n\n/**\n * Confidence band (optional, for future AI transparency)\n */\nexport const ConfidenceBandSchema = z.object({\n  value: z.number().min(0).max(1),\n  label: z.enum(['low', 'medium', 'high']).optional(),\n}).optional()\n\nexport type ConfidenceBand = z.infer<typeof ConfidenceBandSchema>\n\n/**\n * Custom validation for rationale:\n * - Must be ‚â§280 characters OR\n * - Must be bullet list with max 3 items\n */\nfunction validateRationale(rationale: string): boolean {\n  // Check if it's a bullet list first\n  const bulletPattern = /^[\\s]*[-*‚Ä¢]\\s+/\n  const lines = rationale.split('\\n').filter(line => line.trim().length > 0)\n  const bulletLines = lines.filter(line => bulletPattern.test(line))\n  \n  if (bulletLines.length > 0) {\n    // It's a bullet list - check max 3 bullets\n    if (bulletLines.length > TRIAGE_RATIONALE_MAX_BULLETS) {\n      return false\n    }\n    // Bullet list with ‚â§3 items is always valid regardless of length\n    return true\n  }\n\n  // Not a bullet list - check simple length bound\n  return rationale.length <= TRIAGE_RATIONALE_MAX_LENGTH\n}\n\n/**\n * Triage Result V1 Schema\n *\n * AC1: Strict schema validation with Zod\n * AC3: rationale hard-bounded, redFlags from allowlist only\n */\nexport const TriageResultV1Schema = z.object({\n  tier: z.enum([\n    TRIAGE_TIER.INFO,\n    TRIAGE_TIER.ASSESSMENT,\n    TRIAGE_TIER.ESCALATE,\n  ]),\n  nextAction: z.enum([\n    TRIAGE_NEXT_ACTION.SHOW_CONTENT,\n    TRIAGE_NEXT_ACTION.START_FUNNEL_A,\n    TRIAGE_NEXT_ACTION.START_FUNNEL_B,\n    TRIAGE_NEXT_ACTION.RESUME_FUNNEL,\n    TRIAGE_NEXT_ACTION.SHOW_ESCALATION,\n  ]),\n  redFlags: z.array(z.string()).refine(\n    (flags) => flags.every(flag => RED_FLAG_ALLOWLIST.includes(flag as RedFlagType)),\n    { message: 'All red flags must be from the allowlist' }\n  ).default([]),\n  rationale: z.string()\n    .refine(validateRationale, {\n      message: `Rationale must be ‚â§${TRIAGE_RATIONALE_MAX_LENGTH} chars or bullet list with max ${TRIAGE_RATIONALE_MAX_BULLETS} items`,\n    }),\n  confidenceBand: ConfidenceBandSchema,\n  version: z.literal(TRIAGE_SCHEMA_VERSION),\n  correlationId: z.string().optional(),\n})\n\nexport type TriageResultV1 = z.infer<typeof TriageResultV1Schema>\n\n// ============================================================\n// API Response Schemas\n// ============================================================\n\n/**\n * Success response\n */\nexport const TriageSuccessResponseSchema = z.object({\n  success: z.literal(true),\n  data: TriageResultV1Schema,\n})\n\nexport type TriageSuccessResponse = z.infer<typeof TriageSuccessResponseSchema>\n\n/**\n * Error response\n */\nexport const TriageErrorResponseSchema = z.object({\n  success: z.literal(false),\n  error: z.object({\n    code: z.string(),\n    message: z.string(),\n    details: z.record(z.string(), z.unknown()).optional(),\n  }),\n})\n\nexport type TriageErrorResponse = z.infer<typeof TriageErrorResponseSchema>\n\n/**\n * Combined response type\n */\nexport const TriageResponseSchema = z.union([\n  TriageSuccessResponseSchema,\n  TriageErrorResponseSchema,\n])\n\nexport type TriageResponse = z.infer<typeof TriageResponseSchema>\n\n// ============================================================\n// Helper Functions\n// ============================================================\n\n/**\n * Validate triage request (throws on error)\n */\nexport function validateTriageRequest(data: unknown): TriageRequestV1 {\n  return TriageRequestV1Schema.parse(data)\n}\n\n/**\n * Safely validate triage request (returns null on error)\n */\nexport function safeValidateTriageRequest(data: unknown): TriageRequestV1 | null {\n  const result = TriageRequestV1Schema.safeParse(data)\n  return result.success ? result.data : null\n}\n\n/**\n * Validate triage result (throws on error)\n */\nexport function validateTriageResult(data: unknown): TriageResultV1 {\n  return TriageResultV1Schema.parse(data)\n}\n\n/**\n * Safely validate triage result (returns null on error)\n */\nexport function safeValidateTriageResult(data: unknown): TriageResultV1 | null {\n  const result = TriageResultV1Schema.safeParse(data)\n  return result.success ? result.data : null\n}\n\n/**\n * Sanitize red flags to only allowlist values\n * AC3: Unknown redFlags are filtered out\n */\nexport function sanitizeRedFlags(redFlags: string[]): RedFlagType[] {\n  return redFlags.filter((flag): flag is RedFlagType =>\n    RED_FLAG_ALLOWLIST.includes(flag as RedFlagType)\n  )\n}\n\n/**\n * Check if input size would trigger 413 or 400\n * AC2: Oversize returns 413 or 400\n */\nexport function getOversizeErrorStatus(inputText: string): 400 | 413 | null {\n  if (inputText.length > TRIAGE_INPUT_MAX_LENGTH) {\n    // Very large inputs get 413 (Request Entity Too Large)\n    // Moderately over limit gets 400 (Bad Request)\n    return inputText.length > TRIAGE_INPUT_VERY_LARGE_THRESHOLD ? 413 : 400\n  }\n  return null\n}\n\n/**\n * Create a bounded rationale (truncate or limit bullets)\n */\nexport function boundRationale(rationale: string): string {\n  // Check if it's already valid\n  if (validateRationale(rationale)) {\n    return rationale\n  }\n\n  // Check if it's a bullet list\n  const bulletPattern = /^[\\s]*[-*‚Ä¢]\\s+/\n  const lines = rationale.split('\\n')\n  const bulletLines = lines.filter(line => bulletPattern.test(line))\n\n  if (bulletLines.length > TRIAGE_RATIONALE_MAX_BULLETS) {\n    // Take first N bullets and reconstruct with original line breaks preserved\n    let bulletCount = 0\n    const boundedLines: string[] = []\n    \n    for (const line of lines) {\n      if (bulletPattern.test(line)) {\n        if (bulletCount >= TRIAGE_RATIONALE_MAX_BULLETS) {\n          break\n        }\n        bulletCount++\n      }\n      boundedLines.push(line)\n    }\n    \n    return boundedLines.join('\\n').trim()\n  }\n\n  // Simple truncation to max length\n  if (rationale.length > TRIAGE_RATIONALE_MAX_LENGTH) {\n    return rationale.slice(0, TRIAGE_RATIONALE_MAX_LENGTH - 3) + '...'\n  }\n\n  return rationale\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 537, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/work/rhythmologicum-connect/rhythmologicum-connect/lib/triage/router.ts"],"sourcesContent":["/**\n * E6.6.5 ‚Äî Triage Router\n *\n * Maps TriageResultV1.nextAction to concrete navigation routes.\n * This is the \"product logic\" that converts triage decisions into user journeys.\n *\n * Key Principles:\n * - AC1: Each nextAction maps to exactly one route (deterministic)\n * - AC2: Router actions are pure functions (testable)\n * - AC3: Navigation always initiated from dashboard\n *\n * @module lib/triage/router\n */\n\nimport type { TriageResultV1, TriageNextAction } from '@/lib/api/contracts/triage'\nimport { TRIAGE_NEXT_ACTION } from '@/lib/api/contracts/triage'\n\n/**\n * Route destination for triage result\n */\nexport type TriageRoute = {\n  /** Target URL to navigate to */\n  path: string\n  /** Optional query parameters */\n  query?: Record<string, string>\n  /** Optional state to pass (for highlighting, etc.) */\n  state?: Record<string, unknown>\n  /** Human-readable description for logging/debugging */\n  description: string\n}\n\n/**\n * Maps TriageNextAction to a concrete route\n *\n * AC1: Each nextAction has exactly one deterministic mapping\n * AC2: Pure function - same input ‚Üí same output\n *\n * @param nextAction - The triage decision\n * @param triageResult - Full triage result for context (e.g., rationale, tier)\n * @returns TriageRoute with path, query, state, and description\n */\nexport function mapNextActionToRoute(\n  nextAction: TriageNextAction,\n  triageResult: TriageResultV1,\n): TriageRoute {\n  switch (nextAction) {\n    case TRIAGE_NEXT_ACTION.SHOW_CONTENT:\n      // Navigate to content tiles section, optionally highlight first tile\n      return {\n        path: '/patient/dashboard',\n        query: {\n          scrollTo: 'content',\n        },\n        state: {\n          highlightContent: true,\n          triageTier: triageResult.tier,\n        },\n        description: 'Show content tiles (INFO tier)',\n      }\n\n    case TRIAGE_NEXT_ACTION.START_FUNNEL_A:\n      // Navigate to stress/resilience funnel\n      return {\n        path: '/patient/funnel/stress-resilience',\n        query: {\n          source: 'triage',\n        },\n        state: {\n          triageRationale: triageResult.rationale,\n          triageTier: triageResult.tier,\n        },\n        description: 'Start Stress & Resilience Assessment (Funnel A)',\n      }\n\n    case TRIAGE_NEXT_ACTION.START_FUNNEL_B:\n      // Navigate to sleep funnel (if implemented)\n      return {\n        path: '/patient/funnel/sleep',\n        query: {\n          source: 'triage',\n        },\n        state: {\n          triageRationale: triageResult.rationale,\n          triageTier: triageResult.tier,\n        },\n        description: 'Start Sleep Assessment (Funnel B)',\n      }\n\n    case TRIAGE_NEXT_ACTION.RESUME_FUNNEL:\n      // Navigate to dashboard with instruction to resume\n      // Dashboard will show \"Next Step\" card with resume CTA\n      return {\n        path: '/patient/dashboard',\n        query: {\n          action: 'resume',\n        },\n        state: {\n          triageRationale: triageResult.rationale,\n        },\n        description: 'Resume existing funnel from dashboard',\n      }\n\n    case TRIAGE_NEXT_ACTION.SHOW_ESCALATION:\n      // Navigate to escalation/support page\n      return {\n        path: '/patient/support',\n        query: {\n          source: 'triage',\n          tier: triageResult.tier,\n        },\n        state: {\n          triageRationale: triageResult.rationale,\n          redFlags: triageResult.redFlags,\n          urgent: true,\n        },\n        description: 'Show escalation support (ESCALATE tier)',\n      }\n\n    default:\n      // Fallback to dashboard (should never happen with proper typing)\n      console.warn('[TriageRouter] Unknown nextAction, falling back to dashboard', {\n        nextAction,\n      })\n      return {\n        path: '/patient/dashboard',\n        query: {},\n        state: {},\n        description: 'Fallback to dashboard (unknown action)',\n      }\n  }\n}\n\n/**\n * Builds a complete URL from a TriageRoute\n *\n * @param route - The route object\n * @returns Full URL string ready for navigation\n *\n * @example\n * const route = mapNextActionToRoute('SHOW_CONTENT', triageResult)\n * const url = buildRouteUrl(route)\n * // ‚Üí '/patient/dashboard?scrollTo=content'\n */\nexport function buildRouteUrl(route: TriageRoute): string {\n  const { path, query } = route\n\n  if (!query || Object.keys(query).length === 0) {\n    return path\n  }\n\n  const queryString = new URLSearchParams(query).toString()\n  return `${path}?${queryString}`\n}\n\n/**\n * Navigate to a route from triage result\n * AC3: Navigation always initiated from dashboard\n *\n * This is a helper that combines mapping + URL building.\n * The actual router.push() call should be done by the caller (AMYComposer).\n *\n * @param nextAction - The triage decision\n * @param triageResult - Full triage result\n * @returns Object with url and state for navigation\n *\n * @example\n * const { url, state } = getNavigationTarget('START_FUNNEL_A', triageResult)\n * router.push(url, { state })\n */\nexport function getNavigationTarget(\n  nextAction: TriageNextAction,\n  triageResult: TriageResultV1,\n): { url: string; state: Record<string, unknown>; description: string } {\n  const route = mapNextActionToRoute(nextAction, triageResult)\n  const url = buildRouteUrl(route)\n\n  return {\n    url,\n    state: route.state || {},\n    description: route.description,\n  }\n}\n\n/**\n * Validates that a nextAction is routable\n *\n * @param nextAction - Action to validate\n * @returns true if action is valid and routable\n */\nexport function isRoutableAction(nextAction: string): nextAction is TriageNextAction {\n  return Object.values(TRIAGE_NEXT_ACTION).includes(nextAction as TriageNextAction)\n}\n"],"names":[],"mappings":"AAAA;;;;;;;;;;;;CAYC;;;;;;;;;;AAGD;;AA0BO,SAAS,qBACd,UAA4B,EAC5B,YAA4B;IAE5B,OAAQ;QACN,KAAK,mKAAkB,CAAC,YAAY;YAClC,qEAAqE;YACrE,OAAO;gBACL,MAAM;gBACN,OAAO;oBACL,UAAU;gBACZ;gBACA,OAAO;oBACL,kBAAkB;oBAClB,YAAY,aAAa,IAAI;gBAC/B;gBACA,aAAa;YACf;QAEF,KAAK,mKAAkB,CAAC,cAAc;YACpC,uCAAuC;YACvC,OAAO;gBACL,MAAM;gBACN,OAAO;oBACL,QAAQ;gBACV;gBACA,OAAO;oBACL,iBAAiB,aAAa,SAAS;oBACvC,YAAY,aAAa,IAAI;gBAC/B;gBACA,aAAa;YACf;QAEF,KAAK,mKAAkB,CAAC,cAAc;YACpC,4CAA4C;YAC5C,OAAO;gBACL,MAAM;gBACN,OAAO;oBACL,QAAQ;gBACV;gBACA,OAAO;oBACL,iBAAiB,aAAa,SAAS;oBACvC,YAAY,aAAa,IAAI;gBAC/B;gBACA,aAAa;YACf;QAEF,KAAK,mKAAkB,CAAC,aAAa;YACnC,mDAAmD;YACnD,uDAAuD;YACvD,OAAO;gBACL,MAAM;gBACN,OAAO;oBACL,QAAQ;gBACV;gBACA,OAAO;oBACL,iBAAiB,aAAa,SAAS;gBACzC;gBACA,aAAa;YACf;QAEF,KAAK,mKAAkB,CAAC,eAAe;YACrC,sCAAsC;YACtC,OAAO;gBACL,MAAM;gBACN,OAAO;oBACL,QAAQ;oBACR,MAAM,aAAa,IAAI;gBACzB;gBACA,OAAO;oBACL,iBAAiB,aAAa,SAAS;oBACvC,UAAU,aAAa,QAAQ;oBAC/B,QAAQ;gBACV;gBACA,aAAa;YACf;QAEF;YACE,iEAAiE;YACjE,QAAQ,IAAI,CAAC,gEAAgE;gBAC3E;YACF;YACA,OAAO;gBACL,MAAM;gBACN,OAAO,CAAC;gBACR,OAAO,CAAC;gBACR,aAAa;YACf;IACJ;AACF;AAaO,SAAS,cAAc,KAAkB;IAC9C,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG;IAExB,IAAI,CAAC,SAAS,OAAO,IAAI,CAAC,OAAO,MAAM,KAAK,GAAG;QAC7C,OAAO;IACT;IAEA,MAAM,cAAc,IAAI,gBAAgB,OAAO,QAAQ;IACvD,OAAO,GAAG,KAAK,CAAC,EAAE,aAAa;AACjC;AAiBO,SAAS,oBACd,UAA4B,EAC5B,YAA4B;IAE5B,MAAM,QAAQ,qBAAqB,YAAY;IAC/C,MAAM,MAAM,cAAc;IAE1B,OAAO;QACL;QACA,OAAO,MAAM,KAAK,IAAI,CAAC;QACvB,aAAa,MAAM,WAAW;IAChC;AACF;AAQO,SAAS,iBAAiB,UAAkB;IACjD,OAAO,OAAO,MAAM,CAAC,mKAAkB,EAAE,QAAQ,CAAC;AACpD"}},
    {"offset": {"line": 670, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/work/rhythmologicum-connect/rhythmologicum-connect/lib/triage/storage.ts"],"sourcesContent":["/**\n * E6.6.5 ‚Äî Triage Storage Helper\n *\n * Utility for storing and retrieving triage results from sessionStorage.\n * Supports retry/rationale display and debugging.\n *\n * @module lib/triage/storage\n */\n\nimport { safeValidateTriageResult, type TriageResultV1 } from '@/lib/api/contracts/triage'\n\n/**\n * Storage key for last triage result\n */\nconst STORAGE_KEY = 'lastTriageResult'\n\n/**\n * Stores a triage result in sessionStorage\n * E6.6.5: Store last result for rationale/retry\n *\n * @param result - The triage result to store\n * @returns true if stored successfully, false otherwise\n */\nexport function storeTriageResult(result: TriageResultV1): boolean {\n  if (typeof window === 'undefined' || !window.sessionStorage) {\n    console.warn('[TriageStorage] sessionStorage not available')\n    return false\n  }\n\n  try {\n    const serialized = JSON.stringify(result)\n    window.sessionStorage.setItem(STORAGE_KEY, serialized)\n    return true\n  } catch (error) {\n    console.error('[TriageStorage] Failed to store triage result', error)\n    return false\n  }\n}\n\n/**\n * Retrieves the last triage result from sessionStorage\n *\n * @returns The last triage result, or null if not found or invalid\n */\nexport function getLastTriageResult(): TriageResultV1 | null {\n  if (typeof window === 'undefined' || !window.sessionStorage) {\n    return null\n  }\n\n  try {\n    const serialized = window.sessionStorage.getItem(STORAGE_KEY)\n    \n    if (!serialized) {\n      return null\n    }\n\n    const parsed = JSON.parse(serialized)\n    \n    // Validate that it's a proper TriageResultV1\n    const validated = safeValidateTriageResult(parsed)\n    \n    if (!validated) {\n      console.warn('[TriageStorage] Stored result failed validation, clearing')\n      clearTriageResult()\n      return null\n    }\n\n    return validated\n  } catch (error) {\n    console.error('[TriageStorage] Failed to retrieve triage result', error)\n    clearTriageResult()\n    return null\n  }\n}\n\n/**\n * Clears the stored triage result\n * \n * @returns void\n */\nexport function clearTriageResult(): void {\n  if (typeof window === 'undefined' || !window.sessionStorage) {\n    return\n  }\n\n  try {\n    window.sessionStorage.removeItem(STORAGE_KEY)\n  } catch (error) {\n    console.error('[TriageStorage] Failed to clear triage result', error)\n  }\n}\n\n/**\n * Checks if a triage result is stored\n *\n * @returns true if a valid triage result is stored\n */\nexport function hasStoredTriageResult(): boolean {\n  return getLastTriageResult() !== null\n}\n"],"names":[],"mappings":";;;;;;;;;;AAAA;;;;;;;CAOC,GAED;;AAEA;;CAEC,GACD,MAAM,cAAc;AASb,SAAS,kBAAkB,MAAsB;IACtD,IAAI,+CAAkB,eAAe,CAAC,OAAO,cAAc,EAAE;QAC3D,QAAQ,IAAI,CAAC;QACb,OAAO;IACT;IAEA,IAAI;QACF,MAAM,aAAa,KAAK,SAAS,CAAC;QAClC,OAAO,cAAc,CAAC,OAAO,CAAC,aAAa;QAC3C,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,iDAAiD;QAC/D,OAAO;IACT;AACF;AAOO,SAAS;IACd,IAAI,+CAAkB,eAAe,CAAC,OAAO,cAAc,EAAE;QAC3D,OAAO;IACT;IAEA,IAAI;QACF,MAAM,aAAa,OAAO,cAAc,CAAC,OAAO,CAAC;QAEjD,IAAI,CAAC,YAAY;YACf,OAAO;QACT;QAEA,MAAM,SAAS,KAAK,KAAK,CAAC;QAE1B,6CAA6C;QAC7C,MAAM,YAAY,IAAA,yKAAwB,EAAC;QAE3C,IAAI,CAAC,WAAW;YACd,QAAQ,IAAI,CAAC;YACb;YACA,OAAO;QACT;QAEA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,oDAAoD;QAClE;QACA,OAAO;IACT;AACF;AAOO,SAAS;IACd,IAAI,+CAAkB,eAAe,CAAC,OAAO,cAAc,EAAE;QAC3D;IACF;IAEA,IAAI;QACF,OAAO,cAAc,CAAC,UAAU,CAAC;IACnC,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,iDAAiD;IACjE;AACF;AAOO,SAAS;IACd,OAAO,0BAA0B;AACnC"}},
    {"offset": {"line": 750, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/work/rhythmologicum-connect/rhythmologicum-connect/apps/rhythm-patient-ui/app/patient/dashboard/components/AMYComposer.tsx"],"sourcesContent":["'use client'\n\nimport { useState } from 'react'\nimport { useRouter } from 'next/navigation'\nimport { Card, Textarea, Button, Alert } from '@/lib/ui'\nimport { getNavigationTarget, isRoutableAction } from '@/lib/triage/router'\nimport { storeTriageResult } from '@/lib/triage/storage'\nimport type { TriageResultV1 } from '@/lib/api/contracts/triage'\nimport { NON_EMERGENCY_DISCLAIMER, STANDARD_EMERGENCY_GUIDANCE } from '@/lib/safety/disclaimers'\n\n/**\n * E6.6.1 + E6.6.5 + E6.6.9 ‚Äî AMY Composer Component\n * \n * Bounded, guided mode for patient-initiated AMY interactions.\n * E6.6.5: Integrates triage router for navigation after triage.\n * E6.6.9: Dev harness with quick-fill test inputs (dev-only).\n * \n * Features:\n * - AC1: Max length enforced client-side (up to 800 chars, recommended 500)\n * - AC2: Single-turn interaction (no chat history)\n * - AC3: Non-emergency disclaimer visible\n * - AC4: Submit triggers triage API call and shows routed result\n * - E6.6.5: Router applies TriageResult ‚Üí Navigation (Dashboard-first)\n * - E6.6.9: Dev UI quick-fill buttons (non-prod only)\n * \n * UX:\n * - Character counter\n * - Loading state during API call\n * - Error state handling\n * - Clear result display with navigation CTA\n * - Optional: Suggested chips for guided input\n * - Dev-only: Quick-fill test inputs for deterministic testing\n */\n\nconst MAX_LENGTH = 800 // AC1: Client-side validation\nconst RECOMMENDED_LENGTH = 500 // Soft recommendation\n\ntype TriageState = 'idle' | 'loading' | 'success' | 'error'\n\n// Optional: Suggested chips for guided input\nconst SUGGESTED_CONCERNS = [\n  'üí§ Schlafprobleme',\n  'üò∞ Stress',\n  'üíì Herzklopfen',\n  'üòü Sorgen',\n]\n\n// E6.6.9: Dev harness - Quick-fill test inputs (deterministic)\n// AC2: Only shown in non-production environments\nconst DEV_QUICK_FILLS = [\n  {\n    label: 'üí¨ Info',\n    text: 'Was ist Stress und wie wirkt er sich auf meine Gesundheit aus?',\n    tier: 'INFO',\n    color: 'green',\n  },\n  {\n    label: 'üìã Assessment',\n    text: 'Ich f√ºhle mich sehr gestresst und ersch√∂pft in letzter Zeit. Es f√§llt mir schwer, mich zu konzentrieren.',\n    tier: 'ASSESSMENT',\n    color: 'amber',\n  },\n  {\n    label: 'üö® Escalate',\n    text: 'Ich habe Suizidgedanken und wei√ü nicht mehr weiter. Alles f√ºhlt sich hoffnungslos an.',\n    tier: 'ESCALATE',\n    color: 'red',\n  },\n] as const\n\n// E6.6.9: Helper to get button styles based on tier color\nconst getQuickFillButtonStyles = (color: 'green' | 'amber' | 'red'): string => {\n  const baseStyles = 'px-3 py-2 text-xs font-medium rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed'\n  \n  const colorStyles = {\n    green: 'bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300 hover:bg-green-200 dark:hover:bg-green-900/50',\n    amber: 'bg-amber-100 dark:bg-amber-900/30 text-amber-800 dark:text-amber-300 hover:bg-amber-200 dark:hover:bg-amber-900/50',\n    red: 'bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-300 hover:bg-red-200 dark:hover:bg-red-900/50',\n  }\n  \n  return `${baseStyles} ${colorStyles[color]}`\n}\n\n// E6.6.9 AC2: Dev harness visibility configuration\n// Set to true only in development/preview environments\n// In production, this should be false to hide dev tools from end users\n// Note: Can be toggled via browser localStorage for testing:\n//   localStorage.setItem('devHarnessEnabled', 'true')\nconst isDevHarnessEnabled = (): boolean => {\n  if (typeof window === 'undefined') {\n    return false // Server-side: disabled\n  }\n  \n  // Check localStorage override first (for testing in deployed environments)\n  // Wrapped in try-catch to handle SecurityError in sandboxed environments\n  try {\n    const storageOverride = localStorage.getItem('devHarnessEnabled')\n    if (storageOverride === 'true') {\n      return true\n    }\n  } catch (error) {\n    // localStorage access failed (sandboxed environment, disabled storage, etc.)\n    // Continue to hostname checks\n    console.debug('[DevHarness] localStorage access failed, using hostname check only', error)\n  }\n  \n  // Check hostname to auto-enable on localhost/preview deployments\n  const hostname = window.location.hostname\n  return (\n    hostname === 'localhost' ||\n    hostname === '127.0.0.1' ||\n    hostname.includes('preview') ||\n    hostname.includes('dev-')\n  )\n}\n\nexport function AMYComposer() {\n  const router = useRouter()\n  const [concern, setConcern] = useState('')\n  const [state, setState] = useState<TriageState>('idle')\n  const [result, setResult] = useState<TriageResultV1 | null>(null)\n  const [error, setError] = useState<string | null>(null)\n  const [showDevHarness, setShowDevHarness] = useState(false)\n\n  const charCount = concern.length\n  const isOverLimit = charCount > MAX_LENGTH\n  const isNearLimit = charCount > RECOMMENDED_LENGTH && charCount <= MAX_LENGTH\n  const canSubmit = concern.trim().length >= 10 && !isOverLimit && state !== 'loading'\n\n  // E6.6.9: Handler for dev quick-fill buttons\n  const handleDevQuickFill = (text: string) => {\n    setConcern(text)\n    setState('idle')\n    setResult(null)\n    setError(null)\n  }\n\n  const handleSubmit = async () => {\n    if (!canSubmit) return\n\n    setState('loading')\n    setError(null)\n    setResult(null)\n\n    try {\n      const response = await fetch('/api/amy/triage', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ concern: concern.trim() }),\n      })\n\n      const data = await response.json()\n\n      if (!response.ok) {\n        throw new Error(data.error || 'Triage request failed')\n      }\n\n      if (data.success && data.data) {\n        const triageResult = data.data as TriageResultV1\n        setResult(triageResult)\n        setState('success')\n\n        // E6.6.5: Store last triage result for rationale/retry\n        storeTriageResult(triageResult)\n      } else {\n        throw new Error('Invalid response format')\n      }\n    } catch (err) {\n      console.error('[AMYComposer] Triage failed', err)\n      setError(err instanceof Error ? err.message : 'Ein unerwarteter Fehler ist aufgetreten.')\n      setState('error')\n    }\n  }\n\n  // E6.6.5: Handle navigation based on triage result\n  const handleNavigate = () => {\n    if (!result) return\n\n    // Validate nextAction is routable\n    if (!isRoutableAction(result.nextAction)) {\n      console.error('[AMYComposer] Invalid nextAction', { nextAction: result.nextAction })\n      setError('Ung√ºltige Triage-Aktion. Bitte versuchen Sie es erneut.')\n      return\n    }\n\n    // Get navigation target from router\n    const { url, description } = getNavigationTarget(result.nextAction, result)\n\n    console.log('[AMYComposer] Navigating to', { url, description, tier: result.tier })\n\n    // Navigate to target\n    router.push(url)\n  }\n\n  const handleChipClick = (chip: string) => {\n    // Extract text after emoji (emojis are typically 1-2 chars at start)\n    // This preserves German characters (√§, √∂, √º, √ü)\n    const text = chip.slice(2).trim() // Remove emoji and leading space\n    if (concern) {\n      setConcern(concern + ', ' + text)\n    } else {\n      setConcern(text)\n    }\n  }\n\n  const handleReset = () => {\n    setConcern('')\n    setState('idle')\n    setResult(null)\n    setError(null)\n  }\n\n  return (\n    <Card padding=\"lg\" radius=\"lg\">\n      <div className=\"space-y-4\">\n        {/* Header with AMY branding */}\n        <div className=\"flex items-start gap-4\">\n          <div className=\"w-12 h-12 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center flex-shrink-0\">\n            <span className=\"text-2xl\" role=\"img\" aria-label=\"AMY Assistant\">\n              ü§ñ\n            </span>\n          </div>\n          <div className=\"flex-1\">\n            <h3 className=\"text-lg font-semibold text-slate-900 dark:text-slate-100 mb-1\">\n              AMY - Ihr pers√∂nlicher Assistent\n            </h3>\n            <p className=\"text-sm text-slate-600 dark:text-slate-400\">\n              Beschreiben Sie Ihr Anliegen in 1‚Äì2 S√§tzen\n            </p>\n          </div>\n        </div>\n\n        {/* AC3: Non-emergency disclaimer - E6.6.8: Use centralized disclaimer */}\n        <Alert variant=\"info\">\n          <p className=\"text-sm\">\n            <strong>{NON_EMERGENCY_DISCLAIMER.title}:</strong> {NON_EMERGENCY_DISCLAIMER.text}\n          </p>\n        </Alert>\n\n        {/* E6.6.9: Dev Harness - Quick-fill test inputs (AC2: dev-only) */}\n        {isDevHarnessEnabled() && (\n          <div className=\"border-2 border-dashed border-purple-300 dark:border-purple-700 rounded-lg p-4 bg-purple-50 dark:bg-purple-950/20\">\n            <div className=\"flex items-center justify-between mb-3\">\n              <div className=\"flex items-center gap-2\">\n                <span className=\"text-lg\" role=\"img\" aria-label=\"Developer\">\n                  üë®‚Äçüíª\n                </span>\n                <h4 className=\"text-sm font-semibold text-purple-900 dark:text-purple-300\">\n                  Dev Harness - Test Inputs\n                </h4>\n              </div>\n              <button\n                type=\"button\"\n                onClick={() => setShowDevHarness(!showDevHarness)}\n                className=\"text-xs px-2 py-1 rounded bg-purple-200 dark:bg-purple-800 text-purple-900 dark:text-purple-300 hover:bg-purple-300 dark:hover:bg-purple-700 transition-colors\"\n              >\n                {showDevHarness ? 'Hide' : 'Show'}\n              </button>\n            </div>\n            \n            {showDevHarness && (\n              <div className=\"space-y-2\">\n                <p className=\"text-xs text-purple-700 dark:text-purple-400 mb-2\">\n                  Deterministic test inputs for all router paths (INFO/ASSESSMENT/ESCALATE)\n                </p>\n                <div className=\"flex flex-wrap gap-2\">\n                  {DEV_QUICK_FILLS.map((fill) => (\n                    <button\n                      key={fill.label}\n                      type=\"button\"\n                      onClick={() => handleDevQuickFill(fill.text)}\n                      disabled={state === 'loading'}\n                      className={getQuickFillButtonStyles(fill.color)}\n                    >\n                      {fill.label}\n                    </button>\n                  ))}\n                </div>\n                <p className=\"text-xs text-purple-600 dark:text-purple-400 mt-2\">\n                  ‚ö†Ô∏è Dev-only feature. Hidden in production.\n                </p>\n              </div>\n            )}\n          </div>\n        )}\n\n        {/* Show input form when idle/loading/error */}\n        {(state === 'idle' || state === 'loading' || state === 'error') && (\n          <>\n            {/* Optional: Suggested chips */}\n            <div className=\"flex flex-wrap gap-2\">\n              {SUGGESTED_CONCERNS.map((chip) => (\n                <button\n                  key={chip}\n                  type=\"button\"\n                  onClick={() => handleChipClick(chip)}\n                  disabled={state === 'loading'}\n                  className=\"px-3 py-1.5 text-sm rounded-full bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n                >\n                  {chip}\n                </button>\n              ))}\n            </div>\n\n            {/* Textarea with character counter */}\n            <div className=\"space-y-2\">\n              <Textarea\n                value={concern}\n                onChange={(e) => setConcern(e.target.value)}\n                placeholder=\"z.B. Ich habe in letzter Zeit Schlafprobleme und f√ºhle mich gestresst...\"\n                rows={4}\n                disabled={state === 'loading'}\n                error={isOverLimit}\n                errorMessage={\n                  isOverLimit ? `Maximal ${MAX_LENGTH} Zeichen erlaubt` : undefined\n                }\n                helperText={\n                  !isOverLimit && isNearLimit\n                    ? `Empfohlen: bis zu ${RECOMMENDED_LENGTH} Zeichen`\n                    : undefined\n                }\n                maxLength={MAX_LENGTH + 50} // Allow typing a bit over to show error\n              />\n              <div className=\"flex justify-between items-center text-sm\">\n                <span\n                  className={`${\n                    isOverLimit\n                      ? 'text-red-600 dark:text-red-400 font-medium'\n                      : isNearLimit\n                        ? 'text-amber-600 dark:text-amber-400'\n                        : 'text-slate-500 dark:text-slate-400'\n                  }`}\n                >\n                  {charCount} / {MAX_LENGTH} Zeichen\n                </span>\n                {concern.trim().length < 10 && concern.trim().length > 0 && (\n                  <span className=\"text-slate-500 dark:text-slate-400 text-xs\">\n                    Mindestens 10 Zeichen erforderlich\n                  </span>\n                )}\n              </div>\n            </div>\n\n            {/* Error display */}\n            {error && (\n              <Alert variant=\"error\">\n                <p className=\"text-sm\">{error}</p>\n              </Alert>\n            )}\n\n            {/* Submit button */}\n            <Button\n              variant=\"primary\"\n              fullWidth\n              onClick={handleSubmit}\n              disabled={!canSubmit}\n              loading={state === 'loading'}\n            >\n              {state === 'loading' ? 'Wird analysiert...' : 'Anliegen einreichen'}\n            </Button>\n          </>\n        )}\n\n        {/* Show result when successful */}\n        {state === 'success' && result && (\n          <div className=\"space-y-4\">\n            {/* Tier badge - E6.6.5: Use v1 tier format */}\n            <div className=\"flex items-center gap-2\">\n              <span\n                className={`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${\n                  result.tier === 'ESCALATE'\n                    ? 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300'\n                    : result.tier === 'ASSESSMENT'\n                      ? 'bg-amber-100 text-amber-800 dark:bg-amber-900/30 dark:text-amber-300'\n                      : 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300'\n                }`}\n              >\n                {result.tier === 'ESCALATE'\n                  ? 'üö® Dringend'\n                  : result.tier === 'ASSESSMENT'\n                    ? 'üìã Einsch√§tzung empfohlen'\n                    : '‚úÖ Information'}\n              </span>\n            </div>\n\n            {/* Rationale - E6.6.5: Show rationale from v1 result */}\n            <div className=\"prose prose-sm dark:prose-invert max-w-none\">\n              <p className=\"text-slate-700 dark:text-slate-300 leading-relaxed\">\n                {result.rationale}\n              </p>\n            </div>\n\n            {/* E6.6.5: Navigation CTA based on nextAction */}\n            <div className=\"space-y-3\">\n              <Button variant=\"primary\" fullWidth onClick={handleNavigate}>\n                {result.nextAction === 'SHOW_CONTENT' && 'üìö Inhalte ansehen'}\n                {result.nextAction === 'START_FUNNEL_A' && 'üìã Fragebogen starten'}\n                {result.nextAction === 'START_FUNNEL_B' && 'üí§ Schlaf-Assessment starten'}\n                {result.nextAction === 'RESUME_FUNNEL' && '‚ñ∂Ô∏è Fragebogen fortsetzen'}\n                {result.nextAction === 'SHOW_ESCALATION' && 'üÜò Unterst√ºtzung erhalten'}\n              </Button>\n\n              {/* Secondary action: Try again */}\n              <Button variant=\"secondary\" fullWidth onClick={handleReset}>\n                Neues Anliegen eingeben\n              </Button>\n            </div>\n\n            {/* Escalation warning for urgent cases - E6.6.8: Use centralized guidance */}\n            {result.tier === 'ESCALATE' && (\n              <Alert variant=\"error\">\n                <p className=\"text-sm font-medium\">\n                  <strong>{STANDARD_EMERGENCY_GUIDANCE.title}:</strong>{' '}\n                  {STANDARD_EMERGENCY_GUIDANCE.text}\n                </p>\n              </Alert>\n            )}\n          </div>\n        )}\n      </div>\n    </Card>\n  )\n}\n\nexport default AMYComposer\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 1372, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/work/rhythmologicum-connect/rhythmologicum-connect/apps/rhythm-patient-ui/app/patient/dashboard/components/NextStepCard.tsx"],"sourcesContent":["'use client'\n\nimport { Card } from '@/lib/ui'\nimport type { NextStep } from '@/lib/api/contracts/patient/dashboard'\n\nexport interface NextStepCardProps {\n  /** Next step data from dashboard API */\n  nextStep: NextStep\n  /** Callback when CTA is clicked */\n  onAction?: () => void\n}\n\n/**\n * Next Step Card Component\n * \n * Displays the next action for the patient to take.\n * Part of E6.5.4 implementation.\n * \n * Features:\n * - Always visible when nextStep is available (AC3)\n * - Visual prominence with icon\n * - Responsive design\n * - Dark mode support\n * - CTA button for action\n * \n * @example\n * <NextStepCard\n *   nextStep={{\n *     type: 'funnel',\n *     target: '/patient/funnel/stress',\n *     label: 'Continue Stress Assessment'\n *   }}\n *   onAction={handleAction}\n * />\n */\nexport function NextStepCard({ nextStep, onAction }: NextStepCardProps) {\n  // Don't render if type is 'none'\n  if (nextStep.type === 'none') {\n    return null\n  }\n\n  // Icon mapping based on next step type\n  const iconMap = {\n    onboarding: 'üìã',\n    funnel: 'üéØ',\n    result: 'üìä',\n    content: 'üìñ',\n    none: '',\n  }\n\n  const icon = iconMap[nextStep.type]\n\n  return (\n    <Card padding=\"lg\" radius=\"lg\" className=\"border-2 border-sky-200 dark:border-sky-800\">\n      <div className=\"space-y-4\">\n        <div className=\"flex items-center gap-3\">\n          <div className=\"w-12 h-12 rounded-full bg-sky-100 dark:bg-sky-900/30 flex items-center justify-center flex-shrink-0\">\n            <span className=\"text-2xl\" role=\"img\" aria-label=\"Next step\">\n              {icon}\n            </span>\n          </div>\n          <div className=\"flex-1\">\n            <h2 className=\"text-xl font-semibold text-slate-900 dark:text-slate-100\">\n              N√§chster Schritt\n            </h2>\n            <p className=\"text-sm text-slate-600 dark:text-slate-400\">{nextStep.label}</p>\n          </div>\n        </div>\n\n        {nextStep.target && (\n          <button\n            onClick={onAction}\n            className=\"w-full px-6 py-3 bg-sky-600 hover:bg-sky-700 text-white font-medium rounded-lg transition-colors duration-200\"\n          >\n            {nextStep.label}\n          </button>\n        )}\n      </div>\n    </Card>\n  )\n}\n\nexport default NextStepCard\n"],"names":[],"mappings":";;;;;;;AAEA;AAAA;AAFA;;;AAmCO,SAAS,aAAa,EAAE,QAAQ,EAAE,QAAQ,EAAqB;IACpE,iCAAiC;IACjC,IAAI,SAAS,IAAI,KAAK,QAAQ;QAC5B,OAAO;IACT;IAEA,uCAAuC;IACvC,MAAM,UAAU;QACd,YAAY;QACZ,QAAQ;QACR,QAAQ;QACR,SAAS;QACT,MAAM;IACR;IAEA,MAAM,OAAO,OAAO,CAAC,SAAS,IAAI,CAAC;IAEnC,qBACE,6LAAC,6HAAI;QAAC,SAAQ;QAAK,QAAO;QAAK,WAAU;kBACvC,cAAA,6LAAC;YAAI,WAAU;;8BACb,6LAAC;oBAAI,WAAU;;sCACb,6LAAC;4BAAI,WAAU;sCACb,cAAA,6LAAC;gCAAK,WAAU;gCAAW,MAAK;gCAAM,cAAW;0CAC9C;;;;;;;;;;;sCAGL,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAG,WAAU;8CAA2D;;;;;;8CAGzE,6LAAC;oCAAE,WAAU;8CAA8C,SAAS,KAAK;;;;;;;;;;;;;;;;;;gBAI5E,SAAS,MAAM,kBACd,6LAAC;oBACC,SAAS;oBACT,WAAU;8BAET,SAAS,KAAK;;;;;;;;;;;;;;;;;AAM3B;KA7CgB;uCA+CD"}},
    {"offset": {"line": 1488, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/work/rhythmologicum-connect/rhythmologicum-connect/apps/rhythm-patient-ui/app/patient/dashboard/components/ContentTilesGrid.tsx"],"sourcesContent":["'use client'\n\nimport { Card } from '@/lib/ui'\nimport type { ContentTile } from '@/lib/api/contracts/patient/dashboard'\n\nexport interface ContentTilesGridProps {\n  /** Array of content tiles from dashboard API */\n  tiles: ContentTile[]\n  /** Callback when a tile is clicked */\n  onTileClick?: (tile: ContentTile) => void\n}\n\n/**\n * Content Tiles Grid Component\n * \n * Displays a grid of content tiles for the patient.\n * Part of E6.5.4 implementation.\n * \n * Features:\n * - Responsive grid layout\n * - Empty state handling\n * - Interactive tiles with hover effects\n * - Dark mode support\n * - Sorted by priority\n * \n * @example\n * <ContentTilesGrid\n *   tiles={[\n *     { id: '1', type: 'info', title: 'Health Tips', ... }\n *   ]}\n *   onTileClick={handleTileClick}\n * />\n */\nexport function ContentTilesGrid({ tiles, onTileClick }: ContentTilesGridProps) {\n  // Sort tiles by priority (higher priority first)\n  const sortedTiles = [...tiles].sort((a, b) => b.priority - a.priority)\n\n  // Icon mapping based on tile type\n  const iconMap = {\n    info: 'üí°',\n    action: '‚ö°',\n    promotion: 'üéÅ',\n  }\n\n  // Empty state\n  if (tiles.length === 0) {\n    return (\n      <div className=\"text-center py-8\">\n        <div className=\"text-4xl mb-3\">üìö</div>\n        <h3 className=\"text-lg font-medium text-slate-900 dark:text-slate-100 mb-2\">\n          Noch keine Inhalte verf√ºgbar\n        </h3>\n        <p className=\"text-sm text-slate-600 dark:text-slate-400\">\n          Neue Inhalte werden bald hinzugef√ºgt.\n        </p>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"space-y-3\">\n      <h3 className=\"text-lg font-semibold text-slate-900 dark:text-slate-100\">\n        Empfohlene Inhalte\n      </h3>\n      <div className=\"grid gap-4 sm:grid-cols-2 lg:grid-cols-3\">\n        {sortedTiles.map((tile) => (\n          <Card\n            key={tile.id}\n            padding=\"md\"\n            radius=\"lg\"\n            interactive={!!tile.actionTarget}\n            onClick={() => {\n              if (tile.actionTarget && onTileClick) {\n                onTileClick(tile)\n              }\n            }}\n          >\n            <div className=\"space-y-3\">\n              <div className=\"flex items-start gap-3\">\n                <span className=\"text-2xl flex-shrink-0\" role=\"img\" aria-label={tile.type}>\n                  {iconMap[tile.type]}\n                </span>\n                <div className=\"flex-1 min-w-0\">\n                  <h4 className=\"font-medium text-slate-900 dark:text-slate-100 mb-1 truncate\">\n                    {tile.title}\n                  </h4>\n                  {tile.description && (\n                    <p className=\"text-sm text-slate-600 dark:text-slate-400 line-clamp-2\">\n                      {tile.description}\n                    </p>\n                  )}\n                </div>\n              </div>\n              {tile.actionLabel && tile.actionTarget && (\n                <div className=\"pt-2 border-t border-slate-200 dark:border-slate-700\">\n                  <span className=\"text-sm text-sky-600 dark:text-sky-400 font-medium\">\n                    {tile.actionLabel} ‚Üí\n                  </span>\n                </div>\n              )}\n            </div>\n          </Card>\n        ))}\n      </div>\n    </div>\n  )\n}\n\nexport default ContentTilesGrid\n"],"names":[],"mappings":";;;;;;;AAEA;AAAA;AAFA;;;AAiCO,SAAS,iBAAiB,EAAE,KAAK,EAAE,WAAW,EAAyB;IAC5E,iDAAiD;IACjD,MAAM,cAAc;WAAI;KAAM,CAAC,IAAI,CAAC,CAAC,GAAG,IAAM,EAAE,QAAQ,GAAG,EAAE,QAAQ;IAErE,kCAAkC;IAClC,MAAM,UAAU;QACd,MAAM;QACN,QAAQ;QACR,WAAW;IACb;IAEA,cAAc;IACd,IAAI,MAAM,MAAM,KAAK,GAAG;QACtB,qBACE,6LAAC;YAAI,WAAU;;8BACb,6LAAC;oBAAI,WAAU;8BAAgB;;;;;;8BAC/B,6LAAC;oBAAG,WAAU;8BAA8D;;;;;;8BAG5E,6LAAC;oBAAE,WAAU;8BAA6C;;;;;;;;;;;;IAKhE;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAG,WAAU;0BAA2D;;;;;;0BAGzE,6LAAC;gBAAI,WAAU;0BACZ,YAAY,GAAG,CAAC,CAAC,qBAChB,6LAAC,6HAAI;wBAEH,SAAQ;wBACR,QAAO;wBACP,aAAa,CAAC,CAAC,KAAK,YAAY;wBAChC,SAAS;4BACP,IAAI,KAAK,YAAY,IAAI,aAAa;gCACpC,YAAY;4BACd;wBACF;kCAEA,cAAA,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;oCAAI,WAAU;;sDACb,6LAAC;4CAAK,WAAU;4CAAyB,MAAK;4CAAM,cAAY,KAAK,IAAI;sDACtE,OAAO,CAAC,KAAK,IAAI,CAAC;;;;;;sDAErB,6LAAC;4CAAI,WAAU;;8DACb,6LAAC;oDAAG,WAAU;8DACX,KAAK,KAAK;;;;;;gDAEZ,KAAK,WAAW,kBACf,6LAAC;oDAAE,WAAU;8DACV,KAAK,WAAW;;;;;;;;;;;;;;;;;;gCAKxB,KAAK,WAAW,IAAI,KAAK,YAAY,kBACpC,6LAAC;oCAAI,WAAU;8CACb,cAAA,6LAAC;wCAAK,WAAU;;4CACb,KAAK,WAAW;4CAAC;;;;;;;;;;;;;;;;;;uBA7BrB,KAAK,EAAE;;;;;;;;;;;;;;;;AAuCxB;KAzEgB;uCA2ED"}},
    {"offset": {"line": 1668, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/work/rhythmologicum-connect/rhythmologicum-connect/apps/rhythm-patient-ui/app/patient/dashboard/components/ProgressSummary.tsx"],"sourcesContent":["'use client'\n\nimport { Card, Badge, Progress } from '@/lib/ui'\nimport type { FunnelSummary, WorkupSummary } from '@/lib/api/contracts/patient/dashboard'\n\nexport interface ProgressSummaryProps {\n  /** Array of funnel summaries from dashboard API */\n  funnelSummaries: FunnelSummary[]\n  /** Workup summary from dashboard API */\n  workupSummary: WorkupSummary\n  /** Callback when a funnel is clicked */\n  onFunnelClick?: (funnel: FunnelSummary) => void\n}\n\n/**\n * Progress Summary Component\n * \n * Displays patient's progress across funnels and workup status.\n * Part of E6.5.4 implementation.\n * \n * Features:\n * - Funnel progress visualization\n * - Workup status summary\n * - Empty state handling\n * - Responsive design\n * - Dark mode support\n * - Interactive funnel cards\n * \n * @example\n * <ProgressSummary\n *   funnelSummaries={[...]}\n *   workupSummary={{ state: 'no_data', counts: {...} }}\n *   onFunnelClick={handleFunnelClick}\n * />\n */\nexport function ProgressSummary({\n  funnelSummaries,\n  workupSummary,\n  onFunnelClick,\n}: ProgressSummaryProps) {\n  // Status badge mapping\n  const statusVariants = {\n    not_started: 'default' as const,\n    in_progress: 'warning' as const,\n    completed: 'success' as const,\n  }\n\n  const statusLabels = {\n    not_started: 'Nicht begonnen',\n    in_progress: 'In Bearbeitung',\n    completed: 'Abgeschlossen',\n  }\n\n  // Workup state mapping\n  const workupStateLabels = {\n    no_data: 'Keine Daten',\n    needs_more_data: 'Weitere Daten erforderlich',\n    ready_for_review: 'Bereit zur √úberpr√ºfung',\n  }\n\n  const workupStateColors = {\n    no_data: 'text-slate-600 dark:text-slate-400',\n    needs_more_data: 'text-amber-600 dark:text-amber-400',\n    ready_for_review: 'text-green-600 dark:text-green-400',\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Funnel Progress Section */}\n      <div className=\"space-y-3\">\n        <h3 className=\"text-lg font-semibold text-slate-900 dark:text-slate-100\">\n          Ihre Assessments\n        </h3>\n\n        {funnelSummaries.length === 0 ? (\n          <Card padding=\"lg\" radius=\"lg\">\n            <div className=\"text-center py-6\">\n              <div className=\"text-4xl mb-3\">üìã</div>\n              <h4 className=\"text-base font-medium text-slate-900 dark:text-slate-100 mb-2\">\n                Noch keine Assessments\n              </h4>\n              <p className=\"text-sm text-slate-600 dark:text-slate-400\">\n                Starten Sie Ihr erstes Assessment, um Ihren Fortschritt zu verfolgen.\n              </p>\n            </div>\n          </Card>\n        ) : (\n          <div className=\"space-y-3\">\n            {funnelSummaries.map((funnel) => (\n              <Card\n                key={funnel.slug}\n                padding=\"md\"\n                radius=\"lg\"\n                interactive={funnel.status === 'in_progress'}\n                onClick={() => {\n                  if (funnel.status === 'in_progress' && onFunnelClick) {\n                    onFunnelClick(funnel)\n                  }\n                }}\n              >\n                <div className=\"space-y-3\">\n                  <div className=\"flex items-start justify-between gap-3\">\n                    <div className=\"flex-1 min-w-0\">\n                      <h4 className=\"font-medium text-slate-900 dark:text-slate-100 mb-1\">\n                        {funnel.title}\n                      </h4>\n                      {funnel.description && (\n                        <p className=\"text-sm text-slate-600 dark:text-slate-400 line-clamp-2\">\n                          {funnel.description}\n                        </p>\n                      )}\n                    </div>\n                    <Badge variant={statusVariants[funnel.status]} size=\"sm\">\n                      {statusLabels[funnel.status]}\n                    </Badge>\n                  </div>\n\n                  {funnel.progress && (\n                    <div className=\"space-y-1\">\n                      <div className=\"flex justify-between text-xs text-slate-600 dark:text-slate-400\">\n                        <span>Fortschritt</span>\n                        <span>\n                          {funnel.progress.current} / {funnel.progress.total}\n                        </span>\n                      </div>\n                      <Progress\n                        value={(funnel.progress.current / funnel.progress.total) * 100}\n                        showPercentage={false}\n                        showStepText={false}\n                      />\n                    </div>\n                  )}\n\n                  {funnel.completedAt && (\n                    <p className=\"text-xs text-slate-500 dark:text-slate-500\">\n                      Abgeschlossen am {new Date(funnel.completedAt).toLocaleDateString('de-DE')}\n                    </p>\n                  )}\n                </div>\n              </Card>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Workup Status Section */}\n      <div className=\"space-y-3\">\n        <h3 className=\"text-lg font-semibold text-slate-900 dark:text-slate-100\">\n          Workup-Status\n        </h3>\n        <Card padding=\"md\" radius=\"lg\">\n          <div className=\"space-y-3\">\n            <div className=\"flex items-center justify-between\">\n              <span className=\"text-sm font-medium text-slate-700 dark:text-slate-300\">\n                Status:\n              </span>\n              <span className={`text-sm font-semibold ${workupStateColors[workupSummary.state]}`}>\n                {workupStateLabels[workupSummary.state]}\n              </span>\n            </div>\n\n            <div className=\"grid grid-cols-3 gap-4 pt-3 border-t border-slate-200 dark:border-slate-700\">\n              <div className=\"text-center\">\n                <div className=\"text-2xl font-bold text-slate-900 dark:text-slate-100\">\n                  {workupSummary.counts.total}\n                </div>\n                <div className=\"text-xs text-slate-600 dark:text-slate-400 mt-1\">Gesamt</div>\n              </div>\n              <div className=\"text-center\">\n                <div className=\"text-2xl font-bold text-amber-600 dark:text-amber-400\">\n                  {workupSummary.counts.needsMoreData}\n                </div>\n                <div className=\"text-xs text-slate-600 dark:text-slate-400 mt-1\">\n                  Weitere Daten\n                </div>\n              </div>\n              <div className=\"text-center\">\n                <div className=\"text-2xl font-bold text-green-600 dark:text-green-400\">\n                  {workupSummary.counts.readyForReview}\n                </div>\n                <div className=\"text-xs text-slate-600 dark:text-slate-400 mt-1\">\n                  Bereit\n                </div>\n              </div>\n            </div>\n          </div>\n        </Card>\n      </div>\n    </div>\n  )\n}\n\nexport default ProgressSummary\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 2055, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/work/rhythmologicum-connect/rhythmologicum-connect/apps/rhythm-patient-ui/app/patient/dashboard/components/index.ts"],"sourcesContent":["/**\n * Dashboard Components\n * \n * E6.5.4 Patient Dashboard Layout Components\n * \n * This module exports all dashboard section components used\n * to build the patient dashboard UI.\n */\n\nexport { DashboardHeader } from './DashboardHeader'\nexport type { DashboardHeaderProps } from './DashboardHeader'\n\nexport { AMYSlot } from './AMYSlot'\nexport { AMYComposer } from './AMYComposer'\n\nexport { NextStepCard } from './NextStepCard'\nexport type { NextStepCardProps } from './NextStepCard'\n\nexport { ContentTilesGrid } from './ContentTilesGrid'\nexport type { ContentTilesGridProps } from './ContentTilesGrid'\n\nexport { ProgressSummary } from './ProgressSummary'\nexport type { ProgressSummaryProps } from './ProgressSummary'\n"],"names":[],"mappings":";AAAA;;;;;;;CAOC,GAED;AAGA;AACA;AAEA;AAGA;AAGA"}},
    {"offset": {"line": 2082, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/work/rhythmologicum-connect/rhythmologicum-connect/lib/hooks/useDashboardData.ts"],"sourcesContent":["/**\n * useDashboardData Hook - E6.5.9\n *\n * Manages dashboard data fetching with:\n * - Stale-while-revalidate pattern\n * - Error handling with retry\n * - Refresh on demand\n *\n * E6.5.9 AC1: Dashboard reflects new status without hard reload\n * E6.5.9 AC2: Offline/failed fetch shows error state + retry (not blank)\n */\n\nimport { useState, useCallback, useRef, useEffect } from 'react'\nimport type { DashboardViewModelV1 } from '@/lib/api/contracts/patient/dashboard'\n\ntype FetchState = 'idle' | 'loading' | 'revalidating' | 'error'\n\ninterface UseDashboardDataResult {\n  data: DashboardViewModelV1 | null\n  state: FetchState\n  error: string | null\n  isStale: boolean\n  refresh: () => Promise<void>\n  retry: () => Promise<void>\n}\n\nconst DASHBOARD_API_ENDPOINT = '/api/patient/dashboard'\n\n/**\n * Hook for managing dashboard data with stale-while-revalidate strategy\n *\n * @param autoFetch - Whether to automatically fetch on mount (default: true)\n * @returns Dashboard data state and control functions\n *\n * @example\n * ```tsx\n * const { data, state, error, refresh, retry } = useDashboardData()\n *\n * if (state === 'loading') return <LoadingSpinner />\n * if (error) return <ErrorState onRetry={retry} />\n * return <DashboardContent data={data} />\n * ```\n */\nexport function useDashboardData(autoFetch: boolean = true): UseDashboardDataResult {\n  const [data, setData] = useState<DashboardViewModelV1 | null>(null)\n  const [state, setState] = useState<FetchState>('idle')\n  const [error, setError] = useState<string | null>(null)\n  const [isStale, setIsStale] = useState(false)\n\n  // Track if a fetch is in progress to prevent race conditions\n  const fetchInProgressRef = useRef(false)\n  const abortControllerRef = useRef<AbortController | null>(null)\n\n  const fetchDashboard = useCallback(\n    async (options: { isRevalidation?: boolean } = {}) => {\n      // Prevent concurrent fetches\n      if (fetchInProgressRef.current) {\n        return\n      }\n\n      // Cancel any pending request\n      if (abortControllerRef.current) {\n        abortControllerRef.current.abort()\n      }\n\n      fetchInProgressRef.current = true\n      const abortController = new AbortController()\n      abortControllerRef.current = abortController\n\n      try {\n        // If we have stale data, mark as revalidating; otherwise loading\n        if (options.isRevalidation && data) {\n          setState('revalidating')\n          setIsStale(true)\n        } else {\n          setState('loading')\n        }\n\n        setError(null)\n\n        const response = await fetch(DASHBOARD_API_ENDPOINT, {\n          credentials: 'include',\n          signal: abortController.signal,\n        })\n\n        if (!response.ok) {\n          throw new Error('Failed to load dashboard data')\n        }\n\n        const result = await response.json()\n\n        if (!result.success) {\n          throw new Error(result.error?.message || 'Failed to load dashboard')\n        }\n\n        // Update data and clear stale flag\n        setData(result.data)\n        setState('idle')\n        setIsStale(false)\n        setError(null)\n      } catch (err) {\n        // Don't set error state if request was aborted (component unmounted or new request started)\n        if (err instanceof Error && err.name === 'AbortError') {\n          return\n        }\n\n        console.error('[useDashboardData] Error loading data:', err)\n\n        // Only clear data if we don't have stale data to show\n        if (!data || !options.isRevalidation) {\n          setData(null)\n        }\n\n        setState('error')\n        setError(\n          err instanceof Error ? err.message : 'Dashboard konnte nicht geladen werden.',\n        )\n      } finally {\n        fetchInProgressRef.current = false\n        abortControllerRef.current = null\n      }\n    },\n    [data],\n  )\n\n  // Auto-fetch on mount if enabled\n  useEffect(() => {\n    if (autoFetch && state === 'idle' && !data) {\n      fetchDashboard()\n    }\n  }, [autoFetch, state, data, fetchDashboard])\n\n  // Cleanup on unmount\n  useEffect(() => {\n    return () => {\n      if (abortControllerRef.current) {\n        abortControllerRef.current.abort()\n      }\n    }\n  }, [])\n\n  /**\n   * Refresh dashboard data\n   * Uses stale-while-revalidate: shows old data while fetching new\n   */\n  const refresh = useCallback(async () => {\n    await fetchDashboard({ isRevalidation: true })\n  }, [fetchDashboard])\n\n  /**\n   * Retry after error\n   * Clears error state and attempts fresh fetch\n   */\n  const retry = useCallback(async () => {\n    await fetchDashboard({ isRevalidation: false })\n  }, [fetchDashboard])\n\n  return {\n    data,\n    state,\n    error,\n    isStale,\n    refresh,\n    retry,\n  }\n}\n"],"names":[],"mappings":";;;;AAAA;;;;;;;;;;CAUC,GAED;;;AAcA,MAAM,yBAAyB;AAiBxB,SAAS,iBAAiB,YAAqB,IAAI;;IACxD,MAAM,CAAC,MAAM,QAAQ,GAAG,IAAA,yKAAQ,EAA8B;IAC9D,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAa;IAC/C,MAAM,CAAC,OAAO,SAAS,GAAG,IAAA,yKAAQ,EAAgB;IAClD,MAAM,CAAC,SAAS,WAAW,GAAG,IAAA,yKAAQ,EAAC;IAEvC,6DAA6D;IAC7D,MAAM,qBAAqB,IAAA,uKAAM,EAAC;IAClC,MAAM,qBAAqB,IAAA,uKAAM,EAAyB;IAE1D,MAAM,iBAAiB,IAAA,4KAAW;wDAChC,OAAO,UAAwC,CAAC,CAAC;YAC/C,6BAA6B;YAC7B,IAAI,mBAAmB,OAAO,EAAE;gBAC9B;YACF;YAEA,6BAA6B;YAC7B,IAAI,mBAAmB,OAAO,EAAE;gBAC9B,mBAAmB,OAAO,CAAC,KAAK;YAClC;YAEA,mBAAmB,OAAO,GAAG;YAC7B,MAAM,kBAAkB,IAAI;YAC5B,mBAAmB,OAAO,GAAG;YAE7B,IAAI;gBACF,iEAAiE;gBACjE,IAAI,QAAQ,cAAc,IAAI,MAAM;oBAClC,SAAS;oBACT,WAAW;gBACb,OAAO;oBACL,SAAS;gBACX;gBAEA,SAAS;gBAET,MAAM,WAAW,MAAM,MAAM,wBAAwB;oBACnD,aAAa;oBACb,QAAQ,gBAAgB,MAAM;gBAChC;gBAEA,IAAI,CAAC,SAAS,EAAE,EAAE;oBAChB,MAAM,IAAI,MAAM;gBAClB;gBAEA,MAAM,SAAS,MAAM,SAAS,IAAI;gBAElC,IAAI,CAAC,OAAO,OAAO,EAAE;oBACnB,MAAM,IAAI,MAAM,OAAO,KAAK,EAAE,WAAW;gBAC3C;gBAEA,mCAAmC;gBACnC,QAAQ,OAAO,IAAI;gBACnB,SAAS;gBACT,WAAW;gBACX,SAAS;YACX,EAAE,OAAO,KAAK;gBACZ,4FAA4F;gBAC5F,IAAI,eAAe,SAAS,IAAI,IAAI,KAAK,cAAc;oBACrD;gBACF;gBAEA,QAAQ,KAAK,CAAC,0CAA0C;gBAExD,sDAAsD;gBACtD,IAAI,CAAC,QAAQ,CAAC,QAAQ,cAAc,EAAE;oBACpC,QAAQ;gBACV;gBAEA,SAAS;gBACT,SACE,eAAe,QAAQ,IAAI,OAAO,GAAG;YAEzC,SAAU;gBACR,mBAAmB,OAAO,GAAG;gBAC7B,mBAAmB,OAAO,GAAG;YAC/B;QACF;uDACA;QAAC;KAAK;IAGR,iCAAiC;IACjC,IAAA,0KAAS;sCAAC;YACR,IAAI,aAAa,UAAU,UAAU,CAAC,MAAM;gBAC1C;YACF;QACF;qCAAG;QAAC;QAAW;QAAO;QAAM;KAAe;IAE3C,qBAAqB;IACrB,IAAA,0KAAS;sCAAC;YACR;8CAAO;oBACL,IAAI,mBAAmB,OAAO,EAAE;wBAC9B,mBAAmB,OAAO,CAAC,KAAK;oBAClC;gBACF;;QACF;qCAAG,EAAE;IAEL;;;GAGC,GACD,MAAM,UAAU,IAAA,4KAAW;iDAAC;YAC1B,MAAM,eAAe;gBAAE,gBAAgB;YAAK;QAC9C;gDAAG;QAAC;KAAe;IAEnB;;;GAGC,GACD,MAAM,QAAQ,IAAA,4KAAW;+CAAC;YACxB,MAAM,eAAe;gBAAE,gBAAgB;YAAM;QAC/C;8CAAG;QAAC;KAAe;IAEnB,OAAO;QACL;QACA;QACA;QACA;QACA;QACA;IACF;AACF;GA1HgB"}},
    {"offset": {"line": 2233, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/work/rhythmologicum-connect/rhythmologicum-connect/lib/hooks/useAppFocus.ts"],"sourcesContent":["/**\n * useAppFocus Hook - E6.5.9\n *\n * Detects when the app/browser tab comes into focus.\n * Useful for triggering data refreshes when user returns to the app.\n *\n * Mobile-friendly: Handles both visibilitychange and focus events\n * for maximum compatibility across devices.\n */\n\nimport { useEffect, useRef } from 'react'\n\ntype AppFocusCallback = () => void\n\n/**\n * Hook that calls a callback when the app comes into focus\n *\n * @param onFocus - Callback to execute when app gains focus\n * @param enabled - Whether the hook is active (default: true)\n *\n * @example\n * ```tsx\n * useAppFocus(() => {\n *   console.log('App is now in focus, refreshing data...')\n *   refetchData()\n * })\n * ```\n */\nexport function useAppFocus(onFocus: AppFocusCallback, enabled: boolean = true) {\n  const callbackRef = useRef(onFocus)\n\n  // Keep callback ref up to date\n  useEffect(() => {\n    callbackRef.current = onFocus\n  }, [onFocus])\n\n  useEffect(() => {\n    if (!enabled) return\n\n    // Track if we're currently visible to avoid duplicate calls\n    let wasVisible = !document.hidden\n\n    const handleVisibilityChange = () => {\n      const isVisible = !document.hidden\n\n      // Only call callback when transitioning from hidden to visible\n      if (!wasVisible && isVisible) {\n        callbackRef.current()\n      }\n\n      wasVisible = isVisible\n    }\n\n    const handleFocus = () => {\n      // Only call if document is visible (prevents duplicate calls)\n      if (!document.hidden) {\n        callbackRef.current()\n      }\n    }\n\n    // Listen for visibility changes (mobile-friendly)\n    document.addEventListener('visibilitychange', handleVisibilityChange)\n\n    // Listen for window focus events (desktop)\n    window.addEventListener('focus', handleFocus)\n\n    return () => {\n      document.removeEventListener('visibilitychange', handleVisibilityChange)\n      window.removeEventListener('focus', handleFocus)\n    }\n  }, [enabled])\n}\n"],"names":[],"mappings":";;;;AAAA;;;;;;;;CAQC,GAED;;;AAkBO,SAAS,YAAY,OAAyB,EAAE,UAAmB,IAAI;;IAC5E,MAAM,cAAc,IAAA,uKAAM,EAAC;IAE3B,+BAA+B;IAC/B,IAAA,0KAAS;iCAAC;YACR,YAAY,OAAO,GAAG;QACxB;gCAAG;QAAC;KAAQ;IAEZ,IAAA,0KAAS;iCAAC;YACR,IAAI,CAAC,SAAS;YAEd,4DAA4D;YAC5D,IAAI,aAAa,CAAC,SAAS,MAAM;YAEjC,MAAM;gEAAyB;oBAC7B,MAAM,YAAY,CAAC,SAAS,MAAM;oBAElC,+DAA+D;oBAC/D,IAAI,CAAC,cAAc,WAAW;wBAC5B,YAAY,OAAO;oBACrB;oBAEA,aAAa;gBACf;;YAEA,MAAM;qDAAc;oBAClB,8DAA8D;oBAC9D,IAAI,CAAC,SAAS,MAAM,EAAE;wBACpB,YAAY,OAAO;oBACrB;gBACF;;YAEA,kDAAkD;YAClD,SAAS,gBAAgB,CAAC,oBAAoB;YAE9C,2CAA2C;YAC3C,OAAO,gBAAgB,CAAC,SAAS;YAEjC;yCAAO;oBACL,SAAS,mBAAmB,CAAC,oBAAoB;oBACjD,OAAO,mBAAmB,CAAC,SAAS;gBACtC;;QACF;gCAAG;QAAC;KAAQ;AACd;GA3CgB"}},
    {"offset": {"line": 2305, "column": 0}, "map": {"version":3,"sources":["file:///home/runner/work/rhythmologicum-connect/rhythmologicum-connect/apps/rhythm-patient-ui/app/patient/dashboard/client.tsx"],"sourcesContent":["'use client'\n\nimport { useEffect } from 'react'\nimport { useRouter, useSearchParams } from 'next/navigation'\nimport MobileHeader from '@/app/components/MobileHeader'\nimport { LoadingSpinner, ErrorState } from '@/lib/ui'\nimport {\n  DashboardHeader,\n  AMYComposer,\n  NextStepCard,\n  ContentTilesGrid,\n  ProgressSummary,\n} from './components'\nimport { useDashboardData } from '@/lib/hooks/useDashboardData'\nimport { useAppFocus } from '@/lib/hooks/useAppFocus'\n\n/**\n * Patient Dashboard Client Component (E6.5.4 + E6.5.9)\n * \n * Enhanced dashboard layout with sections:\n * - Header with greeting (AC: empty states)\n * - AMY slot (placeholder for E6.6)\n * - Next Step card (AC3: always visible when available)\n * - Content tiles grid\n * - Progress summary (funnels/workup)\n * \n * E6.5.4 Acceptance Criteria:\n * - AC1: Empty states render gracefully (no crashes)\n * - AC2: Mobile responsive (shell)\n * - AC3: NextStep CTA always visible when available\n * \n * E6.5.9 Acceptance Criteria:\n * - AC1: After completing funnel, dashboard reflects new status without hard reload\n * - AC2: Offline/failed fetch shows error state + retry (not blank)\n * \n * Refresh Strategy:\n * - Auto-refresh on app focus (mobile-friendly)\n * - Refresh after funnel completion (via ?refresh=funnel)\n * - Refresh after follow-up answered (via ?refresh=followup)\n * - Stale-while-revalidate pattern (shows old data while fetching new)\n */\nexport default function DashboardClient() {\n  const router = useRouter()\n  const searchParams = useSearchParams()\n  \n  // E6.5.9: Use dashboard data hook with stale-while-revalidate\n  const { data: dashboardData, state, error, isStale, refresh, retry } = useDashboardData()\n\n  // E6.5.9: Auto-refresh on app focus (mobile-friendly)\n  useAppFocus(() => {\n    refresh()\n  })\n\n  // E6.5.9: Refresh when returning from funnel completion or follow-up\n  // E6.6.5: Handle scroll-to-content from triage router\n  useEffect(() => {\n    const refreshTrigger = searchParams.get('refresh')\n    const scrollTo = searchParams.get('scrollTo')\n    const action = searchParams.get('action')\n    \n    if (refreshTrigger === 'funnel' || refreshTrigger === 'followup') {\n      // Clear the query param to avoid repeated refreshes\n      const newUrl = new URL(window.location.href)\n      newUrl.searchParams.delete('refresh')\n      router.replace(newUrl.pathname + newUrl.search, { scroll: false })\n      \n      // Trigger refresh\n      refresh()\n    }\n\n    // E6.6.5: Handle scroll-to-content from triage SHOW_CONTENT action\n    if (scrollTo === 'content') {\n      // Scroll to content tiles after a short delay to allow render\n      setTimeout(() => {\n        const contentElement = document.getElementById('content-tiles')\n        if (contentElement) {\n          contentElement.scrollIntoView({ behavior: 'smooth', block: 'start' })\n        }\n      }, 300)\n\n      // Clear the query param\n      const newUrl = new URL(window.location.href)\n      newUrl.searchParams.delete('scrollTo')\n      router.replace(newUrl.pathname + newUrl.search, { scroll: false })\n    }\n\n    // E6.6.5: Handle resume action from triage RESUME_FUNNEL\n    if (action === 'resume' && dashboardData?.nextStep?.target) {\n      // Auto-navigate to resume target\n      setTimeout(() => {\n        router.push(dashboardData.nextStep.target!)\n      }, 500)\n\n      // Clear the query param\n      const newUrl = new URL(window.location.href)\n      newUrl.searchParams.delete('action')\n      router.replace(newUrl.pathname + newUrl.search, { scroll: false })\n    }\n  }, [searchParams, router, refresh, dashboardData])\n\n  const handleNextStepAction = () => {\n    if (dashboardData?.nextStep?.target) {\n      router.push(dashboardData.nextStep.target)\n    }\n  }\n\n  const handleFunnelClick = (funnel: any) => {\n    router.push(`/patient/funnel/${funnel.slug}`)\n  }\n\n  const handleTileClick = (tile: any) => {\n    if (tile.actionTarget) {\n      router.push(tile.actionTarget)\n    }\n  }\n\n\n  return (\n    <div className=\"min-h-screen flex flex-col bg-gradient-to-b from-sky-50 via-slate-50 to-slate-100 dark:from-slate-800 dark:via-slate-900 dark:to-slate-950 transition-colors duration-150\">\n      <MobileHeader\n        variant=\"with-title\"\n        title=\"Dashboard\"\n        subtitle=\"Rhythmologicum Connect\"\n        showBack={false}\n      />\n\n      <main\n        className=\"flex-1 overflow-y-auto px-4 pt-4 sm:pt-6\"\n        style={{ paddingBottom: 'calc(6rem + env(safe-area-inset-bottom))' }}\n      >\n        <div className=\"w-full max-w-4xl mx-auto space-y-6\">\n          {/* E6.5.9: Loading state - show spinner only on initial load */}\n          {state === 'loading' && !dashboardData && (\n            <div className=\"py-12\">\n              <LoadingSpinner size=\"lg\" text=\"Dashboard wird geladen...\" centered />\n            </div>\n          )}\n\n          {/* E6.5.9: Revalidating state - show subtle indicator while keeping content visible */}\n          {state === 'revalidating' && isStale && dashboardData && (\n            <div className=\"bg-sky-50 border border-sky-200 rounded-lg px-4 py-2 text-sm text-sky-700\">\n              <div className=\"flex items-center gap-2\">\n                <div className=\"animate-spin h-4 w-4 border-2 border-sky-600 border-t-transparent rounded-full\" />\n                <span>Aktualisiere Dashboard...</span>\n              </div>\n            </div>\n          )}\n\n          {/* E6.5.9 AC2: Error state with retry - not a blank screen */}\n          {error && (\n            <ErrorState\n              title=\"Fehler beim Laden\"\n              message={error}\n              onRetry={retry}\n              centered={!dashboardData}\n            />\n          )}\n\n          {/* E6.5.4 AC1: Dashboard content with empty states */}\n          {/* E6.5.9: Show stale data during revalidation (stale-while-revalidate) */}\n          {dashboardData && (\n            <>\n              {/* Header Section */}\n              <DashboardHeader />\n\n              {/* E6.6.1: AMY Composer - Guided Mode for bounded input */}\n              <AMYComposer />\n\n              {/* E6.5.4 AC3: Next Step Card - Always visible when available */}\n              {dashboardData.nextStep && (\n                <NextStepCard\n                  nextStep={dashboardData.nextStep}\n                  onAction={handleNextStepAction}\n                />\n              )}\n\n              {/* Content Tiles Grid - E6.6.5: Add id for scroll-to navigation */}\n              <div id=\"content-tiles\">\n                <ContentTilesGrid\n                  tiles={dashboardData.contentTiles}\n                  onTileClick={handleTileClick}\n                />\n              </div>\n\n              {/* Progress Summary */}\n              <ProgressSummary\n                funnelSummaries={dashboardData.funnelSummaries}\n                workupSummary={dashboardData.workupSummary}\n                onFunnelClick={handleFunnelClick}\n              />\n            </>\n          )}\n        </div>\n      </main>\n    </div>\n  )\n}\n"],"names":[],"mappings":";;;;;AAEA;AACA;AACA;AACA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;AACA;;;AAdA;;;;;;;;AAyCe,SAAS;;IACtB,MAAM,SAAS,IAAA,kJAAS;IACxB,MAAM,eAAe,IAAA,wJAAe;IAEpC,8DAA8D;IAC9D,MAAM,EAAE,MAAM,aAAa,EAAE,KAAK,EAAE,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE,KAAK,EAAE,GAAG,IAAA,uJAAgB;IAEvF,sDAAsD;IACtD,IAAA,6IAAW;uCAAC;YACV;QACF;;IAEA,qEAAqE;IACrE,sDAAsD;IACtD,IAAA,0KAAS;qCAAC;YACR,MAAM,iBAAiB,aAAa,GAAG,CAAC;YACxC,MAAM,WAAW,aAAa,GAAG,CAAC;YAClC,MAAM,SAAS,aAAa,GAAG,CAAC;YAEhC,IAAI,mBAAmB,YAAY,mBAAmB,YAAY;gBAChE,oDAAoD;gBACpD,MAAM,SAAS,IAAI,IAAI,OAAO,QAAQ,CAAC,IAAI;gBAC3C,OAAO,YAAY,CAAC,MAAM,CAAC;gBAC3B,OAAO,OAAO,CAAC,OAAO,QAAQ,GAAG,OAAO,MAAM,EAAE;oBAAE,QAAQ;gBAAM;gBAEhE,kBAAkB;gBAClB;YACF;YAEA,mEAAmE;YACnE,IAAI,aAAa,WAAW;gBAC1B,8DAA8D;gBAC9D;iDAAW;wBACT,MAAM,iBAAiB,SAAS,cAAc,CAAC;wBAC/C,IAAI,gBAAgB;4BAClB,eAAe,cAAc,CAAC;gCAAE,UAAU;gCAAU,OAAO;4BAAQ;wBACrE;oBACF;gDAAG;gBAEH,wBAAwB;gBACxB,MAAM,SAAS,IAAI,IAAI,OAAO,QAAQ,CAAC,IAAI;gBAC3C,OAAO,YAAY,CAAC,MAAM,CAAC;gBAC3B,OAAO,OAAO,CAAC,OAAO,QAAQ,GAAG,OAAO,MAAM,EAAE;oBAAE,QAAQ;gBAAM;YAClE;YAEA,yDAAyD;YACzD,IAAI,WAAW,YAAY,eAAe,UAAU,QAAQ;gBAC1D,iCAAiC;gBACjC;iDAAW;wBACT,OAAO,IAAI,CAAC,cAAc,QAAQ,CAAC,MAAM;oBAC3C;gDAAG;gBAEH,wBAAwB;gBACxB,MAAM,SAAS,IAAI,IAAI,OAAO,QAAQ,CAAC,IAAI;gBAC3C,OAAO,YAAY,CAAC,MAAM,CAAC;gBAC3B,OAAO,OAAO,CAAC,OAAO,QAAQ,GAAG,OAAO,MAAM,EAAE;oBAAE,QAAQ;gBAAM;YAClE;QACF;oCAAG;QAAC;QAAc;QAAQ;QAAS;KAAc;IAEjD,MAAM,uBAAuB;QAC3B,IAAI,eAAe,UAAU,QAAQ;YACnC,OAAO,IAAI,CAAC,cAAc,QAAQ,CAAC,MAAM;QAC3C;IACF;IAEA,MAAM,oBAAoB,CAAC;QACzB,OAAO,IAAI,CAAC,CAAC,gBAAgB,EAAE,OAAO,IAAI,EAAE;IAC9C;IAEA,MAAM,kBAAkB,CAAC;QACvB,IAAI,KAAK,YAAY,EAAE;YACrB,OAAO,IAAI,CAAC,KAAK,YAAY;QAC/B;IACF;IAGA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC,gJAAY;gBACX,SAAQ;gBACR,OAAM;gBACN,UAAS;gBACT,UAAU;;;;;;0BAGZ,6LAAC;gBACC,WAAU;gBACV,OAAO;oBAAE,eAAe;gBAA2C;0BAEnE,cAAA,6LAAC;oBAAI,WAAU;;wBAEZ,UAAU,aAAa,CAAC,+BACvB,6LAAC;4BAAI,WAAU;sCACb,cAAA,6LAAC,iJAAc;gCAAC,MAAK;gCAAK,MAAK;gCAA4B,QAAQ;;;;;;;;;;;wBAKtE,UAAU,kBAAkB,WAAW,+BACtC,6LAAC;4BAAI,WAAU;sCACb,cAAA,6LAAC;gCAAI,WAAU;;kDACb,6LAAC;wCAAI,WAAU;;;;;;kDACf,6LAAC;kDAAK;;;;;;;;;;;;;;;;;wBAMX,uBACC,6LAAC,yIAAU;4BACT,OAAM;4BACN,SAAS;4BACT,SAAS;4BACT,UAAU,CAAC;;;;;;wBAMd,+BACC;;8CAEE,6LAAC,sNAAe;;;;;8CAGhB,6LAAC,8MAAW;;;;;gCAGX,cAAc,QAAQ,kBACrB,6LAAC,gNAAY;oCACX,UAAU,cAAc,QAAQ;oCAChC,UAAU;;;;;;8CAKd,6LAAC;oCAAI,IAAG;8CACN,cAAA,6LAAC,wNAAgB;wCACf,OAAO,cAAc,YAAY;wCACjC,aAAa;;;;;;;;;;;8CAKjB,6LAAC,sNAAe;oCACd,iBAAiB,cAAc,eAAe;oCAC9C,eAAe,cAAc,aAAa;oCAC1C,eAAe;;;;;;;;;;;;;;;;;;;;;;;;;AAQ/B;GA3JwB;;QACP,kJAAS;QACH,wJAAe;QAGmC,uJAAgB;QAGvF,6IAAW;;;KARW"}}]
}