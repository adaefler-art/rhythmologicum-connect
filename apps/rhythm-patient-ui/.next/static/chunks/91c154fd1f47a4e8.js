(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,8707,e=>{"use strict";var t=e.i(18050),s=e.i(71645),r=e.i(18566),l=e.i(48005),a=e.i(18937);e.i(47446);var n=e.i(84584),i=e.i(52220),d=e.i(85e3),o=e.i(65711),c=e.i(12911);e.i(180);var x=e.i(53012);function m({score:e,maxScore:s=100,level:r="medium",label:l="Stresslevel",description:a="Ihre aktuelle Bewertung"}){let n=(()=>{switch(r){case"low":return{bg:"bg-green-50",border:"border-green-200",text:"text-green-900",icon:"âœ“",iconBg:"bg-green-100",badge:"bg-green-100 text-green-800"};case"high":return{bg:"bg-red-50",border:"border-red-200",text:"text-red-900",icon:"âš ",iconBg:"bg-red-100",badge:"bg-red-100 text-red-800"};default:return{bg:"bg-amber-50",border:"border-amber-200",text:"text-amber-900",icon:"â—†",iconBg:"bg-amber-100",badge:"bg-amber-100 text-amber-800"}}})(),i=void 0!==e?Math.round(e/s*100):0;return(0,t.jsx)(c.Card,{padding:"lg",radius:"2xl",shadow:"lg",border:!0,className:`${n.bg} ${n.border} border-2`,children:(0,t.jsxs)("div",{className:"flex items-start gap-4",children:[(0,t.jsx)("div",{className:`flex-shrink-0 w-14 h-14 sm:w-16 sm:h-16 ${n.iconBg} rounded-full flex items-center justify-center`,children:(0,t.jsx)("span",{className:"text-2xl sm:text-3xl",children:n.icon})}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("p",{className:"text-sm sm:text-base text-slate-600 mb-1",children:a}),(0,t.jsx)("h3",{className:`text-2xl sm:text-3xl md:text-4xl font-bold ${n.text} mb-2`,style:{lineHeight:x.typography.lineHeight.tight},children:void 0!==e?`${e}/${s}`:"â€”"}),(0,t.jsxs)("div",{className:"flex items-center gap-2 flex-wrap",children:[(0,t.jsx)("span",{className:`inline-block px-3 py-1 rounded-full text-xs sm:text-sm font-semibold ${n.badge}`,children:l}),i>0&&(0,t.jsxs)("span",{className:"text-xs sm:text-sm text-slate-600",children:[i,"%"]})]})]})]})})}function h({segments:e=[],title:s="Stressverteilung",description:r="Ãœbersicht Ihrer Stressbereiche"}){let l=e.reduce((e,t)=>e+t.value,0),a=e.length>0?e:[{label:"KÃ¶rperlich",value:30,color:"bg-red-500"},{label:"Emotional",value:45,color:"bg-amber-500"},{label:"Kognitiv",value:25,color:"bg-primary-500"}];return(0,t.jsxs)(c.Card,{padding:"lg",radius:"xl",shadow:"md",border:!0,className:"bg-white",children:[(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsx)("h3",{className:"text-lg sm:text-xl font-bold text-slate-900 mb-1",style:{lineHeight:x.typography.lineHeight.tight},children:s}),(0,t.jsx)("p",{className:"text-sm sm:text-base text-slate-600",children:r})]}),(0,t.jsx)("div",{className:"mb-4",children:(0,t.jsx)("div",{className:"h-3 sm:h-4 bg-slate-200 rounded-full overflow-hidden flex",children:a.map((e,s)=>{let r=l>0?e.value/l*100:0;return(0,t.jsx)("div",{className:`${e.color} transition-all duration-300`,style:{width:`${r}%`},title:`${e.label}: ${Math.round(r)}%`},s)})})}),(0,t.jsx)("div",{className:"flex flex-wrap gap-3",children:a.map((e,s)=>{let r=l>0?Math.round(e.value/l*100):0;return(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:`w-3 h-3 sm:w-4 sm:h-4 ${e.color} rounded-sm`}),(0,t.jsxs)("span",{className:"text-xs sm:text-sm text-slate-700",children:[e.label,(0,t.jsxs)("span",{className:"text-slate-500 ml-1",children:["(",r,"%)"]})]})]},s)})}),0===e.length&&(0,t.jsx)("div",{className:"mt-4 p-3 bg-slate-50 border border-slate-200 rounded-lg",children:(0,t.jsx)("p",{className:"text-xs sm:text-sm text-slate-600 italic",children:"ðŸ’¡ Diese Visualisierung wird basierend auf Ihren konkreten Antworten erstellt, sobald die detaillierte Auswertung verfÃ¼gbar ist."})})]})}function u({actions:e,title:s="NÃ¤chste Schritte",description:r="Was kÃ¶nnen Sie jetzt tun?"}){return 0===e.length?null:(0,t.jsxs)(c.Card,{padding:"lg",radius:"xl",shadow:"md",border:!0,className:"bg-gradient-to-br from-sky-50 to-blue-50 dark:from-sky-900/20 dark:to-blue-900/20 border-sky-200 dark:border-sky-800",children:[(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)("span",{className:"text-2xl",children:"ðŸŽ¯"}),(0,t.jsx)("h3",{className:"text-lg sm:text-xl font-bold text-slate-900 dark:text-slate-100",style:{lineHeight:x.typography.lineHeight.tight},children:s})]}),(0,t.jsx)("p",{className:"text-sm sm:text-base text-slate-700 dark:text-slate-300",children:r})]}),(0,t.jsx)("div",{className:"space-y-3",children:e.map((e,s)=>(0,t.jsx)("div",{className:"bg-white dark:bg-slate-800 border border-sky-200 dark:border-sky-800 rounded-lg p-4 hover:shadow-md transition-shadow",children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("div",{className:"flex-shrink-0 w-8 h-8 bg-sky-100 dark:bg-sky-900/40 text-sky-700 dark:text-sky-400 rounded-full flex items-center justify-center font-bold text-sm",children:e.icon||`${s+1}`}),(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("h4",{className:"text-base sm:text-lg font-semibold text-slate-900 dark:text-slate-100 mb-1",style:{lineHeight:x.typography.lineHeight.tight},children:e.title}),(0,t.jsx)("p",{className:"text-sm sm:text-base text-slate-700 dark:text-slate-300 mb-2",style:{lineHeight:x.typography.lineHeight.relaxed},children:e.description}),(e.actionLabel||e.actionUrl||e.onClick)&&(0,t.jsx)("div",{children:e.actionUrl?(0,t.jsxs)("a",{href:e.actionUrl,target:"_blank",rel:"noopener noreferrer",className:"inline-block text-sm sm:text-base font-medium text-sky-700 dark:text-sky-400 hover:text-sky-900 dark:hover:text-sky-300 hover:underline",children:[e.actionLabel||"Mehr erfahren"," â†’"]}):e.onClick?(0,t.jsxs)("button",{onClick:e.onClick,className:"text-sm sm:text-base font-medium text-sky-700 dark:text-sky-400 hover:text-sky-900 dark:hover:text-sky-300 hover:underline",children:[e.actionLabel||"Mehr erfahren"," â†’"]}):null})]})]})},s))})]})}var g=e.i(18789),b=e.i(60508);function p({text:e,title:s="Ihre persÃ¶nliche Auswertung",icon:r="ðŸ¤–"}){return e&&""!==e.trim()?(0,t.jsxs)(c.Card,{padding:"lg",radius:"xl",shadow:"md",border:!0,className:"bg-white",children:[(0,t.jsxs)("div",{className:"mb-4 pb-4 border-b border-slate-200",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-2xl",children:r}),(0,t.jsx)("h3",{className:"text-lg sm:text-xl font-bold text-slate-900",style:{lineHeight:x.typography.lineHeight.tight},children:s})]}),(0,t.jsx)("p",{className:"text-xs sm:text-sm text-slate-500 mt-1",children:"Erstellt von AMY, Ihrer digitalen Gesundheitsassistentin"})]}),(0,t.jsx)("div",{className:"amy-text-content prose prose-slate max-w-none",style:{fontSize:x.typography.fontSize.base,lineHeight:x.typography.lineHeight.relaxed},children:(0,t.jsx)(g.default,{remarkPlugins:[b.default],components:{h1:({children:e})=>(0,t.jsx)("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-900 mb-3",style:{lineHeight:x.typography.lineHeight.tight},children:e}),h2:({children:e})=>(0,t.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-slate-900 mb-3 mt-6",style:{lineHeight:x.typography.lineHeight.tight},children:e}),h3:({children:e})=>(0,t.jsx)("h3",{className:"text-lg sm:text-xl font-semibold text-slate-900 mb-2 mt-4",style:{lineHeight:x.typography.lineHeight.tight},children:e}),p:({children:e})=>(0,t.jsx)("p",{className:"text-sm sm:text-base text-slate-700 mb-4",style:{lineHeight:x.typography.lineHeight.relaxed},children:e}),ul:({children:e})=>(0,t.jsx)("ul",{className:"list-disc list-inside space-y-2 mb-4 text-sm sm:text-base text-slate-700",children:e}),ol:({children:e})=>(0,t.jsx)("ol",{className:"list-decimal list-inside space-y-2 mb-4 text-sm sm:text-base text-slate-700",children:e}),li:({children:e})=>(0,t.jsx)("li",{style:{lineHeight:x.typography.lineHeight.relaxed},children:e}),strong:({children:e})=>(0,t.jsx)("strong",{className:"font-semibold text-slate-900",children:e}),em:({children:e})=>(0,t.jsx)("em",{className:"italic text-slate-800",children:e}),code:({children:e})=>(0,t.jsx)("code",{className:"px-1.5 py-0.5 bg-slate-100 text-slate-800 rounded text-sm font-mono",children:e}),blockquote:({children:e})=>(0,t.jsx)("blockquote",{className:"border-l-4 border-sky-500 pl-4 py-2 my-4 bg-sky-50 text-slate-700 italic",children:e}),a:({href:e,children:s})=>(0,t.jsx)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"text-sky-700 hover:text-sky-900 underline",children:s})},children:e})})]}):null}function f({reports:e}){return 0===e.length?(0,t.jsx)("div",{className:"bg-white border border-slate-200 rounded-xl p-8 shadow-sm",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full mb-4",style:{backgroundColor:"var(--color-neutral-100)"},children:(0,t.jsx)("span",{className:"text-3xl",children:"ðŸ“„"})}),(0,t.jsx)("h3",{className:"text-lg font-bold text-slate-900 mb-2",children:"Keine Berichte verfÃ¼gbar"}),(0,t.jsx)("p",{className:"text-sm text-slate-600",children:"Es sind noch keine Berichte fÃ¼r dieses Assessment vorhanden."}),(0,t.jsx)("p",{className:"text-sm text-slate-600 mt-2",children:"Berichte werden automatisch erstellt, sobald Ihr Assessment ausgewertet wurde."})]})}):(0,t.jsxs)("div",{className:"bg-white border border-slate-200 rounded-xl p-6 shadow-sm",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3 mb-4",children:[(0,t.jsx)("span",{className:"text-2xl flex-shrink-0",children:"ðŸ“š"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h3",{className:"text-lg sm:text-xl font-bold text-slate-900",children:"Ihre Berichte"}),(0,t.jsx)("p",{className:"text-sm text-slate-600 mt-1",children:1===e.length?"1 Bericht verfÃ¼gbar":`${e.length} Berichte verf\xfcgbar`})]})]}),(0,t.jsx)("div",{className:"space-y-3",children:e.map(e=>(0,t.jsx)("div",{className:"border border-slate-200 rounded-lg p-4 hover:bg-slate-50 transition-colors",children:(0,t.jsxs)("div",{className:"flex items-start justify-between gap-3",children:[(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)("span",{className:"text-lg",children:"ðŸ“„"}),(0,t.jsx)("span",{className:"font-medium text-slate-900",children:"Assessment-Bericht"})]}),e.report_text_short&&(0,t.jsx)("p",{className:"text-sm text-slate-600 mb-2 line-clamp-2",children:e.report_text_short}),(0,t.jsxs)("div",{className:"flex flex-wrap gap-3 text-xs text-slate-500",children:[(0,t.jsx)("span",{children:new Intl.DateTimeFormat("de-DE",{dateStyle:"medium",timeStyle:"short"}).format(new Date(e.created_at))}),e.risk_level&&(0,t.jsxs)("span",{className:"flex items-center gap-1",children:["â€¢",(0,t.jsx)("span",{className:`inline-flex items-center px-2 py-0.5 rounded text-xs font-medium ${"low"===e.risk_level?"bg-green-100 text-green-800":"moderate"===e.risk_level?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:"low"===e.risk_level?"Niedriges Risiko":"moderate"===e.risk_level?"Moderates Risiko":"Hohes Risiko"})]})]})]}),(0,t.jsx)("button",{onClick:()=>{alert("Download-Funktion wird in KÃ¼rze verfÃ¼gbar sein.")},className:"flex-shrink-0 px-3 py-2 text-sm text-sky-700 hover:text-sky-900 hover:bg-sky-50 rounded transition-colors","aria-label":"Bericht anzeigen",children:"Anzeigen"})]})},e.id))})]})}function j({outcomes:e}){return e?null===e.score_numeric&&null===e.sleep_score&&null===e.risk_level?(0,t.jsx)("div",{className:"bg-white border border-slate-200 rounded-xl p-6 shadow-sm",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-full mb-4",style:{backgroundColor:"var(--color-neutral-100)"},children:(0,t.jsx)("span",{className:"text-3xl",children:"ðŸ“Š"})}),(0,t.jsx)("h3",{className:"text-lg font-bold text-slate-900 mb-2",children:"Auswertung wird vorbereitet"}),(0,t.jsx)("p",{className:"text-sm text-slate-600",children:"Ihre detaillierten Ergebnisse werden in KÃ¼rze verfÃ¼gbar sein."})]})}):(0,t.jsxs)("div",{className:"bg-white border border-slate-200 rounded-xl p-6 shadow-sm",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3 mb-4",children:[(0,t.jsx)("span",{className:"text-2xl flex-shrink-0",children:"ðŸ“Š"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h3",{className:"text-lg sm:text-xl font-bold text-slate-900",children:"Wichtige Ergebnisse"}),(0,t.jsx)("p",{className:"text-sm text-slate-600 mt-1",children:"Zusammenfassung Ihrer Bewertung"})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[null!==e.score_numeric&&(0,t.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4",children:[(0,t.jsx)("div",{className:"text-xs text-slate-500 uppercase tracking-wide mb-2",children:"Stress-Level"}),(0,t.jsxs)("div",{className:"text-2xl font-bold text-slate-900 mb-1",children:[e.score_numeric,(0,t.jsx)("span",{className:"text-base text-slate-500",children:"/100"})]}),(0,t.jsx)("div",{className:"w-full bg-slate-200 rounded-full h-2",children:(0,t.jsx)("div",{className:"h-2 rounded-full bg-sky-600",style:{width:`${e.score_numeric}%`}})})]}),null!==e.sleep_score&&(0,t.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4",children:[(0,t.jsx)("div",{className:"text-xs text-slate-500 uppercase tracking-wide mb-2",children:"Schlaf-QualitÃ¤t"}),(0,t.jsxs)("div",{className:"text-2xl font-bold text-slate-900 mb-1",children:[e.sleep_score,(0,t.jsx)("span",{className:"text-base text-slate-500",children:"/100"})]}),(0,t.jsx)("div",{className:"w-full bg-slate-200 rounded-full h-2",children:(0,t.jsx)("div",{className:"h-2 rounded-full bg-indigo-600",style:{width:`${e.sleep_score}%`}})})]}),e.risk_level&&(0,t.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4",children:[(0,t.jsx)("div",{className:"text-xs text-slate-500 uppercase tracking-wide mb-2",children:"Risiko-Einstufung"}),(0,t.jsx)("div",{className:`inline-flex items-center px-3 py-1.5 rounded-full text-sm font-semibold ${"low"===e.risk_level?"bg-green-100 text-green-800":"moderate"===e.risk_level?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:"low"===e.risk_level?"âœ“ Niedrig":"moderate"===e.risk_level?"âš  Moderat":"âš  Hoch"}),(0,t.jsx)("p",{className:"text-xs text-slate-600 mt-2",children:"low"===e.risk_level?"Gute BewÃ¤ltigungsstrategien":"moderate"===e.risk_level?"UnterstÃ¼tzung empfohlen":"Professionelle Beratung empfohlen"})]})]}),e.total_reports>0&&(0,t.jsx)("div",{className:"mt-4 pt-4 border-t border-slate-200",children:(0,t.jsxs)("p",{className:"text-xs text-slate-500 text-center",children:["Basierend auf ",e.total_reports," ",1===e.total_reports?"Bericht":"Berichten"]})})]}):null}function v({status:e,missingDataFields:s=[]}){if(!e)return null;let r="needs_more_data"===e,l=r?{icon:"ðŸ“‹",title:"Weitere Angaben erforderlich",description:"Um Ihre Betreuung optimal zu gestalten, benÃ¶tigen wir noch einige zusÃ¤tzliche Informationen.",bgColor:"from-amber-50 to-orange-50 dark:from-amber-900/20 dark:to-orange-900/20",borderColor:"border-amber-200 dark:border-amber-800",statusLabel:"Daten ergÃ¤nzen",statusColor:"text-amber-700 dark:text-amber-400"}:{icon:"âœ…",title:"Assessment vollstÃ¤ndig",description:"Ihre Angaben sind vollstÃ¤ndig und werden fÃ¼r die weitere Betreuung verwendet.",bgColor:"from-emerald-50 to-green-50 dark:from-emerald-900/20 dark:to-green-900/20",borderColor:"border-emerald-200 dark:border-emerald-800",statusLabel:"Bereit zur Auswertung",statusColor:"text-emerald-700 dark:text-emerald-400"};return(0,t.jsxs)(c.Card,{padding:"lg",radius:"xl",shadow:"md",border:!0,className:`bg-gradient-to-br ${l.bgColor} ${l.borderColor}`,children:[(0,t.jsxs)("div",{className:"flex items-start gap-3 mb-4",children:[(0,t.jsx)("span",{className:"text-3xl flex-shrink-0",children:l.icon}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,t.jsx)("h3",{className:"text-lg sm:text-xl font-bold text-slate-900 dark:text-slate-100",style:{lineHeight:x.typography.lineHeight.tight},children:l.title}),(0,t.jsx)("span",{className:`text-xs sm:text-sm font-semibold px-2 py-1 rounded-full ${l.statusColor} bg-white dark:bg-slate-800`,children:l.statusLabel})]}),(0,t.jsx)("p",{className:"text-sm sm:text-base text-slate-700 dark:text-slate-300",children:l.description})]})]}),r&&s.length>0&&(0,t.jsxs)("div",{className:"mt-4 pt-4 border-t border-amber-200 dark:border-amber-800",children:[(0,t.jsx)("h4",{className:"text-sm sm:text-base font-semibold text-slate-900 dark:text-slate-100 mb-2",children:"Fehlende Informationen:"}),(0,t.jsx)("ul",{className:"space-y-1",children:s.map((e,s)=>{var r;return(0,t.jsxs)("li",{className:"text-sm text-slate-700 dark:text-slate-300 flex items-center gap-2",children:[(0,t.jsx)("span",{className:"text-amber-600 dark:text-amber-400",children:"â€¢"}),(0,t.jsx)("span",{children:{sleep_quality:"SchlafqualitÃ¤t",stress_triggers:"StressauslÃ¶ser",daily_routine:"Tagesablauf",exercise_frequency:"BewegungshÃ¤ufigkeit",nutrition_habits:"ErnÃ¤hrungsgewohnheiten",social_support:"Soziale UnterstÃ¼tzung",work_stress:"Arbeitsstress",family_history:"Familienanamnese"}[r=e]||`[${r}]`})]},s)})})]})]})}var y=e.i(67488),N=e.i(26394),k=e.i(78894),_=e.i(78716);let w=(0,e.i(75254).default)("stethoscope",[["path",{d:"M11 2v2",key:"1539x4"}],["path",{d:"M5 2v2",key:"1yf1q8"}],["path",{d:"M5 3H4a2 2 0 0 0-2 2v4a6 6 0 0 0 12 0V5a2 2 0 0 0-2-2h-1",key:"rb5t3r"}],["path",{d:"M8 15a6 6 0 0 0 12 0v-3",key:"x18d4x"}],["circle",{cx:"20",cy:"10",r:"2",key:"ts1r5v"}]]);var S=e.i(27558);function I({reasons:e,correlationId:r,onCtaClick:l}){let[a,n]=(0,s.useState)(null),i=e=>{n(e),l?.(e)};return(0,t.jsxs)(c.Card,{padding:"lg",radius:"xl",shadow:"lg",border:!0,className:"bg-gradient-to-br from-red-50 to-orange-50 dark:from-red-900/20 dark:to-orange-900/20 border-red-300 dark:border-red-800",children:[(0,t.jsxs)("div",{className:"flex items-start gap-3 mb-4",children:[(0,t.jsx)("div",{className:"flex-shrink-0 w-12 h-12 bg-red-100 dark:bg-red-900/40 rounded-full flex items-center justify-center",children:(0,t.jsx)(k.AlertTriangle,{className:"w-6 h-6 text-red-600 dark:text-red-400"})}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h3",{className:"text-xl font-bold text-red-900 dark:text-red-100 mb-2",style:{lineHeight:x.typography.lineHeight.tight},children:"Wichtiger Hinweis zu Ihrem Ergebnis"}),(0,t.jsx)("p",{className:"text-sm text-red-800 dark:text-red-200",children:S.ESCALATION_DISCLAIMER.intro})]})]}),(0,t.jsxs)("div",{className:"mb-6 p-4 bg-white dark:bg-slate-800 rounded-lg border border-red-200 dark:border-red-800",children:[(0,t.jsx)("p",{className:"text-sm text-slate-700 dark:text-slate-300 mb-2",children:(0,t.jsxs)("strong",{children:[S.ESCALATION_DISCLAIMER.title,":"]})}),(0,t.jsx)("ul",{className:"space-y-1 text-sm text-slate-700 dark:text-slate-300",children:e.map((e,s)=>(0,t.jsxs)("li",{className:"flex items-start gap-2",children:[(0,t.jsx)("span",{className:"text-red-600 dark:text-red-400 flex-shrink-0",children:"â€¢"}),(0,t.jsx)("span",{children:e})]},s))})]}),(0,t.jsxs)("div",{className:"mb-6 p-4 bg-red-100 dark:bg-red-900/30 rounded-lg",children:[(0,t.jsx)(N.EmergencyContactInfo,{variant:"compact",title:S.RED_FLAG_EMERGENCY_WARNING.title,showAll:!1}),(0,t.jsx)("p",{className:"text-sm text-red-800 dark:text-red-200 mt-2 ml-6",children:S.RED_FLAG_EMERGENCY_WARNING.urgentAction})]}),(0,t.jsxs)("div",{className:"space-y-3",children:[(0,t.jsxs)(y.Button,{variant:"danger",size:"lg",fullWidth:!0,onClick:()=>i("video_consultation"),disabled:null!==a,className:"flex items-center justify-center gap-2",children:[(0,t.jsx)(_.Video,{className:"w-5 h-5"}),"video_consultation"===a?"Wird vorbereitet...":"Video-Sprechstunde anfordern"]}),(0,t.jsxs)(y.Button,{variant:"outline",size:"lg",fullWidth:!0,onClick:()=>i("doctor_appointment"),disabled:null!==a,className:"flex items-center justify-center gap-2",children:[(0,t.jsx)(w,{className:"w-5 h-5"}),"doctor_appointment"===a?"Wird vorbereitet...":"Arzttermin vereinbaren"]})]}),(0,t.jsxs)("p",{className:"mt-4 text-xs text-slate-500 dark:text-slate-400 text-center",children:["Correlation ID: ",r.substring(0,16),"..."]})]})}var E=e.i(88715),A=e.i(84976);let C=["request_id","correlation_id","algorithm_version","prompt_version","report_version","version","safety_score","finding_count","status_from","status_to","assigned_to_role","reason","consent_type","granted","rollout_percent","rollout_percent_from","rollout_percent_to","is_active","assessment_id","report_id","task_id","funnel_id","version_id","consent_id","config_key","consent_version","profile_updated","review_id","job_id","decision_reason","has_notes","deletion_reason","scheduled_for","retention_period_days","records_deleted","records_anonymized","executed_by","anonymization_reason","kpi_event","funnel_slug","drop_off_reason","current_step_id","step_order_index","duration_seconds","duration_before_drop_seconds","started_at","completed_at","time_to_report_seconds","report_created_at","error_type"],B=["content","text","notes","answers","answer","response","extracted_data","clinical_notes","patient_notes","observation","diagnosis","medication","name","email","phone","address","ssn","dob","date_of_birth"];function z(e,t=5e3){if(!e||"object"!=typeof e)return{};let s={},r=0;for(let[l,a]of Object.entries(e)){let e=l.toLowerCase();if(B.some(t=>e.includes(t))){s[l]="[REDACTED]";continue}let n=C.includes(l);if("number"==typeof a||"boolean"==typeof a)s[l]=a,r+=String(a).length;else if("string"==typeof a){let t=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(a),i=a.length<=100&&!/[<>{}]/.test(a);n||t||i&&e.includes("id")?(s[l]=a,r+=a.length):s[l]="[REDACTED]"}else null==a?s[l]=a:"object"!=typeof a||Array.isArray(a)?s[l]="[REDACTED]":(s[l]=z(a,t-r),r+=JSON.stringify(s[l]).length);if(r>t){console.warn("[audit/log] Metadata/diff size exceeded limit, truncating");break}}return s}async function D(e){Date.now();try{let t,s;if(!e.entity_type)return{success:!1,error:"entity_type is required"};if(!e.entity_id)return{success:!1,error:"entity_id is required"};if(!e.action)return{success:!1,error:"action is required"};if(!e.source)return{success:!1,error:"source is required"};let r=(t=A.env.NEXT_PUBLIC_SUPABASE_URL||A.env.SUPABASE_URL,s=A.env.SUPABASE_SERVICE_ROLE_KEY||A.env.SUPABASE_SERVICE_KEY,t&&s?(0,E.createClient)(t,s,{auth:{persistSession:!1}}):(console.error("[audit/log] Missing Supabase credentials"),null));if(!r)return console.error("[audit/log] Cannot create Supabase client"),{success:!1,error:"Supabase client unavailable"};let l=z(e.metadata||{}),a={};e.diff?.before&&(a.before=z(e.diff.before)),e.diff?.after&&(a.after=z(e.diff.after)),e.diff?.changes&&(a.changes=z(e.diff.changes));let n={org_id:e.org_id||null,actor_user_id:e.actor_user_id||null,actor_role:e.actor_role||null,source:e.source,entity_type:e.entity_type,entity_id:e.entity_id,action:e.action,diff:a||{},metadata:l||{}},{data:i,error:d}=await r.from("audit_log").insert(n).select("id").single();if(d)return console.error("[audit/log] Failed to insert audit event",{error:d,entity_type:e.entity_type,entity_id:e.entity_id,action:e.action}),{success:!1,error:d.message};return Date.now(),{success:!0,audit_id:i.id}}catch(e){return console.error("[audit/log] Unexpected error logging audit event",e),{success:!1,error:e instanceof Error?e.message:"Unknown error"}}}var $=e.i(3308);async function H(e,t,s,r){return await D({entity_type:$.AUDIT_ENTITY_TYPE.ASSESSMENT,entity_id:e,action:$.AUDIT_ACTION.FLAG,source:$.AUDIT_SOURCE.SYSTEM,metadata:{correlation_id:t,red_flag_severity:s,red_flag_source:r}})}let T="Fehler beim Laden der Ergebnisse.";function R({slug:e,assessmentId:c,reports:x,keyOutcomes:g}){let b=(0,r.useRouter)(),y=(0,a.useIsMobile)(),[N,k]=(0,s.useState)(!0),[_,w]=(0,s.useState)(null),[S,E]=(0,s.useState)(null),[A,C]=(0,s.useState)([]),[B,z]=(0,s.useState)(!1),[D,$]=(0,s.useState)(null),R=S?.funnel??e,U=S?.funnelTitle??"";if((0,s.useEffect)(()=>{(async()=>{try{var t;let s,r;k(!0),w(null);let l=await fetch(`/api/funnels/${e}/assessments/${c}/result`,{credentials:"include"});if(!l.ok){let e=await l.json().catch(()=>null),t=e?.error?.message||T;throw Error(t)}let a=await l.json();if(!a.success||!a.data)throw Error(a.error?.message||T);if("completed"!==a.data.status){E(a.data),k(!1);return}E(a.data);let n=(t={assessmentId:a.data.id,reportId:x[0]?.id,riskLevel:g?.risk_level||null,workupStatus:a.data.workupStatus||null,missingDataFields:a.data.missingDataFields||[]},s=[],r=`esc-${"undefined"!=typeof crypto&&"randomUUID"in crypto?crypto.randomUUID():`${Date.now()}-${Math.random().toString(36).slice(2,11)}`}`,"high"===t.riskLevel&&s.push({severity:"critical",source:"report_risk_level",reason:"Hohes Stressniveau erkannt â€“ Ã¤rztliche RÃ¼cksprache empfohlen",triggeredBy:t.reportId?[t.reportId]:void 0}),{shouldEscalate:s.length>0,redFlags:s,correlationId:r});if(n.shouldEscalate){$({shouldEscalate:!0,reasons:n.redFlags.map(e=>e.reason),correlationId:n.correlationId});let e=n.redFlags[0];e&&await H(a.data.id,n.correlationId,e.severity,e.source).catch(e=>{console.error("[escalation] Failed to log offer shown:",e)})}try{let e=await fetch(`/api/funnels/${a.data.funnel}/content-pages`);if(e.ok){let t=await e.json();C(t),z(0===t.length)}else C([]),z(!0)}catch(e){console.error("Error loading content pages:",e),C([]),z(!0)}k(!1)}catch(e){console.error("Error loading result:",e),w(e instanceof Error?e.message:T),k(!1)}})()},[c,e,b]),N)return(0,t.jsx)("main",{className:"flex items-center justify-center bg-muted py-20",children:(0,t.jsx)(n.LoadingSpinner,{size:"md",text:"Ergebnisse werden geladenâ€¦"})});if(_||!S)return(0,t.jsx)("main",{className:"flex items-center justify-center bg-muted py-20 px-4",children:(0,t.jsx)(i.ErrorState,{title:"Fehler",message:_||"Ergebnisse konnten nicht geladen werden.",onRetry:()=>b.push("/patient/dashboard"),retryText:"ZurÃ¼ck zum Dashboard"})});let L=(0,l.getResultPages)(A),F=(0,l.getInfoPages)(A),M=[..."needs_more_data"===S.workupStatus?[{title:"ZusÃ¤tzliche Fragen beantworten",description:"ErgÃ¤nzen Sie fehlende Informationen, um eine vollstÃ¤ndige Auswertung zu ermÃ¶glichen.",actionLabel:"Fragen beantworten",onClick:()=>b.push(`/patient/funnel/${R}`)}]:[],{title:"Termin besprechen",description:"Ihre Ergebnisse werden von Ihrem Behandlungsteam eingesehen und beim nÃ¤chsten Termin besprochen."},{title:"Ressourcen ansehen",description:"Entdecken Sie hilfreiche Artikel und Strategien zum Umgang mit Stress und zur StÃ¤rkung Ihrer Resilienz.",...L.length>0||F.length>0?{actionLabel:"Ressourcen ansehen",actionUrl:`/patient/funnel/${R}/content/${L[0]?.slug||F[0]?.slug}`}:{}},{title:"Verlauf ansehen",description:"Verfolgen Sie Ihre Assessments Ã¼ber die Zeit und erkennen Sie Muster in Ihrer Historie.",actionLabel:"Zur Historie",onClick:()=>b.push("/patient/history")}],P=async e=>{if(S&&D)try{await fetch("/api/escalation/log-click",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({assessmentId:S.id,correlationId:D.correlationId,offerType:e})}).catch(e=>{console.error("[escalation] Failed to log CTA click:",e)}),b.push(`/patient/escalation?type=${e}&correlation=${encodeURIComponent(D.correlationId)}`)}catch(e){console.error("[escalation] Error handling CTA click:",e)}};return(0,t.jsxs)(t.Fragment,{children:[y&&(0,t.jsx)(d.default,{variant:"with-title",title:"Ergebnisse",subtitle:U||"Assessment",showBack:!0}),(0,t.jsx)("main",{className:"min-h-screen bg-muted px-4 pt-8 sm:py-12",style:{paddingBottom:"calc(6rem + env(safe-area-inset-bottom))"},children:(0,t.jsxs)(o.default,{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 sm:w-20 sm:h-20 rounded-full mb-4",style:{backgroundColor:"var(--color-success-light)"},children:(0,t.jsx)("span",{className:"text-3xl sm:text-4xl",children:"âœ“"})}),(0,t.jsx)("h1",{className:"text-2xl sm:text-3xl md:text-4xl font-bold mb-2",style:{color:"var(--foreground)"},children:"Assessment abgeschlossen!"}),(0,t.jsxs)("p",{className:"text-base sm:text-lg",style:{color:"var(--color-neutral-600)"},children:[U||"Ihr Assessment"," wurde erfolgreich gespeichert"]}),S.completedAt&&!Number.isNaN(Date.parse(S.completedAt))&&(0,t.jsx)("p",{className:"text-sm mt-2",style:{color:"var(--color-neutral-500)"},children:new Intl.DateTimeFormat("de-DE",{dateStyle:"medium",timeStyle:"short"}).format(new Date(S.completedAt))})]}),D?.shouldEscalate&&(0,t.jsx)(I,{reasons:D.reasons,correlationId:D.correlationId,onCtaClick:P}),(0,t.jsx)(v,{status:S.workupStatus||null,missingDataFields:S.missingDataFields||[]}),(0,t.jsx)("div",{className:"bg-white border border-slate-200 rounded-xl p-6 shadow-sm",children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("span",{className:"text-2xl flex-shrink-0",children:"ðŸ§¾"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h3",{className:"text-lg sm:text-xl font-bold text-slate-900 mb-2",children:S.result?.summaryTitle||"Ergebnis wird vorbereitet"}),(0,t.jsx)("ul",{className:"text-sm sm:text-base text-slate-600 space-y-1 list-disc pl-5",children:(S.result?.summaryBullets?.length?S.result.summaryBullets:["Ihre Antworten wurden gespeichert.","Die Auswertung ist in Vorbereitung.","Bitte prÃ¼fen Sie spÃ¤ter erneut."]).map((e,s)=>(0,t.jsx)("li",{children:e},s))}),S.result?.derived?.cardiovascularAgeYears!==void 0&&(0,t.jsxs)("p",{className:"text-sm text-slate-500 mt-3",children:["Erfasste Altersangabe: ",S.result.derived.cardiovascularAgeYears??"â€”"]})]})]})}),(0,t.jsx)(j,{outcomes:g}),(0,t.jsx)(f,{reports:x}),g&&null!==g.score_numeric&&(0,t.jsx)(m,{score:g.score_numeric,maxScore:100,level:"low"===g.risk_level?"low":"high"===g.risk_level?"high":"medium",label:"Stress-Level",description:"Ihre Gesamtbewertung"}),(0,t.jsx)(p,{text:`## Vielen Dank f\xfcr Ihre Teilnahme

Ihre Antworten sind nun gesichert und werden f\xfcr die weitere Betreuung verwendet.

### Ihre n\xe4chsten Schritte

${"needs_more_data"===S.workupStatus?`Es werden noch einige zus\xe4tzliche Informationen ben\xf6tigt, um eine vollst\xe4ndige Auswertung zu erm\xf6glichen. Bitte beantworten Sie die fehlenden Fragen \xfcber die Schaltfl\xe4che "Zus\xe4tzliche Fragen beantworten" in den n\xe4chsten Schritten.

`:""}Ihre Angaben helfen Ihrem Behandlungsteam dabei, ein besseres Verst\xe4ndnis Ihrer aktuellen Situation zu entwickeln. Die Ergebnisse werden vertraulich behandelt und nur mit autorisiertem medizinischem Personal geteilt.

### Wie geht es weiter?

Bei Ihrem n\xe4chsten Termin k\xf6nnen die Ergebnisse gemeinsam besprochen werden. Ihr Behandlungsteam wird Sie \xfcber weitere Schritte informieren.`,title:"Ihre Zusammenfassung",icon:"ðŸ¤–"}),(0,t.jsx)(h,{}),(0,t.jsx)(u,{actions:M}),(L.length>0||F.length>0)&&(0,t.jsx)("div",{className:"bg-white border border-slate-200 rounded-xl p-6 shadow-sm",children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("span",{className:"text-2xl flex-shrink-0",children:"ðŸ“š"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h3",{className:"text-lg sm:text-xl font-bold text-slate-900 mb-2",children:"Weitere Ressourcen"}),(0,t.jsx)("p",{className:"text-sm sm:text-base text-slate-600 mb-4",children:"Erfahren Sie mehr Ã¼ber Stress, Resilienz und praktische Strategien:"}),(0,t.jsxs)("div",{className:"grid gap-2",children:[L.map(e=>(0,t.jsxs)("a",{href:`/patient/funnel/${R}/content/${e.slug}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-sm sm:text-base text-sky-700 hover:text-sky-900 hover:underline font-medium p-2 hover:bg-sky-50 rounded transition-colors",children:[(0,t.jsx)("span",{children:"ðŸ“„"}),(0,t.jsx)("span",{children:e.title})]},e.id)),F.map(e=>(0,t.jsxs)("a",{href:`/patient/funnel/${R}/content/${e.slug}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 text-sm sm:text-base text-sky-700 hover:text-sky-900 hover:underline font-medium p-2 hover:bg-sky-50 rounded transition-colors",children:[(0,t.jsx)("span",{children:"ðŸ“„"}),(0,t.jsx)("span",{children:e.title})]},e.id))]})]})]})}),B&&0===L.length&&0===F.length&&(0,t.jsx)("div",{className:"bg-white border border-slate-200 rounded-xl p-6 shadow-sm",children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("span",{className:"text-2xl flex-shrink-0",children:"ðŸ“š"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h3",{className:"text-lg sm:text-xl font-bold text-slate-900 mb-2",children:"Inhalte noch nicht verfÃ¼gbar"}),(0,t.jsx)("p",{className:"text-sm sm:text-base text-slate-600",children:"FÃ¼r dieses Assessment sind aktuell noch keine zusÃ¤tzlichen Inhalte hinterlegt."})]})]})}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 pt-4",children:[(0,t.jsx)("button",{onClick:()=>b.push("/patient/dashboard?refresh=funnel"),className:"w-full sm:flex-1 px-6 py-4 bg-sky-600 text-white rounded-xl text-base font-semibold hover:bg-sky-700 active:bg-sky-800 transition-colors shadow-md",style:{minHeight:"56px"},children:"Zum Dashboard"}),(0,t.jsx)("button",{onClick:()=>b.push("/patient/history"),className:"w-full sm:flex-1 px-6 py-4 bg-slate-200 text-slate-700 rounded-xl text-base font-semibold hover:bg-slate-300 active:bg-slate-400 transition-colors",style:{minHeight:"56px"},children:"Meine Assessments"})]}),(0,t.jsx)("div",{className:"bg-white border border-slate-200 rounded-xl p-5 shadow-sm",children:(0,t.jsxs)("div",{className:"flex items-start gap-3",children:[(0,t.jsx)("span",{className:"text-2xl flex-shrink-0",children:"ðŸ”’"}),(0,t.jsxs)("div",{className:"flex-1",children:[(0,t.jsx)("h3",{className:"text-base sm:text-lg font-bold text-slate-900 mb-2",children:"Ihre Daten sind sicher"}),(0,t.jsx)("p",{className:"text-sm sm:text-base text-slate-600",children:"Alle Ihre Antworten wurden verschlÃ¼sselt gespeichert und unterliegen strengen Datenschutzrichtlinien. Nur autorisiertes medizinisches Personal hat Zugriff auf Ihre Daten."})]})]})})]})})]})}e.s(["default",()=>R],8707)}]);

//# sourceMappingURL=8c70367e970c14d1.js.map