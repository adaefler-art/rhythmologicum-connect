{"version":3,"sources":["turbopack:///[project]/node_modules/lucide-react/src/icons/arrow-left.ts","turbopack:///[project]/app/components/MobileHeader.tsx","turbopack:///[project]/node_modules/lucide-react/src/icons/settings.ts","turbopack:///[project]/apps/rhythm-patient-ui/app/patient/dashboard/client.tsx","turbopack:///[project]/apps/rhythm-patient-ui/app/patient/dashboard/components/DashboardHeader.tsx","turbopack:///[project]/apps/rhythm-patient-ui/app/patient/dashboard/components/AMYSlot.tsx","turbopack:///[project]/apps/rhythm-patient-ui/app/patient/dashboard/components/AMYComposer.tsx","turbopack:///[project]/lib/api/contracts/triage/index.ts","turbopack:///[project]/lib/triage/router.ts","turbopack:///[project]/lib/triage/storage.ts","turbopack:///[project]/apps/rhythm-patient-ui/app/patient/dashboard/components/NextStepCard.tsx","turbopack:///[project]/apps/rhythm-patient-ui/app/patient/dashboard/components/ContentTilesGrid.tsx","turbopack:///[project]/apps/rhythm-patient-ui/app/patient/dashboard/components/ProgressSummary.tsx","turbopack:///[project]/lib/hooks/useDashboardData.ts","turbopack:///[project]/lib/hooks/useAppFocus.ts"],"sourcesContent":["import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  ['path', { d: 'm12 19-7-7 7-7', key: '1l729n' }],\n  ['path', { d: 'M19 12H5', key: 'x3x0zl' }],\n];\n\n/**\n * @component @name ArrowLeft\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJtMTIgMTktNy03IDctNyIgLz4KICA8cGF0aCBkPSJNMTkgMTJINSIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/arrow-left\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst ArrowLeft = createLucideIcon('arrow-left', __iconNode);\n\nexport default ArrowLeft;\n","'use client'\n\nimport React from 'react'\nimport { useRouter } from 'next/navigation'\nimport { ArrowLeft, Settings, Info } from 'lucide-react'\nimport { spacing, typography, shadows, colors } from '@/lib/design-tokens'\n\nexport type MobileHeaderVariant = 'minimal' | 'with-title' | 'with-action'\n\nexport type MobileHeaderProps = {\n  /**\n   * Display variant of the header\n   * - 'minimal': Only back button\n   * - 'with-title': Back button + title\n   * - 'with-action': Back button + title + action icon\n   */\n  variant?: MobileHeaderVariant\n  /**\n   * Title to display in the header\n   */\n  title?: string\n  /**\n   * Optional subtitle/breadcrumb text\n   */\n  subtitle?: string\n  /**\n   * Show back button (default: true)\n   */\n  showBack?: boolean\n  /**\n   * Custom back navigation handler\n   * If not provided, uses router.back()\n   */\n  onBack?: () => void\n  /**\n   * Action icon type ('settings' or 'info')\n   */\n  actionIcon?: 'settings' | 'info'\n  /**\n   * Handler for action icon click\n   */\n  onAction?: () => void\n  /**\n   * Additional CSS classes\n   */\n  className?: string\n}\n\n/**\n * MobileHeader Component\n * \n * Global mobile navigation header for all /patient/* pages.\n * Provides consistent back navigation and optional title/actions.\n * \n * Features:\n * - Sticky positioning with elevated z-index\n * - Touch-friendly 44px minimum hit areas\n * - Accessible focus management\n * - Three variants: minimal, with-title, with-action\n * - Consistent design tokens\n * \n * UX Pattern:\n * [‚Üê Back] [Title/Subtitle] [Action Icon]\n * \n * @example\n * // Minimal - just back button\n * <MobileHeader variant=\"minimal\" />\n * \n * @example\n * // With title\n * <MobileHeader variant=\"with-title\" title=\"Stress Assessment\" />\n * \n * @example\n * // With action icon\n * <MobileHeader \n *   variant=\"with-action\" \n *   title=\"Ergebnisse\"\n *   actionIcon=\"info\"\n *   onAction={() => console.log('Info clicked')}\n * />\n */\nexport default function MobileHeader({\n  variant = 'with-title',\n  title,\n  subtitle,\n  showBack = true,\n  onBack,\n  actionIcon = 'settings',\n  onAction,\n  className = '',\n}: MobileHeaderProps) {\n  const router = useRouter()\n\n  const handleBack = () => {\n    if (onBack) {\n      onBack()\n    } else {\n      router.back()\n    }\n  }\n\n  // Render action icon based on type\n  const renderActionIcon = () => {\n    if (!onAction) return null\n\n    const iconProps = {\n      size: 20,\n      strokeWidth: 2,\n      'aria-hidden': true,\n    }\n\n    return (\n      <button\n        type=\"button\"\n        onClick={onAction}\n        className=\"shrink-0 flex items-center justify-center rounded-full bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 active:bg-slate-300 dark:active:bg-slate-500 transition-colors focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-2\"\n        style={{\n          width: '44px',\n          height: '44px',\n        }}\n        aria-label={actionIcon === 'settings' ? 'Einstellungen' : 'Information'}\n      >\n        {actionIcon === 'settings' ? (\n          <Settings {...iconProps} className=\"text-slate-700 dark:text-slate-300\" />\n        ) : (\n          <Info {...iconProps} className=\"text-slate-700 dark:text-slate-300\" />\n        )}\n      </button>\n    )\n  }\n\n  return (\n    <header\n      className={`sticky top-0 bg-white dark:bg-slate-800 border-b border-slate-200 dark:border-slate-700 transition-colors duration-150 ${className}`}\n      style={{\n        zIndex: 50,\n        boxShadow: shadows.sm,\n      }}\n    >\n      <div\n        className=\"flex items-center gap-3\"\n        style={{\n          padding: `${spacing.sm} ${spacing.md}`,\n          minHeight: '56px',\n        }}\n      >\n        {/* Back Button */}\n        {showBack && (\n          <button\n            type=\"button\"\n            onClick={handleBack}\n            className=\"shrink-0 flex items-center justify-center rounded-full bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 active:bg-slate-300 dark:active:bg-slate-500 transition-colors focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-2\"\n            style={{\n              width: '44px',\n              height: '44px',\n            }}\n            aria-label=\"Zur√ºck\"\n          >\n            <ArrowLeft\n              size={20}\n              strokeWidth={2}\n              className=\"text-slate-700 dark:text-slate-300\"\n              aria-hidden={true}\n            />\n          </button>\n        )}\n\n        {/* Title Section */}\n        {(variant === 'with-title' || variant === 'with-action') && (\n          <div className=\"flex-1 min-w-0\">\n            {subtitle && (\n              <p\n                className=\"text-xs font-medium text-sky-600 dark:text-sky-400 uppercase tracking-wide truncate\"\n                style={{ fontSize: typography.fontSize.xs }}\n              >\n                {subtitle}\n              </p>\n            )}\n            {title && (\n              <h1\n                className=\"font-semibold text-slate-900 dark:text-slate-100 truncate\"\n                style={{\n                  fontSize: typography.fontSize.lg,\n                  lineHeight: typography.lineHeight.tight,\n                }}\n              >\n                {title}\n              </h1>\n            )}\n          </div>\n        )}\n\n        {/* Action Icon */}\n        {variant === 'with-action' && renderActionIcon()}\n      </div>\n    </header>\n  )\n}\n","import createLucideIcon from '../createLucideIcon';\nimport { IconNode } from '../types';\n\nexport const __iconNode: IconNode = [\n  [\n    'path',\n    {\n      d: 'M9.671 4.136a2.34 2.34 0 0 1 4.659 0 2.34 2.34 0 0 0 3.319 1.915 2.34 2.34 0 0 1 2.33 4.033 2.34 2.34 0 0 0 0 3.831 2.34 2.34 0 0 1-2.33 4.033 2.34 2.34 0 0 0-3.319 1.915 2.34 2.34 0 0 1-4.659 0 2.34 2.34 0 0 0-3.32-1.915 2.34 2.34 0 0 1-2.33-4.033 2.34 2.34 0 0 0 0-3.831A2.34 2.34 0 0 1 6.35 6.051a2.34 2.34 0 0 0 3.319-1.915',\n      key: '1i5ecw',\n    },\n  ],\n  ['circle', { cx: '12', cy: '12', r: '3', key: '1v7zrd' }],\n];\n\n/**\n * @component @name Settings\n * @description Lucide SVG icon component, renders SVG Element with children.\n *\n * @preview ![img](data:image/svg+xml;base64,PHN2ZyAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIgogIHdpZHRoPSIyNCIKICBoZWlnaHQ9IjI0IgogIHZpZXdCb3g9IjAgMCAyNCAyNCIKICBmaWxsPSJub25lIgogIHN0cm9rZT0iIzAwMCIgc3R5bGU9ImJhY2tncm91bmQtY29sb3I6ICNmZmY7IGJvcmRlci1yYWRpdXM6IDJweCIKICBzdHJva2Utd2lkdGg9IjIiCiAgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIgogIHN0cm9rZS1saW5lam9pbj0icm91bmQiCj4KICA8cGF0aCBkPSJNOS42NzEgNC4xMzZhMi4zNCAyLjM0IDAgMCAxIDQuNjU5IDAgMi4zNCAyLjM0IDAgMCAwIDMuMzE5IDEuOTE1IDIuMzQgMi4zNCAwIDAgMSAyLjMzIDQuMDMzIDIuMzQgMi4zNCAwIDAgMCAwIDMuODMxIDIuMzQgMi4zNCAwIDAgMS0yLjMzIDQuMDMzIDIuMzQgMi4zNCAwIDAgMC0zLjMxOSAxLjkxNSAyLjM0IDIuMzQgMCAwIDEtNC42NTkgMCAyLjM0IDIuMzQgMCAwIDAtMy4zMi0xLjkxNSAyLjM0IDIuMzQgMCAwIDEtMi4zMy00LjAzMyAyLjM0IDIuMzQgMCAwIDAgMC0zLjgzMUEyLjM0IDIuMzQgMCAwIDEgNi4zNSA2LjA1MWEyLjM0IDIuMzQgMCAwIDAgMy4zMTktMS45MTUiIC8+CiAgPGNpcmNsZSBjeD0iMTIiIGN5PSIxMiIgcj0iMyIgLz4KPC9zdmc+Cg==) - https://lucide.dev/icons/settings\n * @see https://lucide.dev/guide/packages/lucide-react - Documentation\n *\n * @param {Object} props - Lucide icons props and any valid SVG attribute\n * @returns {JSX.Element} JSX Element\n *\n */\nconst Settings = createLucideIcon('settings', __iconNode);\n\nexport default Settings;\n","'use client'\n\nimport { useEffect } from 'react'\nimport { useRouter, useSearchParams } from 'next/navigation'\nimport MobileHeader from '@/app/components/MobileHeader'\nimport { LoadingSpinner, ErrorState } from '@/lib/ui'\nimport {\n  DashboardHeader,\n  AMYComposer,\n  NextStepCard,\n  ContentTilesGrid,\n  ProgressSummary,\n} from './components'\nimport { useDashboardData } from '@/lib/hooks/useDashboardData'\nimport { useAppFocus } from '@/lib/hooks/useAppFocus'\n\n/**\n * Patient Dashboard Client Component (E6.5.4 + E6.5.9)\n * \n * Enhanced dashboard layout with sections:\n * - Header with greeting (AC: empty states)\n * - AMY slot (placeholder for E6.6)\n * - Next Step card (AC3: always visible when available)\n * - Content tiles grid\n * - Progress summary (funnels/workup)\n * \n * E6.5.4 Acceptance Criteria:\n * - AC1: Empty states render gracefully (no crashes)\n * - AC2: Mobile responsive (shell)\n * - AC3: NextStep CTA always visible when available\n * \n * E6.5.9 Acceptance Criteria:\n * - AC1: After completing funnel, dashboard reflects new status without hard reload\n * - AC2: Offline/failed fetch shows error state + retry (not blank)\n * \n * Refresh Strategy:\n * - Auto-refresh on app focus (mobile-friendly)\n * - Refresh after funnel completion (via ?refresh=funnel)\n * - Refresh after follow-up answered (via ?refresh=followup)\n * - Stale-while-revalidate pattern (shows old data while fetching new)\n */\nexport default function DashboardClient() {\n  const router = useRouter()\n  const searchParams = useSearchParams()\n  \n  // E6.5.9: Use dashboard data hook with stale-while-revalidate\n  const { data: dashboardData, state, error, isStale, refresh, retry } = useDashboardData()\n\n  // E6.5.9: Auto-refresh on app focus (mobile-friendly)\n  useAppFocus(() => {\n    refresh()\n  })\n\n  // E6.5.9: Refresh when returning from funnel completion or follow-up\n  // E6.6.5: Handle scroll-to-content from triage router\n  useEffect(() => {\n    const refreshTrigger = searchParams.get('refresh')\n    const scrollTo = searchParams.get('scrollTo')\n    const action = searchParams.get('action')\n    \n    if (refreshTrigger === 'funnel' || refreshTrigger === 'followup') {\n      // Clear the query param to avoid repeated refreshes\n      const newUrl = new URL(window.location.href)\n      newUrl.searchParams.delete('refresh')\n      router.replace(newUrl.pathname + newUrl.search, { scroll: false })\n      \n      // Trigger refresh\n      refresh()\n    }\n\n    // E6.6.5: Handle scroll-to-content from triage SHOW_CONTENT action\n    if (scrollTo === 'content') {\n      // Scroll to content tiles after a short delay to allow render\n      setTimeout(() => {\n        const contentElement = document.getElementById('content-tiles')\n        if (contentElement) {\n          contentElement.scrollIntoView({ behavior: 'smooth', block: 'start' })\n        }\n      }, 300)\n\n      // Clear the query param\n      const newUrl = new URL(window.location.href)\n      newUrl.searchParams.delete('scrollTo')\n      router.replace(newUrl.pathname + newUrl.search, { scroll: false })\n    }\n\n    // E6.6.5: Handle resume action from triage RESUME_FUNNEL\n    if (action === 'resume' && dashboardData?.nextStep?.target) {\n      // Auto-navigate to resume target\n      setTimeout(() => {\n        router.push(dashboardData.nextStep.target!)\n      }, 500)\n\n      // Clear the query param\n      const newUrl = new URL(window.location.href)\n      newUrl.searchParams.delete('action')\n      router.replace(newUrl.pathname + newUrl.search, { scroll: false })\n    }\n  }, [searchParams, router, refresh, dashboardData])\n\n  const handleNextStepAction = () => {\n    if (dashboardData?.nextStep?.target) {\n      router.push(dashboardData.nextStep.target)\n    }\n  }\n\n  const handleFunnelClick = (funnel: any) => {\n    router.push(`/patient/funnel/${funnel.slug}`)\n  }\n\n  const handleTileClick = (tile: any) => {\n    if (tile.actionTarget) {\n      router.push(tile.actionTarget)\n    }\n  }\n\n\n  return (\n    <div className=\"min-h-screen flex flex-col bg-gradient-to-b from-sky-50 via-slate-50 to-slate-100 dark:from-slate-800 dark:via-slate-900 dark:to-slate-950 transition-colors duration-150\">\n      <MobileHeader\n        variant=\"with-title\"\n        title=\"Dashboard\"\n        subtitle=\"Rhythmologicum Connect\"\n        showBack={false}\n      />\n\n      <main\n        className=\"flex-1 overflow-y-auto px-4 pt-4 sm:pt-6\"\n        style={{ paddingBottom: 'calc(6rem + env(safe-area-inset-bottom))' }}\n      >\n        <div className=\"w-full max-w-4xl mx-auto space-y-6\">\n          {/* E6.5.9: Loading state - show spinner only on initial load */}\n          {state === 'loading' && !dashboardData && (\n            <div className=\"py-12\">\n              <LoadingSpinner size=\"lg\" text=\"Dashboard wird geladen...\" centered />\n            </div>\n          )}\n\n          {/* E6.5.9: Revalidating state - show subtle indicator while keeping content visible */}\n          {state === 'revalidating' && isStale && dashboardData && (\n            <div className=\"bg-sky-50 border border-sky-200 rounded-lg px-4 py-2 text-sm text-sky-700\">\n              <div className=\"flex items-center gap-2\">\n                <div className=\"animate-spin h-4 w-4 border-2 border-sky-600 border-t-transparent rounded-full\" />\n                <span>Aktualisiere Dashboard...</span>\n              </div>\n            </div>\n          )}\n\n          {/* E6.5.9 AC2: Error state with retry - not a blank screen */}\n          {error && (\n            <ErrorState\n              title=\"Fehler beim Laden\"\n              message={error}\n              onRetry={retry}\n              centered={!dashboardData}\n            />\n          )}\n\n          {/* E6.5.4 AC1: Dashboard content with empty states */}\n          {/* E6.5.9: Show stale data during revalidation (stale-while-revalidate) */}\n          {dashboardData && (\n            <>\n              {/* Header Section */}\n              <DashboardHeader />\n\n              {/* E6.6.1: AMY Composer - Guided Mode for bounded input */}\n              <AMYComposer />\n\n              {/* E6.5.4 AC3: Next Step Card - Always visible when available */}\n              {dashboardData.nextStep && (\n                <NextStepCard\n                  nextStep={dashboardData.nextStep}\n                  onAction={handleNextStepAction}\n                />\n              )}\n\n              {/* Content Tiles Grid - E6.6.5: Add id for scroll-to navigation */}\n              <div id=\"content-tiles\">\n                <ContentTilesGrid\n                  tiles={dashboardData.contentTiles}\n                  onTileClick={handleTileClick}\n                />\n              </div>\n\n              {/* Progress Summary */}\n              <ProgressSummary\n                funnelSummaries={dashboardData.funnelSummaries}\n                workupSummary={dashboardData.workupSummary}\n                onFunnelClick={handleFunnelClick}\n              />\n            </>\n          )}\n        </div>\n      </main>\n    </div>\n  )\n}\n","'use client'\n\nimport { typography } from '@/lib/design-tokens'\n\nexport interface DashboardHeaderProps {\n  /** Optional greeting name */\n  greeting?: string\n}\n\n/**\n * Dashboard Header Component\n * \n * Displays a greeting and subtitle for the dashboard.\n * Part of E6.5.4 implementation.\n * \n * Features:\n * - Optional personalized greeting\n * - Responsive typography\n * - Dark mode support\n * \n * @example\n * <DashboardHeader greeting=\"Max\" />\n * \n * @example\n * <DashboardHeader />\n */\nexport function DashboardHeader({ greeting }: DashboardHeaderProps) {\n  return (\n    <div className=\"space-y-2\">\n      <h1\n        className=\"font-bold leading-tight text-slate-900 dark:text-slate-100\"\n        style={{\n          fontSize: typography.fontSize['2xl'],\n          lineHeight: typography.lineHeight.tight,\n        }}\n      >\n        {greeting ? `Willkommen zur√ºck, ${greeting}` : 'Willkommen zur√ºck'}\n      </h1>\n      <p className=\"text-slate-600 dark:text-slate-400\">\n        Ihr pers√∂nliches Gesundheits-Dashboard\n      </p>\n    </div>\n  )\n}\n\nexport default DashboardHeader\n","'use client'\n\nimport { Card } from '@/lib/ui'\n\n/**\n * AMY Slot Component\n * \n * Placeholder component for AMY (AI Assistant) integration.\n * Will be wired in E6.6 with actual AMY functionality.\n * Part of E6.5.4 implementation.\n * \n * Features:\n * - Visual placeholder for AMY assistant\n * - Responsive design\n * - Dark mode support\n * - Ready for E6.6 integration\n * \n * @example\n * <AMYSlot />\n */\nexport function AMYSlot() {\n  return (\n    <Card padding=\"lg\" radius=\"lg\">\n      <div className=\"flex items-start gap-4\">\n        <div className=\"w-12 h-12 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center flex-shrink-0\">\n          <span className=\"text-2xl\" role=\"img\" aria-label=\"AMY Assistant\">\n            ü§ñ\n          </span>\n        </div>\n        <div className=\"flex-1\">\n          <h3 className=\"text-lg font-semibold text-slate-900 dark:text-slate-100 mb-2\">\n            AMY - Ihr pers√∂nlicher Assistent\n          </h3>\n          <p className=\"text-sm text-slate-600 dark:text-slate-400\">\n            AMY wird bald verf√ºgbar sein, um Ihnen personalisierte Einblicke und Empfehlungen zu\n            bieten.\n          </p>\n        </div>\n      </div>\n    </Card>\n  )\n}\n\nexport default AMYSlot\n","'use client'\n\nimport { useState } from 'react'\nimport { useRouter } from 'next/navigation'\nimport { Card, Textarea, Button, Alert } from '@/lib/ui'\nimport { getNavigationTarget, isRoutableAction } from '@/lib/triage/router'\nimport { storeTriageResult } from '@/lib/triage/storage'\nimport type { TriageResultV1 } from '@/lib/api/contracts/triage'\nimport { NON_EMERGENCY_DISCLAIMER, STANDARD_EMERGENCY_GUIDANCE } from '@/lib/safety/disclaimers'\n\n/**\n * E6.6.1 + E6.6.5 + E6.6.9 ‚Äî AMY Composer Component\n * \n * Bounded, guided mode for patient-initiated AMY interactions.\n * E6.6.5: Integrates triage router for navigation after triage.\n * E6.6.9: Dev harness with quick-fill test inputs (dev-only).\n * \n * Features:\n * - AC1: Max length enforced client-side (up to 800 chars, recommended 500)\n * - AC2: Single-turn interaction (no chat history)\n * - AC3: Non-emergency disclaimer visible\n * - AC4: Submit triggers triage API call and shows routed result\n * - E6.6.5: Router applies TriageResult ‚Üí Navigation (Dashboard-first)\n * - E6.6.9: Dev UI quick-fill buttons (non-prod only)\n * \n * UX:\n * - Character counter\n * - Loading state during API call\n * - Error state handling\n * - Clear result display with navigation CTA\n * - Optional: Suggested chips for guided input\n * - Dev-only: Quick-fill test inputs for deterministic testing\n */\n\nconst MAX_LENGTH = 800 // AC1: Client-side validation\nconst RECOMMENDED_LENGTH = 500 // Soft recommendation\n\ntype TriageState = 'idle' | 'loading' | 'success' | 'error'\n\n// Optional: Suggested chips for guided input\nconst SUGGESTED_CONCERNS = [\n  'üí§ Schlafprobleme',\n  'üò∞ Stress',\n  'üíì Herzklopfen',\n  'üòü Sorgen',\n]\n\n// E6.6.9: Dev harness - Quick-fill test inputs (deterministic)\n// AC2: Only shown in non-production environments\nconst DEV_QUICK_FILLS = [\n  {\n    label: 'üí¨ Info',\n    text: 'Was ist Stress und wie wirkt er sich auf meine Gesundheit aus?',\n    tier: 'INFO',\n    color: 'green',\n  },\n  {\n    label: 'üìã Assessment',\n    text: 'Ich f√ºhle mich sehr gestresst und ersch√∂pft in letzter Zeit. Es f√§llt mir schwer, mich zu konzentrieren.',\n    tier: 'ASSESSMENT',\n    color: 'amber',\n  },\n  {\n    label: 'üö® Escalate',\n    text: 'Ich habe Suizidgedanken und wei√ü nicht mehr weiter. Alles f√ºhlt sich hoffnungslos an.',\n    tier: 'ESCALATE',\n    color: 'red',\n  },\n] as const\n\n// E6.6.9: Helper to get button styles based on tier color\nconst getQuickFillButtonStyles = (color: 'green' | 'amber' | 'red'): string => {\n  const baseStyles = 'px-3 py-2 text-xs font-medium rounded-md transition-colors disabled:opacity-50 disabled:cursor-not-allowed'\n  \n  const colorStyles = {\n    green: 'bg-green-100 dark:bg-green-900/30 text-green-800 dark:text-green-300 hover:bg-green-200 dark:hover:bg-green-900/50',\n    amber: 'bg-amber-100 dark:bg-amber-900/30 text-amber-800 dark:text-amber-300 hover:bg-amber-200 dark:hover:bg-amber-900/50',\n    red: 'bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-300 hover:bg-red-200 dark:hover:bg-red-900/50',\n  }\n  \n  return `${baseStyles} ${colorStyles[color]}`\n}\n\n// E6.6.9 AC2: Dev harness visibility configuration\n// Set to true only in development/preview environments\n// In production, this should be false to hide dev tools from end users\n// Note: Can be toggled via browser localStorage for testing:\n//   localStorage.setItem('devHarnessEnabled', 'true')\nconst isDevHarnessEnabled = (): boolean => {\n  if (typeof window === 'undefined') {\n    return false // Server-side: disabled\n  }\n  \n  // Check localStorage override first (for testing in deployed environments)\n  // Wrapped in try-catch to handle SecurityError in sandboxed environments\n  try {\n    const storageOverride = localStorage.getItem('devHarnessEnabled')\n    if (storageOverride === 'true') {\n      return true\n    }\n  } catch (error) {\n    // localStorage access failed (sandboxed environment, disabled storage, etc.)\n    // Continue to hostname checks\n    console.debug('[DevHarness] localStorage access failed, using hostname check only', error)\n  }\n  \n  // Check hostname to auto-enable on localhost/preview deployments\n  const hostname = window.location.hostname\n  return (\n    hostname === 'localhost' ||\n    hostname === '127.0.0.1' ||\n    hostname.includes('preview') ||\n    hostname.includes('dev-')\n  )\n}\n\nexport function AMYComposer() {\n  const router = useRouter()\n  const [concern, setConcern] = useState('')\n  const [state, setState] = useState<TriageState>('idle')\n  const [result, setResult] = useState<TriageResultV1 | null>(null)\n  const [error, setError] = useState<string | null>(null)\n  const [showDevHarness, setShowDevHarness] = useState(false)\n\n  const charCount = concern.length\n  const isOverLimit = charCount > MAX_LENGTH\n  const isNearLimit = charCount > RECOMMENDED_LENGTH && charCount <= MAX_LENGTH\n  const canSubmit = concern.trim().length >= 10 && !isOverLimit && state !== 'loading'\n\n  // E6.6.9: Handler for dev quick-fill buttons\n  const handleDevQuickFill = (text: string) => {\n    setConcern(text)\n    setState('idle')\n    setResult(null)\n    setError(null)\n  }\n\n  const handleSubmit = async () => {\n    if (!canSubmit) return\n\n    setState('loading')\n    setError(null)\n    setResult(null)\n\n    try {\n      const response = await fetch('/api/amy/triage', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n        body: JSON.stringify({ concern: concern.trim() }),\n      })\n\n      const data = await response.json()\n\n      if (!response.ok) {\n        throw new Error(data.error || 'Triage request failed')\n      }\n\n      if (data.success && data.data) {\n        const triageResult = data.data as TriageResultV1\n        setResult(triageResult)\n        setState('success')\n\n        // E6.6.5: Store last triage result for rationale/retry\n        storeTriageResult(triageResult)\n      } else {\n        throw new Error('Invalid response format')\n      }\n    } catch (err) {\n      console.error('[AMYComposer] Triage failed', err)\n      setError(err instanceof Error ? err.message : 'Ein unerwarteter Fehler ist aufgetreten.')\n      setState('error')\n    }\n  }\n\n  // E6.6.5: Handle navigation based on triage result\n  const handleNavigate = () => {\n    if (!result) return\n\n    // Validate nextAction is routable\n    if (!isRoutableAction(result.nextAction)) {\n      console.error('[AMYComposer] Invalid nextAction', { nextAction: result.nextAction })\n      setError('Ung√ºltige Triage-Aktion. Bitte versuchen Sie es erneut.')\n      return\n    }\n\n    // Get navigation target from router\n    const { url, description } = getNavigationTarget(result.nextAction, result)\n\n    console.log('[AMYComposer] Navigating to', { url, description, tier: result.tier })\n\n    // Navigate to target\n    router.push(url)\n  }\n\n  const handleChipClick = (chip: string) => {\n    // Extract text after emoji (emojis are typically 1-2 chars at start)\n    // This preserves German characters (√§, √∂, √º, √ü)\n    const text = chip.slice(2).trim() // Remove emoji and leading space\n    if (concern) {\n      setConcern(concern + ', ' + text)\n    } else {\n      setConcern(text)\n    }\n  }\n\n  const handleReset = () => {\n    setConcern('')\n    setState('idle')\n    setResult(null)\n    setError(null)\n  }\n\n  return (\n    <Card padding=\"lg\" radius=\"lg\">\n      <div className=\"space-y-4\">\n        {/* Header with AMY branding */}\n        <div className=\"flex items-start gap-4\">\n          <div className=\"w-12 h-12 rounded-full bg-gradient-to-br from-purple-500 to-pink-500 flex items-center justify-center flex-shrink-0\">\n            <span className=\"text-2xl\" role=\"img\" aria-label=\"AMY Assistant\">\n              ü§ñ\n            </span>\n          </div>\n          <div className=\"flex-1\">\n            <h3 className=\"text-lg font-semibold text-slate-900 dark:text-slate-100 mb-1\">\n              AMY - Ihr pers√∂nlicher Assistent\n            </h3>\n            <p className=\"text-sm text-slate-600 dark:text-slate-400\">\n              Beschreiben Sie Ihr Anliegen in 1‚Äì2 S√§tzen\n            </p>\n          </div>\n        </div>\n\n        {/* AC3: Non-emergency disclaimer - E6.6.8: Use centralized disclaimer */}\n        <Alert variant=\"info\">\n          <p className=\"text-sm\">\n            <strong>{NON_EMERGENCY_DISCLAIMER.title}:</strong> {NON_EMERGENCY_DISCLAIMER.text}\n          </p>\n        </Alert>\n\n        {/* E6.6.9: Dev Harness - Quick-fill test inputs (AC2: dev-only) */}\n        {isDevHarnessEnabled() && (\n          <div className=\"border-2 border-dashed border-purple-300 dark:border-purple-700 rounded-lg p-4 bg-purple-50 dark:bg-purple-950/20\">\n            <div className=\"flex items-center justify-between mb-3\">\n              <div className=\"flex items-center gap-2\">\n                <span className=\"text-lg\" role=\"img\" aria-label=\"Developer\">\n                  üë®‚Äçüíª\n                </span>\n                <h4 className=\"text-sm font-semibold text-purple-900 dark:text-purple-300\">\n                  Dev Harness - Test Inputs\n                </h4>\n              </div>\n              <button\n                type=\"button\"\n                onClick={() => setShowDevHarness(!showDevHarness)}\n                className=\"text-xs px-2 py-1 rounded bg-purple-200 dark:bg-purple-800 text-purple-900 dark:text-purple-300 hover:bg-purple-300 dark:hover:bg-purple-700 transition-colors\"\n              >\n                {showDevHarness ? 'Hide' : 'Show'}\n              </button>\n            </div>\n            \n            {showDevHarness && (\n              <div className=\"space-y-2\">\n                <p className=\"text-xs text-purple-700 dark:text-purple-400 mb-2\">\n                  Deterministic test inputs for all router paths (INFO/ASSESSMENT/ESCALATE)\n                </p>\n                <div className=\"flex flex-wrap gap-2\">\n                  {DEV_QUICK_FILLS.map((fill) => (\n                    <button\n                      key={fill.label}\n                      type=\"button\"\n                      onClick={() => handleDevQuickFill(fill.text)}\n                      disabled={state === 'loading'}\n                      className={getQuickFillButtonStyles(fill.color)}\n                    >\n                      {fill.label}\n                    </button>\n                  ))}\n                </div>\n                <p className=\"text-xs text-purple-600 dark:text-purple-400 mt-2\">\n                  ‚ö†Ô∏è Dev-only feature. Hidden in production.\n                </p>\n              </div>\n            )}\n          </div>\n        )}\n\n        {/* Show input form when idle/loading/error */}\n        {(state === 'idle' || state === 'loading' || state === 'error') && (\n          <>\n            {/* Optional: Suggested chips */}\n            <div className=\"flex flex-wrap gap-2\">\n              {SUGGESTED_CONCERNS.map((chip) => (\n                <button\n                  key={chip}\n                  type=\"button\"\n                  onClick={() => handleChipClick(chip)}\n                  disabled={state === 'loading'}\n                  className=\"px-3 py-1.5 text-sm rounded-full bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 hover:bg-slate-200 dark:hover:bg-slate-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed\"\n                >\n                  {chip}\n                </button>\n              ))}\n            </div>\n\n            {/* Textarea with character counter */}\n            <div className=\"space-y-2\">\n              <Textarea\n                value={concern}\n                onChange={(e) => setConcern(e.target.value)}\n                placeholder=\"z.B. Ich habe in letzter Zeit Schlafprobleme und f√ºhle mich gestresst...\"\n                rows={4}\n                disabled={state === 'loading'}\n                error={isOverLimit}\n                errorMessage={\n                  isOverLimit ? `Maximal ${MAX_LENGTH} Zeichen erlaubt` : undefined\n                }\n                helperText={\n                  !isOverLimit && isNearLimit\n                    ? `Empfohlen: bis zu ${RECOMMENDED_LENGTH} Zeichen`\n                    : undefined\n                }\n                maxLength={MAX_LENGTH + 50} // Allow typing a bit over to show error\n              />\n              <div className=\"flex justify-between items-center text-sm\">\n                <span\n                  className={`${\n                    isOverLimit\n                      ? 'text-red-600 dark:text-red-400 font-medium'\n                      : isNearLimit\n                        ? 'text-amber-600 dark:text-amber-400'\n                        : 'text-slate-500 dark:text-slate-400'\n                  }`}\n                >\n                  {charCount} / {MAX_LENGTH} Zeichen\n                </span>\n                {concern.trim().length < 10 && concern.trim().length > 0 && (\n                  <span className=\"text-slate-500 dark:text-slate-400 text-xs\">\n                    Mindestens 10 Zeichen erforderlich\n                  </span>\n                )}\n              </div>\n            </div>\n\n            {/* Error display */}\n            {error && (\n              <Alert variant=\"error\">\n                <p className=\"text-sm\">{error}</p>\n              </Alert>\n            )}\n\n            {/* Submit button */}\n            <Button\n              variant=\"primary\"\n              fullWidth\n              onClick={handleSubmit}\n              disabled={!canSubmit}\n              loading={state === 'loading'}\n            >\n              {state === 'loading' ? 'Wird analysiert...' : 'Anliegen einreichen'}\n            </Button>\n          </>\n        )}\n\n        {/* Show result when successful */}\n        {state === 'success' && result && (\n          <div className=\"space-y-4\">\n            {/* Tier badge - E6.6.5: Use v1 tier format */}\n            <div className=\"flex items-center gap-2\">\n              <span\n                className={`inline-flex items-center px-3 py-1 rounded-full text-sm font-medium ${\n                  result.tier === 'ESCALATE'\n                    ? 'bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-300'\n                    : result.tier === 'ASSESSMENT'\n                      ? 'bg-amber-100 text-amber-800 dark:bg-amber-900/30 dark:text-amber-300'\n                      : 'bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300'\n                }`}\n              >\n                {result.tier === 'ESCALATE'\n                  ? 'üö® Dringend'\n                  : result.tier === 'ASSESSMENT'\n                    ? 'üìã Einsch√§tzung empfohlen'\n                    : '‚úÖ Information'}\n              </span>\n            </div>\n\n            {/* Rationale - E6.6.5: Show rationale from v1 result */}\n            <div className=\"prose prose-sm dark:prose-invert max-w-none\">\n              <p className=\"text-slate-700 dark:text-slate-300 leading-relaxed\">\n                {result.rationale}\n              </p>\n            </div>\n\n            {/* E6.6.5: Navigation CTA based on nextAction */}\n            <div className=\"space-y-3\">\n              <Button variant=\"primary\" fullWidth onClick={handleNavigate}>\n                {result.nextAction === 'SHOW_CONTENT' && 'üìö Inhalte ansehen'}\n                {result.nextAction === 'START_FUNNEL_A' && 'üìã Fragebogen starten'}\n                {result.nextAction === 'START_FUNNEL_B' && 'üí§ Schlaf-Assessment starten'}\n                {result.nextAction === 'RESUME_FUNNEL' && '‚ñ∂Ô∏è Fragebogen fortsetzen'}\n                {result.nextAction === 'SHOW_ESCALATION' && 'üÜò Unterst√ºtzung erhalten'}\n              </Button>\n\n              {/* Secondary action: Try again */}\n              <Button variant=\"secondary\" fullWidth onClick={handleReset}>\n                Neues Anliegen eingeben\n              </Button>\n            </div>\n\n            {/* Escalation warning for urgent cases - E6.6.8: Use centralized guidance */}\n            {result.tier === 'ESCALATE' && (\n              <Alert variant=\"error\">\n                <p className=\"text-sm font-medium\">\n                  <strong>{STANDARD_EMERGENCY_GUIDANCE.title}:</strong>{' '}\n                  {STANDARD_EMERGENCY_GUIDANCE.text}\n                </p>\n              </Alert>\n            )}\n          </div>\n        )}\n      </div>\n    </Card>\n  )\n}\n\nexport default AMYComposer\n","/**\n * Triage API Contracts - E6.6.2\n *\n * Versioned schemas for AMY triage endpoints.\n * Stable, testable, governance-ready contracts with strict validation.\n *\n * @module lib/api/contracts/triage\n */\n\nimport { z } from 'zod'\n\n// ============================================================\n// Schema Version\n// ============================================================\n\n/**\n * Current schema version for triage contracts\n */\nexport const TRIAGE_SCHEMA_VERSION = 'v1' as const\n\n// ============================================================\n// Constants & Enums\n// ============================================================\n\n/**\n * Triage tier levels\n */\nexport const TRIAGE_TIER = {\n  INFO: 'INFO',\n  ASSESSMENT: 'ASSESSMENT',\n  ESCALATE: 'ESCALATE',\n} as const\n\nexport type TriageTier = typeof TRIAGE_TIER[keyof typeof TRIAGE_TIER]\n\n/**\n * Next action after triage\n */\nexport const TRIAGE_NEXT_ACTION = {\n  SHOW_CONTENT: 'SHOW_CONTENT',\n  START_FUNNEL_A: 'START_FUNNEL_A',\n  START_FUNNEL_B: 'START_FUNNEL_B',\n  RESUME_FUNNEL: 'RESUME_FUNNEL',\n  SHOW_ESCALATION: 'SHOW_ESCALATION',\n} as const\n\nexport type TriageNextAction = typeof TRIAGE_NEXT_ACTION[keyof typeof TRIAGE_NEXT_ACTION]\n\n/**\n * Red flag allowlist - only these values are permitted\n * Based on existing escalation types in lib/types/escalation.ts\n */\nexport const RED_FLAG_ALLOWLIST = [\n  'report_risk_level',\n  'workup_check',\n  'answer_pattern',\n] as const satisfies readonly string[]\n\nexport type RedFlagType = typeof RED_FLAG_ALLOWLIST[number]\n\n/**\n * Age range buckets for patient context (no PHI)\n */\nexport const AGE_RANGE_BUCKET = {\n  UNDER_18: 'UNDER_18',\n  AGE_18_30: 'AGE_18_30',\n  AGE_31_50: 'AGE_31_50',\n  AGE_51_65: 'AGE_51_65',\n  OVER_65: 'OVER_65',\n} as const\n\nexport type AgeRangeBucket = typeof AGE_RANGE_BUCKET[keyof typeof AGE_RANGE_BUCKET]\n\n// ============================================================\n// Input Validation Constants\n// ============================================================\n\nexport const TRIAGE_INPUT_MIN_LENGTH = 10\nexport const TRIAGE_INPUT_MAX_LENGTH = 800\nexport const TRIAGE_INPUT_VERY_LARGE_THRESHOLD = TRIAGE_INPUT_MAX_LENGTH * 2 // 1600 chars\nexport const TRIAGE_RATIONALE_MAX_LENGTH = 280\nexport const TRIAGE_RATIONALE_MAX_BULLETS = 3\n\n// ============================================================\n// Request Schema - TriageRequestV1\n// ============================================================\n\n/**\n * Optional patient context (anonymized, no PHI)\n */\nexport const PatientContextLiteSchema = z.object({\n  ageRange: z.enum([\n    AGE_RANGE_BUCKET.UNDER_18,\n    AGE_RANGE_BUCKET.AGE_18_30,\n    AGE_RANGE_BUCKET.AGE_31_50,\n    AGE_RANGE_BUCKET.AGE_51_65,\n    AGE_RANGE_BUCKET.OVER_65,\n  ]).optional(),\n}).optional()\n\nexport type PatientContextLite = z.infer<typeof PatientContextLiteSchema>\n\n/**\n * Triage Request V1 Schema\n *\n * AC2: Input is bounded and validated\n */\nexport const TriageRequestV1Schema = z.object({\n  inputText: z.string()\n    .min(TRIAGE_INPUT_MIN_LENGTH, `Input must be at least ${TRIAGE_INPUT_MIN_LENGTH} characters`)\n    .max(TRIAGE_INPUT_MAX_LENGTH, `Input must not exceed ${TRIAGE_INPUT_MAX_LENGTH} characters`),\n  locale: z.string().optional(),\n  patientContext: PatientContextLiteSchema,\n})\n\nexport type TriageRequestV1 = z.infer<typeof TriageRequestV1Schema>\n\n// ============================================================\n// Response Schema - TriageResultV1\n// ============================================================\n\n/**\n * Confidence band (optional, for future AI transparency)\n */\nexport const ConfidenceBandSchema = z.object({\n  value: z.number().min(0).max(1),\n  label: z.enum(['low', 'medium', 'high']).optional(),\n}).optional()\n\nexport type ConfidenceBand = z.infer<typeof ConfidenceBandSchema>\n\n/**\n * Custom validation for rationale:\n * - Must be ‚â§280 characters OR\n * - Must be bullet list with max 3 items\n */\nfunction validateRationale(rationale: string): boolean {\n  // Check if it's a bullet list first\n  const bulletPattern = /^[\\s]*[-*‚Ä¢]\\s+/\n  const lines = rationale.split('\\n').filter(line => line.trim().length > 0)\n  const bulletLines = lines.filter(line => bulletPattern.test(line))\n  \n  if (bulletLines.length > 0) {\n    // It's a bullet list - check max 3 bullets\n    if (bulletLines.length > TRIAGE_RATIONALE_MAX_BULLETS) {\n      return false\n    }\n    // Bullet list with ‚â§3 items is always valid regardless of length\n    return true\n  }\n\n  // Not a bullet list - check simple length bound\n  return rationale.length <= TRIAGE_RATIONALE_MAX_LENGTH\n}\n\n/**\n * Triage Result V1 Schema\n *\n * AC1: Strict schema validation with Zod\n * AC3: rationale hard-bounded, redFlags from allowlist only\n */\nexport const TriageResultV1Schema = z.object({\n  tier: z.enum([\n    TRIAGE_TIER.INFO,\n    TRIAGE_TIER.ASSESSMENT,\n    TRIAGE_TIER.ESCALATE,\n  ]),\n  nextAction: z.enum([\n    TRIAGE_NEXT_ACTION.SHOW_CONTENT,\n    TRIAGE_NEXT_ACTION.START_FUNNEL_A,\n    TRIAGE_NEXT_ACTION.START_FUNNEL_B,\n    TRIAGE_NEXT_ACTION.RESUME_FUNNEL,\n    TRIAGE_NEXT_ACTION.SHOW_ESCALATION,\n  ]),\n  redFlags: z.array(z.string()).refine(\n    (flags) => flags.every(flag => RED_FLAG_ALLOWLIST.includes(flag as RedFlagType)),\n    { message: 'All red flags must be from the allowlist' }\n  ).default([]),\n  rationale: z.string()\n    .refine(validateRationale, {\n      message: `Rationale must be ‚â§${TRIAGE_RATIONALE_MAX_LENGTH} chars or bullet list with max ${TRIAGE_RATIONALE_MAX_BULLETS} items`,\n    }),\n  confidenceBand: ConfidenceBandSchema,\n  version: z.literal(TRIAGE_SCHEMA_VERSION),\n  correlationId: z.string().optional(),\n})\n\nexport type TriageResultV1 = z.infer<typeof TriageResultV1Schema>\n\n// ============================================================\n// API Response Schemas\n// ============================================================\n\n/**\n * Success response\n */\nexport const TriageSuccessResponseSchema = z.object({\n  success: z.literal(true),\n  data: TriageResultV1Schema,\n})\n\nexport type TriageSuccessResponse = z.infer<typeof TriageSuccessResponseSchema>\n\n/**\n * Error response\n */\nexport const TriageErrorResponseSchema = z.object({\n  success: z.literal(false),\n  error: z.object({\n    code: z.string(),\n    message: z.string(),\n    details: z.record(z.string(), z.unknown()).optional(),\n  }),\n})\n\nexport type TriageErrorResponse = z.infer<typeof TriageErrorResponseSchema>\n\n/**\n * Combined response type\n */\nexport const TriageResponseSchema = z.union([\n  TriageSuccessResponseSchema,\n  TriageErrorResponseSchema,\n])\n\nexport type TriageResponse = z.infer<typeof TriageResponseSchema>\n\n// ============================================================\n// Helper Functions\n// ============================================================\n\n/**\n * Validate triage request (throws on error)\n */\nexport function validateTriageRequest(data: unknown): TriageRequestV1 {\n  return TriageRequestV1Schema.parse(data)\n}\n\n/**\n * Safely validate triage request (returns null on error)\n */\nexport function safeValidateTriageRequest(data: unknown): TriageRequestV1 | null {\n  const result = TriageRequestV1Schema.safeParse(data)\n  return result.success ? result.data : null\n}\n\n/**\n * Validate triage result (throws on error)\n */\nexport function validateTriageResult(data: unknown): TriageResultV1 {\n  return TriageResultV1Schema.parse(data)\n}\n\n/**\n * Safely validate triage result (returns null on error)\n */\nexport function safeValidateTriageResult(data: unknown): TriageResultV1 | null {\n  const result = TriageResultV1Schema.safeParse(data)\n  return result.success ? result.data : null\n}\n\n/**\n * Sanitize red flags to only allowlist values\n * AC3: Unknown redFlags are filtered out\n */\nexport function sanitizeRedFlags(redFlags: string[]): RedFlagType[] {\n  return redFlags.filter((flag): flag is RedFlagType =>\n    RED_FLAG_ALLOWLIST.includes(flag as RedFlagType)\n  )\n}\n\n/**\n * Check if input size would trigger 413 or 400\n * AC2: Oversize returns 413 or 400\n */\nexport function getOversizeErrorStatus(inputText: string): 400 | 413 | null {\n  if (inputText.length > TRIAGE_INPUT_MAX_LENGTH) {\n    // Very large inputs get 413 (Request Entity Too Large)\n    // Moderately over limit gets 400 (Bad Request)\n    return inputText.length > TRIAGE_INPUT_VERY_LARGE_THRESHOLD ? 413 : 400\n  }\n  return null\n}\n\n/**\n * Create a bounded rationale (truncate or limit bullets)\n */\nexport function boundRationale(rationale: string): string {\n  // Check if it's already valid\n  if (validateRationale(rationale)) {\n    return rationale\n  }\n\n  // Check if it's a bullet list\n  const bulletPattern = /^[\\s]*[-*‚Ä¢]\\s+/\n  const lines = rationale.split('\\n')\n  const bulletLines = lines.filter(line => bulletPattern.test(line))\n\n  if (bulletLines.length > TRIAGE_RATIONALE_MAX_BULLETS) {\n    // Take first N bullets and reconstruct with original line breaks preserved\n    let bulletCount = 0\n    const boundedLines: string[] = []\n    \n    for (const line of lines) {\n      if (bulletPattern.test(line)) {\n        if (bulletCount >= TRIAGE_RATIONALE_MAX_BULLETS) {\n          break\n        }\n        bulletCount++\n      }\n      boundedLines.push(line)\n    }\n    \n    return boundedLines.join('\\n').trim()\n  }\n\n  // Simple truncation to max length\n  if (rationale.length > TRIAGE_RATIONALE_MAX_LENGTH) {\n    return rationale.slice(0, TRIAGE_RATIONALE_MAX_LENGTH - 3) + '...'\n  }\n\n  return rationale\n}\n","/**\n * E6.6.5 ‚Äî Triage Router\n *\n * Maps TriageResultV1.nextAction to concrete navigation routes.\n * This is the \"product logic\" that converts triage decisions into user journeys.\n *\n * Key Principles:\n * - AC1: Each nextAction maps to exactly one route (deterministic)\n * - AC2: Router actions are pure functions (testable)\n * - AC3: Navigation always initiated from dashboard\n *\n * @module lib/triage/router\n */\n\nimport type { TriageResultV1, TriageNextAction } from '@/lib/api/contracts/triage'\nimport { TRIAGE_NEXT_ACTION } from '@/lib/api/contracts/triage'\n\n/**\n * Route destination for triage result\n */\nexport type TriageRoute = {\n  /** Target URL to navigate to */\n  path: string\n  /** Optional query parameters */\n  query?: Record<string, string>\n  /** Optional state to pass (for highlighting, etc.) */\n  state?: Record<string, unknown>\n  /** Human-readable description for logging/debugging */\n  description: string\n}\n\n/**\n * Maps TriageNextAction to a concrete route\n *\n * AC1: Each nextAction has exactly one deterministic mapping\n * AC2: Pure function - same input ‚Üí same output\n *\n * @param nextAction - The triage decision\n * @param triageResult - Full triage result for context (e.g., rationale, tier)\n * @returns TriageRoute with path, query, state, and description\n */\nexport function mapNextActionToRoute(\n  nextAction: TriageNextAction,\n  triageResult: TriageResultV1,\n): TriageRoute {\n  switch (nextAction) {\n    case TRIAGE_NEXT_ACTION.SHOW_CONTENT:\n      // Navigate to content tiles section, optionally highlight first tile\n      return {\n        path: '/patient/dashboard',\n        query: {\n          scrollTo: 'content',\n        },\n        state: {\n          highlightContent: true,\n          triageTier: triageResult.tier,\n        },\n        description: 'Show content tiles (INFO tier)',\n      }\n\n    case TRIAGE_NEXT_ACTION.START_FUNNEL_A:\n      // Navigate to stress/resilience funnel\n      return {\n        path: '/patient/funnel/stress-resilience',\n        query: {\n          source: 'triage',\n        },\n        state: {\n          triageRationale: triageResult.rationale,\n          triageTier: triageResult.tier,\n        },\n        description: 'Start Stress & Resilience Assessment (Funnel A)',\n      }\n\n    case TRIAGE_NEXT_ACTION.START_FUNNEL_B:\n      // Navigate to sleep funnel (if implemented)\n      return {\n        path: '/patient/funnel/sleep',\n        query: {\n          source: 'triage',\n        },\n        state: {\n          triageRationale: triageResult.rationale,\n          triageTier: triageResult.tier,\n        },\n        description: 'Start Sleep Assessment (Funnel B)',\n      }\n\n    case TRIAGE_NEXT_ACTION.RESUME_FUNNEL:\n      // Navigate to dashboard with instruction to resume\n      // Dashboard will show \"Next Step\" card with resume CTA\n      return {\n        path: '/patient/dashboard',\n        query: {\n          action: 'resume',\n        },\n        state: {\n          triageRationale: triageResult.rationale,\n        },\n        description: 'Resume existing funnel from dashboard',\n      }\n\n    case TRIAGE_NEXT_ACTION.SHOW_ESCALATION:\n      // Navigate to escalation/support page\n      return {\n        path: '/patient/support',\n        query: {\n          source: 'triage',\n          tier: triageResult.tier,\n        },\n        state: {\n          triageRationale: triageResult.rationale,\n          redFlags: triageResult.redFlags,\n          urgent: true,\n        },\n        description: 'Show escalation support (ESCALATE tier)',\n      }\n\n    default:\n      // Fallback to dashboard (should never happen with proper typing)\n      console.warn('[TriageRouter] Unknown nextAction, falling back to dashboard', {\n        nextAction,\n      })\n      return {\n        path: '/patient/dashboard',\n        query: {},\n        state: {},\n        description: 'Fallback to dashboard (unknown action)',\n      }\n  }\n}\n\n/**\n * Builds a complete URL from a TriageRoute\n *\n * @param route - The route object\n * @returns Full URL string ready for navigation\n *\n * @example\n * const route = mapNextActionToRoute('SHOW_CONTENT', triageResult)\n * const url = buildRouteUrl(route)\n * // ‚Üí '/patient/dashboard?scrollTo=content'\n */\nexport function buildRouteUrl(route: TriageRoute): string {\n  const { path, query } = route\n\n  if (!query || Object.keys(query).length === 0) {\n    return path\n  }\n\n  const queryString = new URLSearchParams(query).toString()\n  return `${path}?${queryString}`\n}\n\n/**\n * Navigate to a route from triage result\n * AC3: Navigation always initiated from dashboard\n *\n * This is a helper that combines mapping + URL building.\n * The actual router.push() call should be done by the caller (AMYComposer).\n *\n * @param nextAction - The triage decision\n * @param triageResult - Full triage result\n * @returns Object with url and state for navigation\n *\n * @example\n * const { url, state } = getNavigationTarget('START_FUNNEL_A', triageResult)\n * router.push(url, { state })\n */\nexport function getNavigationTarget(\n  nextAction: TriageNextAction,\n  triageResult: TriageResultV1,\n): { url: string; state: Record<string, unknown>; description: string } {\n  const route = mapNextActionToRoute(nextAction, triageResult)\n  const url = buildRouteUrl(route)\n\n  return {\n    url,\n    state: route.state || {},\n    description: route.description,\n  }\n}\n\n/**\n * Validates that a nextAction is routable\n *\n * @param nextAction - Action to validate\n * @returns true if action is valid and routable\n */\nexport function isRoutableAction(nextAction: string): nextAction is TriageNextAction {\n  return Object.values(TRIAGE_NEXT_ACTION).includes(nextAction as TriageNextAction)\n}\n","/**\n * E6.6.5 ‚Äî Triage Storage Helper\n *\n * Utility for storing and retrieving triage results from sessionStorage.\n * Supports retry/rationale display and debugging.\n *\n * @module lib/triage/storage\n */\n\nimport { safeValidateTriageResult, type TriageResultV1 } from '@/lib/api/contracts/triage'\n\n/**\n * Storage key for last triage result\n */\nconst STORAGE_KEY = 'lastTriageResult'\n\n/**\n * Stores a triage result in sessionStorage\n * E6.6.5: Store last result for rationale/retry\n *\n * @param result - The triage result to store\n * @returns true if stored successfully, false otherwise\n */\nexport function storeTriageResult(result: TriageResultV1): boolean {\n  if (typeof window === 'undefined' || !window.sessionStorage) {\n    console.warn('[TriageStorage] sessionStorage not available')\n    return false\n  }\n\n  try {\n    const serialized = JSON.stringify(result)\n    window.sessionStorage.setItem(STORAGE_KEY, serialized)\n    return true\n  } catch (error) {\n    console.error('[TriageStorage] Failed to store triage result', error)\n    return false\n  }\n}\n\n/**\n * Retrieves the last triage result from sessionStorage\n *\n * @returns The last triage result, or null if not found or invalid\n */\nexport function getLastTriageResult(): TriageResultV1 | null {\n  if (typeof window === 'undefined' || !window.sessionStorage) {\n    return null\n  }\n\n  try {\n    const serialized = window.sessionStorage.getItem(STORAGE_KEY)\n    \n    if (!serialized) {\n      return null\n    }\n\n    const parsed = JSON.parse(serialized)\n    \n    // Validate that it's a proper TriageResultV1\n    const validated = safeValidateTriageResult(parsed)\n    \n    if (!validated) {\n      console.warn('[TriageStorage] Stored result failed validation, clearing')\n      clearTriageResult()\n      return null\n    }\n\n    return validated\n  } catch (error) {\n    console.error('[TriageStorage] Failed to retrieve triage result', error)\n    clearTriageResult()\n    return null\n  }\n}\n\n/**\n * Clears the stored triage result\n * \n * @returns void\n */\nexport function clearTriageResult(): void {\n  if (typeof window === 'undefined' || !window.sessionStorage) {\n    return\n  }\n\n  try {\n    window.sessionStorage.removeItem(STORAGE_KEY)\n  } catch (error) {\n    console.error('[TriageStorage] Failed to clear triage result', error)\n  }\n}\n\n/**\n * Checks if a triage result is stored\n *\n * @returns true if a valid triage result is stored\n */\nexport function hasStoredTriageResult(): boolean {\n  return getLastTriageResult() !== null\n}\n","'use client'\n\nimport { Card } from '@/lib/ui'\nimport type { NextStep } from '@/lib/api/contracts/patient/dashboard'\n\nexport interface NextStepCardProps {\n  /** Next step data from dashboard API */\n  nextStep: NextStep\n  /** Callback when CTA is clicked */\n  onAction?: () => void\n}\n\n/**\n * Next Step Card Component\n * \n * Displays the next action for the patient to take.\n * Part of E6.5.4 implementation.\n * \n * Features:\n * - Always visible when nextStep is available (AC3)\n * - Visual prominence with icon\n * - Responsive design\n * - Dark mode support\n * - CTA button for action\n * \n * @example\n * <NextStepCard\n *   nextStep={{\n *     type: 'funnel',\n *     target: '/patient/funnel/stress',\n *     label: 'Continue Stress Assessment'\n *   }}\n *   onAction={handleAction}\n * />\n */\nexport function NextStepCard({ nextStep, onAction }: NextStepCardProps) {\n  // Don't render if type is 'none'\n  if (nextStep.type === 'none') {\n    return null\n  }\n\n  // Icon mapping based on next step type\n  const iconMap = {\n    onboarding: 'üìã',\n    funnel: 'üéØ',\n    result: 'üìä',\n    content: 'üìñ',\n    none: '',\n  }\n\n  const icon = iconMap[nextStep.type]\n\n  return (\n    <Card padding=\"lg\" radius=\"lg\" className=\"border-2 border-sky-200 dark:border-sky-800\">\n      <div className=\"space-y-4\">\n        <div className=\"flex items-center gap-3\">\n          <div className=\"w-12 h-12 rounded-full bg-sky-100 dark:bg-sky-900/30 flex items-center justify-center flex-shrink-0\">\n            <span className=\"text-2xl\" role=\"img\" aria-label=\"Next step\">\n              {icon}\n            </span>\n          </div>\n          <div className=\"flex-1\">\n            <h2 className=\"text-xl font-semibold text-slate-900 dark:text-slate-100\">\n              N√§chster Schritt\n            </h2>\n            <p className=\"text-sm text-slate-600 dark:text-slate-400\">{nextStep.label}</p>\n          </div>\n        </div>\n\n        {nextStep.target && (\n          <button\n            onClick={onAction}\n            className=\"w-full px-6 py-3 bg-sky-600 hover:bg-sky-700 text-white font-medium rounded-lg transition-colors duration-200\"\n          >\n            {nextStep.label}\n          </button>\n        )}\n      </div>\n    </Card>\n  )\n}\n\nexport default NextStepCard\n","'use client'\n\nimport { Card } from '@/lib/ui'\nimport type { ContentTile } from '@/lib/api/contracts/patient/dashboard'\n\nexport interface ContentTilesGridProps {\n  /** Array of content tiles from dashboard API */\n  tiles: ContentTile[]\n  /** Callback when a tile is clicked */\n  onTileClick?: (tile: ContentTile) => void\n}\n\n/**\n * Content Tiles Grid Component\n * \n * Displays a grid of content tiles for the patient.\n * Part of E6.5.4 implementation.\n * \n * Features:\n * - Responsive grid layout\n * - Empty state handling\n * - Interactive tiles with hover effects\n * - Dark mode support\n * - Sorted by priority\n * \n * @example\n * <ContentTilesGrid\n *   tiles={[\n *     { id: '1', type: 'info', title: 'Health Tips', ... }\n *   ]}\n *   onTileClick={handleTileClick}\n * />\n */\nexport function ContentTilesGrid({ tiles, onTileClick }: ContentTilesGridProps) {\n  // Sort tiles by priority (higher priority first)\n  const sortedTiles = [...tiles].sort((a, b) => b.priority - a.priority)\n\n  // Icon mapping based on tile type\n  const iconMap = {\n    info: 'üí°',\n    action: '‚ö°',\n    promotion: 'üéÅ',\n  }\n\n  // Empty state\n  if (tiles.length === 0) {\n    return (\n      <div className=\"text-center py-8\">\n        <div className=\"text-4xl mb-3\">üìö</div>\n        <h3 className=\"text-lg font-medium text-slate-900 dark:text-slate-100 mb-2\">\n          Noch keine Inhalte verf√ºgbar\n        </h3>\n        <p className=\"text-sm text-slate-600 dark:text-slate-400\">\n          Neue Inhalte werden bald hinzugef√ºgt.\n        </p>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"space-y-3\">\n      <h3 className=\"text-lg font-semibold text-slate-900 dark:text-slate-100\">\n        Empfohlene Inhalte\n      </h3>\n      <div className=\"grid gap-4 sm:grid-cols-2 lg:grid-cols-3\">\n        {sortedTiles.map((tile) => (\n          <Card\n            key={tile.id}\n            padding=\"md\"\n            radius=\"lg\"\n            interactive={!!tile.actionTarget}\n            onClick={() => {\n              if (tile.actionTarget && onTileClick) {\n                onTileClick(tile)\n              }\n            }}\n          >\n            <div className=\"space-y-3\">\n              <div className=\"flex items-start gap-3\">\n                <span className=\"text-2xl flex-shrink-0\" role=\"img\" aria-label={tile.type}>\n                  {iconMap[tile.type]}\n                </span>\n                <div className=\"flex-1 min-w-0\">\n                  <h4 className=\"font-medium text-slate-900 dark:text-slate-100 mb-1 truncate\">\n                    {tile.title}\n                  </h4>\n                  {tile.description && (\n                    <p className=\"text-sm text-slate-600 dark:text-slate-400 line-clamp-2\">\n                      {tile.description}\n                    </p>\n                  )}\n                </div>\n              </div>\n              {tile.actionLabel && tile.actionTarget && (\n                <div className=\"pt-2 border-t border-slate-200 dark:border-slate-700\">\n                  <span className=\"text-sm text-sky-600 dark:text-sky-400 font-medium\">\n                    {tile.actionLabel} ‚Üí\n                  </span>\n                </div>\n              )}\n            </div>\n          </Card>\n        ))}\n      </div>\n    </div>\n  )\n}\n\nexport default ContentTilesGrid\n","'use client'\n\nimport { Card, Badge, Progress } from '@/lib/ui'\nimport type { FunnelSummary, WorkupSummary } from '@/lib/api/contracts/patient/dashboard'\n\nexport interface ProgressSummaryProps {\n  /** Array of funnel summaries from dashboard API */\n  funnelSummaries: FunnelSummary[]\n  /** Workup summary from dashboard API */\n  workupSummary: WorkupSummary\n  /** Callback when a funnel is clicked */\n  onFunnelClick?: (funnel: FunnelSummary) => void\n}\n\n/**\n * Progress Summary Component\n * \n * Displays patient's progress across funnels and workup status.\n * Part of E6.5.4 implementation.\n * \n * Features:\n * - Funnel progress visualization\n * - Workup status summary\n * - Empty state handling\n * - Responsive design\n * - Dark mode support\n * - Interactive funnel cards\n * \n * @example\n * <ProgressSummary\n *   funnelSummaries={[...]}\n *   workupSummary={{ state: 'no_data', counts: {...} }}\n *   onFunnelClick={handleFunnelClick}\n * />\n */\nexport function ProgressSummary({\n  funnelSummaries,\n  workupSummary,\n  onFunnelClick,\n}: ProgressSummaryProps) {\n  // Status badge mapping\n  const statusVariants = {\n    not_started: 'default' as const,\n    in_progress: 'warning' as const,\n    completed: 'success' as const,\n  }\n\n  const statusLabels = {\n    not_started: 'Nicht begonnen',\n    in_progress: 'In Bearbeitung',\n    completed: 'Abgeschlossen',\n  }\n\n  // Workup state mapping\n  const workupStateLabels = {\n    no_data: 'Keine Daten',\n    needs_more_data: 'Weitere Daten erforderlich',\n    ready_for_review: 'Bereit zur √úberpr√ºfung',\n  }\n\n  const workupStateColors = {\n    no_data: 'text-slate-600 dark:text-slate-400',\n    needs_more_data: 'text-amber-600 dark:text-amber-400',\n    ready_for_review: 'text-green-600 dark:text-green-400',\n  }\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Funnel Progress Section */}\n      <div className=\"space-y-3\">\n        <h3 className=\"text-lg font-semibold text-slate-900 dark:text-slate-100\">\n          Ihre Assessments\n        </h3>\n\n        {funnelSummaries.length === 0 ? (\n          <Card padding=\"lg\" radius=\"lg\">\n            <div className=\"text-center py-6\">\n              <div className=\"text-4xl mb-3\">üìã</div>\n              <h4 className=\"text-base font-medium text-slate-900 dark:text-slate-100 mb-2\">\n                Noch keine Assessments\n              </h4>\n              <p className=\"text-sm text-slate-600 dark:text-slate-400\">\n                Starten Sie Ihr erstes Assessment, um Ihren Fortschritt zu verfolgen.\n              </p>\n            </div>\n          </Card>\n        ) : (\n          <div className=\"space-y-3\">\n            {funnelSummaries.map((funnel) => (\n              <Card\n                key={funnel.slug}\n                padding=\"md\"\n                radius=\"lg\"\n                interactive={funnel.status === 'in_progress'}\n                onClick={() => {\n                  if (funnel.status === 'in_progress' && onFunnelClick) {\n                    onFunnelClick(funnel)\n                  }\n                }}\n              >\n                <div className=\"space-y-3\">\n                  <div className=\"flex items-start justify-between gap-3\">\n                    <div className=\"flex-1 min-w-0\">\n                      <h4 className=\"font-medium text-slate-900 dark:text-slate-100 mb-1\">\n                        {funnel.title}\n                      </h4>\n                      {funnel.description && (\n                        <p className=\"text-sm text-slate-600 dark:text-slate-400 line-clamp-2\">\n                          {funnel.description}\n                        </p>\n                      )}\n                    </div>\n                    <Badge variant={statusVariants[funnel.status]} size=\"sm\">\n                      {statusLabels[funnel.status]}\n                    </Badge>\n                  </div>\n\n                  {funnel.progress && (\n                    <div className=\"space-y-1\">\n                      <div className=\"flex justify-between text-xs text-slate-600 dark:text-slate-400\">\n                        <span>Fortschritt</span>\n                        <span>\n                          {funnel.progress.current} / {funnel.progress.total}\n                        </span>\n                      </div>\n                      <Progress\n                        value={(funnel.progress.current / funnel.progress.total) * 100}\n                        showPercentage={false}\n                        showStepText={false}\n                      />\n                    </div>\n                  )}\n\n                  {funnel.completedAt && (\n                    <p className=\"text-xs text-slate-500 dark:text-slate-500\">\n                      Abgeschlossen am {new Date(funnel.completedAt).toLocaleDateString('de-DE')}\n                    </p>\n                  )}\n                </div>\n              </Card>\n            ))}\n          </div>\n        )}\n      </div>\n\n      {/* Workup Status Section */}\n      <div className=\"space-y-3\">\n        <h3 className=\"text-lg font-semibold text-slate-900 dark:text-slate-100\">\n          Workup-Status\n        </h3>\n        <Card padding=\"md\" radius=\"lg\">\n          <div className=\"space-y-3\">\n            <div className=\"flex items-center justify-between\">\n              <span className=\"text-sm font-medium text-slate-700 dark:text-slate-300\">\n                Status:\n              </span>\n              <span className={`text-sm font-semibold ${workupStateColors[workupSummary.state]}`}>\n                {workupStateLabels[workupSummary.state]}\n              </span>\n            </div>\n\n            <div className=\"grid grid-cols-3 gap-4 pt-3 border-t border-slate-200 dark:border-slate-700\">\n              <div className=\"text-center\">\n                <div className=\"text-2xl font-bold text-slate-900 dark:text-slate-100\">\n                  {workupSummary.counts.total}\n                </div>\n                <div className=\"text-xs text-slate-600 dark:text-slate-400 mt-1\">Gesamt</div>\n              </div>\n              <div className=\"text-center\">\n                <div className=\"text-2xl font-bold text-amber-600 dark:text-amber-400\">\n                  {workupSummary.counts.needsMoreData}\n                </div>\n                <div className=\"text-xs text-slate-600 dark:text-slate-400 mt-1\">\n                  Weitere Daten\n                </div>\n              </div>\n              <div className=\"text-center\">\n                <div className=\"text-2xl font-bold text-green-600 dark:text-green-400\">\n                  {workupSummary.counts.readyForReview}\n                </div>\n                <div className=\"text-xs text-slate-600 dark:text-slate-400 mt-1\">\n                  Bereit\n                </div>\n              </div>\n            </div>\n          </div>\n        </Card>\n      </div>\n    </div>\n  )\n}\n\nexport default ProgressSummary\n","/**\n * useDashboardData Hook - E6.5.9\n *\n * Manages dashboard data fetching with:\n * - Stale-while-revalidate pattern\n * - Error handling with retry\n * - Refresh on demand\n *\n * E6.5.9 AC1: Dashboard reflects new status without hard reload\n * E6.5.9 AC2: Offline/failed fetch shows error state + retry (not blank)\n */\n\nimport { useState, useCallback, useRef, useEffect } from 'react'\nimport type { DashboardViewModelV1 } from '@/lib/api/contracts/patient/dashboard'\n\ntype FetchState = 'idle' | 'loading' | 'revalidating' | 'error'\n\ninterface UseDashboardDataResult {\n  data: DashboardViewModelV1 | null\n  state: FetchState\n  error: string | null\n  isStale: boolean\n  refresh: () => Promise<void>\n  retry: () => Promise<void>\n}\n\nconst DASHBOARD_API_ENDPOINT = '/api/patient/dashboard'\n\n/**\n * Hook for managing dashboard data with stale-while-revalidate strategy\n *\n * @param autoFetch - Whether to automatically fetch on mount (default: true)\n * @returns Dashboard data state and control functions\n *\n * @example\n * ```tsx\n * const { data, state, error, refresh, retry } = useDashboardData()\n *\n * if (state === 'loading') return <LoadingSpinner />\n * if (error) return <ErrorState onRetry={retry} />\n * return <DashboardContent data={data} />\n * ```\n */\nexport function useDashboardData(autoFetch: boolean = true): UseDashboardDataResult {\n  const [data, setData] = useState<DashboardViewModelV1 | null>(null)\n  const [state, setState] = useState<FetchState>('idle')\n  const [error, setError] = useState<string | null>(null)\n  const [isStale, setIsStale] = useState(false)\n\n  // Track if a fetch is in progress to prevent race conditions\n  const fetchInProgressRef = useRef(false)\n  const abortControllerRef = useRef<AbortController | null>(null)\n\n  const fetchDashboard = useCallback(\n    async (options: { isRevalidation?: boolean } = {}) => {\n      // Prevent concurrent fetches\n      if (fetchInProgressRef.current) {\n        return\n      }\n\n      // Cancel any pending request\n      if (abortControllerRef.current) {\n        abortControllerRef.current.abort()\n      }\n\n      fetchInProgressRef.current = true\n      const abortController = new AbortController()\n      abortControllerRef.current = abortController\n\n      try {\n        // If we have stale data, mark as revalidating; otherwise loading\n        if (options.isRevalidation && data) {\n          setState('revalidating')\n          setIsStale(true)\n        } else {\n          setState('loading')\n        }\n\n        setError(null)\n\n        const response = await fetch(DASHBOARD_API_ENDPOINT, {\n          credentials: 'include',\n          signal: abortController.signal,\n        })\n\n        if (!response.ok) {\n          throw new Error('Failed to load dashboard data')\n        }\n\n        const result = await response.json()\n\n        if (!result.success) {\n          throw new Error(result.error?.message || 'Failed to load dashboard')\n        }\n\n        // Update data and clear stale flag\n        setData(result.data)\n        setState('idle')\n        setIsStale(false)\n        setError(null)\n      } catch (err) {\n        // Don't set error state if request was aborted (component unmounted or new request started)\n        if (err instanceof Error && err.name === 'AbortError') {\n          return\n        }\n\n        console.error('[useDashboardData] Error loading data:', err)\n\n        // Only clear data if we don't have stale data to show\n        if (!data || !options.isRevalidation) {\n          setData(null)\n        }\n\n        setState('error')\n        setError(\n          err instanceof Error ? err.message : 'Dashboard konnte nicht geladen werden.',\n        )\n      } finally {\n        fetchInProgressRef.current = false\n        abortControllerRef.current = null\n      }\n    },\n    [data],\n  )\n\n  // Auto-fetch on mount if enabled\n  useEffect(() => {\n    if (autoFetch && state === 'idle' && !data) {\n      fetchDashboard()\n    }\n  }, [autoFetch, state, data, fetchDashboard])\n\n  // Cleanup on unmount\n  useEffect(() => {\n    return () => {\n      if (abortControllerRef.current) {\n        abortControllerRef.current.abort()\n      }\n    }\n  }, [])\n\n  /**\n   * Refresh dashboard data\n   * Uses stale-while-revalidate: shows old data while fetching new\n   */\n  const refresh = useCallback(async () => {\n    await fetchDashboard({ isRevalidation: true })\n  }, [fetchDashboard])\n\n  /**\n   * Retry after error\n   * Clears error state and attempts fresh fetch\n   */\n  const retry = useCallback(async () => {\n    await fetchDashboard({ isRevalidation: false })\n  }, [fetchDashboard])\n\n  return {\n    data,\n    state,\n    error,\n    isStale,\n    refresh,\n    retry,\n  }\n}\n","/**\n * useAppFocus Hook - E6.5.9\n *\n * Detects when the app/browser tab comes into focus.\n * Useful for triggering data refreshes when user returns to the app.\n *\n * Mobile-friendly: Handles both visibilitychange and focus events\n * for maximum compatibility across devices.\n */\n\nimport { useEffect, useRef } from 'react'\n\ntype AppFocusCallback = () => void\n\n/**\n * Hook that calls a callback when the app comes into focus\n *\n * @param onFocus - Callback to execute when app gains focus\n * @param enabled - Whether the hook is active (default: true)\n *\n * @example\n * ```tsx\n * useAppFocus(() => {\n *   console.log('App is now in focus, refreshing data...')\n *   refetchData()\n * })\n * ```\n */\nexport function useAppFocus(onFocus: AppFocusCallback, enabled: boolean = true) {\n  const callbackRef = useRef(onFocus)\n\n  // Keep callback ref up to date\n  useEffect(() => {\n    callbackRef.current = onFocus\n  }, [onFocus])\n\n  useEffect(() => {\n    if (!enabled) return\n\n    // Track if we're currently visible to avoid duplicate calls\n    let wasVisible = !document.hidden\n\n    const handleVisibilityChange = () => {\n      const isVisible = !document.hidden\n\n      // Only call callback when transitioning from hidden to visible\n      if (!wasVisible && isVisible) {\n        callbackRef.current()\n      }\n\n      wasVisible = isVisible\n    }\n\n    const handleFocus = () => {\n      // Only call if document is visible (prevents duplicate calls)\n      if (!document.hidden) {\n        callbackRef.current()\n      }\n    }\n\n    // Listen for visibility changes (mobile-friendly)\n    document.addEventListener('visibilitychange', handleVisibilityChange)\n\n    // Listen for window focus events (desktop)\n    window.addEventListener('focus', handleFocus)\n\n    return () => {\n      document.removeEventListener('visibilitychange', handleVisibilityChange)\n      window.removeEventListener('focus', handleFocus)\n    }\n  }, [enabled])\n}\n"],"names":[],"mappings":"uIAmBA,CAAA,CAAA,CAAA,CAAA,AAAM,CAAN,CAAM,CAAA,EAAY,CAAA,CAAA,CAAA,CAAZ,AAAY,CAAZ,AAAY,CAAZ,AAAY,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,GAAA,EAAiB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAhBC,CAgBa,AAf/C,CAe+C,AAf9C,CAe8C,AAf9C,CAe8C,AAf9C,CAAA,AAe8C,CAAA,AAf9C,CAe8C,AAf9C,CAe8C,AAf9C,CAe8C,AAf9C,AAAQ,CAAE,AAeoC,AAftC,CAegD,CAf3C,AAe2C,CAf3C,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAkB,CAAA,CAAA,CAAA,CAAA,AAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAU,CAAA,CAC/C,CAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAQ,CAAA,AAAE,EAAG,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAY,CAAA,CAAA,CAAA,CAAK,AAAL,CAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAU,CAAA,CAC3C,yECHA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OCqBA,CAAA,CAAA,CAAA,CAAA,AAAM,CAAN,CAAM,CAAA,EAAW,CAAA,CAAA,CAAX,AAAW,CAAX,AAAW,CAAX,AAAW,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,GAAA,EAAiB,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAtBE,CAsBU,AArB5C,CACE,AAoB0C,CApB1C,AAoB0C,CAAA,AApB1C,CAoB0C,AApB1C,CAoB0C,AApB1C,CAoB0C,AApB1C,CAAA,AAoB0C,CAnB1C,AAmB0C,CAlBxC,AAkBwC,CAlBxC,AAkBkD,CAlB/C,AAkB+C,CAlB/C,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CACH,GAAA,CAAA,AAAK,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,EAET,CACA,CAAC,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,AAAU,CAAE,CAAA,CAAA,CAAA,AAAI,IAAA,CAAA,AAAM,CAAA,CAAA,CAAI,CAAA,CAAA,CAAA,CAAA,CAAA,AAAM,CAAA,CAAA,AAAG,CAAA,CAAA,CAAA,CAAK,CAAA,CAAA,CAAA,CAAA,AAAK,QAAA,CAAU,CAAA,CAC1D,EDRA,IAAA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,CAAA,CAAA,KAAA,IAAA,EAAA,EAAA,CAAA,CAAA,OA4Ee,SAAS,EAAa,SACnC,EAAU,YAAY,CACtB,OAAK,CACL,UAAQ,UACR,GAAW,CAAI,CACf,QAAM,YACN,EAAa,UAAU,UACvB,CAAQ,WACR,EAAY,EAAE,CACI,EAClB,IAAM,EAAS,CAAA,EAAA,EAAA,SAAA,AAAS,IAwCxB,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,UAAW,CAAC,uHAAuH,EAAE,EAAA,CAAW,CAChJ,MAAO,CACL,OAAQ,GACR,UAAW,EAAA,OAAO,CAAC,EAAE,AACvB,WAEA,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CACC,UAAU,0BACV,MAAO,CACL,QAAS,CAAA,EAAG,EAAA,OAAO,CAAC,EAAE,CAAC,CAAC,EAAE,EAAA,OAAO,CAAC,EAAE,CAAA,CAAE,CACtC,UAAW,MACb,YAGC,GACC,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SACL,QAzDS,CAyDA,IAxDb,EACF,IAEA,EAHU,AAGH,IAAI,EAEf,EAoDU,UAAU,yQACV,MAAO,CACL,MAAO,OACP,OAAQ,MACV,EACA,aAAW,kBAEX,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,SAAS,CAAA,CACR,KAAM,GACN,YAAa,EACb,UAAU,qCACV,eAAa,MAMlB,CAAa,eAAZ,GAAwC,gBAAZ,CAAY,CAAa,EACrD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BACZ,GACC,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CACC,UAAU,sFACV,MAAO,CAAE,SAAU,EAAA,UAAU,CAAC,QAAQ,CAAC,EAAE,AAAC,WAEzC,IAGJ,GACC,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CACC,UAAU,4DACV,MAAO,CACL,SAAU,EAAA,UAAU,CAAC,QAAQ,CAAC,EAAE,CAChC,WAAY,EAAA,UAAU,CAAC,UAAU,CAAC,KAAK,AACzC,WAEC,OAOI,gBAAZ,GAA6B,CA3FX,KACvB,GAAI,CAAC,EAAU,OAAO,KAEtB,IAAM,EAAY,CAChB,KAAM,GACN,YAAa,EACb,cAAe,EACjB,EAEA,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SACL,QAAS,EACT,UAAU,yQACV,MAAO,CACL,MAAO,OACP,OAAQ,MACV,EACA,aAA2B,aAAf,EAA4B,gBAAkB,uBAE1C,aAAf,EACC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAU,GAAG,CAAS,CAAE,UAAU,uCAEnC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAE,GAAG,CAAS,CAAE,UAAU,yCAIvC,QAoEF,sEEnMA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,OACA,EAAA,EAAA,CAAA,CAAA,MACA,EAAA,CAAA,CAAA,OAAA,IAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,OCHA,EAAA,CAAA,CAAA,KAAA,IAAA,EAAA,EAAA,CAAA,CAAA,OAwBO,SAAS,EAAgB,UAAE,CAAQ,CAAwB,EAChE,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CACC,UAAU,6DACV,MAAO,CACL,SAAU,EAAA,UAAU,CAAC,QAAQ,CAAC,MAAM,CACpC,WAAY,EAAA,UAAU,CAAC,UAAU,CAAC,KAAK,AACzC,WAEC,EAAW,CAAC,sBAAmB,EAAE,EAAA,CAAU,CAAG,sBAEjD,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,8CAAqC,6CAKxD,CCzCA,IAAA,EAAA,EAAA,CAAA,CAAA,OCEA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,OCKA,EAAA,EAAA,CAAA,CAAA,OAkBO,IAWM,EAXA,AAWqB,CAChC,aAZyB,AAYX,eACd,eAAgB,iBAChB,eAAgB,iBAChB,cAAe,gBACf,gBAAiB,iBACnB,EAQa,EAAqB,CAChC,oBACA,eACA,iBACD,CAkCY,EAA2B,EAAA,CAAC,CAAC,MAAM,CAAC,CAC/C,SAAU,EAAA,CAAC,CAAC,IAAI,CAAC,CA3BP,WACC,YACA,YACA,YACF,UA6BR,EAAE,QAAQ,EACb,GAAG,QAAQ,GAS0B,EAAA,CAAC,CAAC,MAAM,CAAC,CAC5C,UAAW,EAAA,CAAC,CAAC,MAAM,GAChB,GAAG,CAAC,AAhC8B,GAgCL,CAAC,uBAAuB,EAAE,cACvD,GAAG,CAAC,AAhC8B,IAgCL,CAAC,CADiD,WAAW,CAAC,SACvC,EAAE,eACzD,OAAQ,EADyE,AACzE,CAAC,CAAC,MAAM,GAD4E,AACzE,CAD0E,OAClE,GAC3B,eAAgB,CAClB,GAWO,IAAM,EAAuB,EAAA,CAAC,CAAC,MAAM,CAAC,CAC3C,MAAO,EAAA,CAAC,CAAC,MAAM,GAAG,GAAG,CAAC,GAAG,GAAG,CAAC,GAC7B,MAAO,EAAA,CAAC,CAAC,IAAI,CAAC,CAAC,MAAO,SAAU,OAAO,EAAE,QAAQ,EACnD,GAAG,QAAQ,GAkCE,EAAuB,EAAA,CAAC,CAAC,MAAM,CAAC,CAC3C,KAAM,EAAA,CAAC,CAAC,IAAI,CAAC,CAtIP,OACM,aACF,WAwIT,EACD,WAAY,EAAA,CAAC,CAAC,IAAI,CAAC,CACjB,EAAmB,YAAY,CAC/B,EAAmB,cAAc,CACjC,EAAmB,cAAc,CACjC,EAAmB,aAAa,CAChC,EAAmB,eAAe,CACnC,EACD,SAAU,EAAA,CAAC,CAAC,KAAK,CAAC,EAAA,CAAC,CAAC,MAAM,IAAI,MAAM,CAClC,AAAC,GAAU,EAAM,KAAK,CAAC,GAAQ,EAAmB,QAAQ,CAAC,IAC3D,CAAE,QAAS,0CAA2C,GACtD,OAAO,CAAC,EAAE,EACZ,UAAW,EAAA,CAAC,CAAC,MAAM,GAChB,MAAM,CAAC,AA3CZ,SAAS,AAAkB,CAAiB,EAE1C,IAAM,EAAgB,iBAEhB,EADQ,AACM,EADI,KAAK,CAAC,MAAM,MAAM,CAAC,GAAQ,EAAK,IAAI,GAAG,MAAM,CAAG,GAC9C,MAAM,CAAC,GAAQ,EAAc,IAAI,CAAC,WAE5D,AAAI,EAAY,MAAM,CAAG,GAAG,CAEtB,EAAY,MAAM,CA/DkB,CA+Df,CAAA,CAQpB,CARkD,CAQxC,MAAM,EAxEkB,EAwEd,CAC7B,EA0B+B,CACzB,QAAS,CAAC,mBAAmB,EAAE,4BAA4B,YAAqE,AAClI,GACF,eAAgB,CAF8E,CAG9F,CAHgG,OAGvF,EAAA,CAAC,CAAC,OAAO,CAAC,AArKgB,MAsKnC,IAJ6H,MAAM,IAIpH,EAAA,CAAC,CAAC,MAAM,GAAG,QAAQ,EACpC,GAWa,EAA8B,EAAA,CAAC,CAAC,MAAM,CAAC,CAClD,QAAS,EAAA,CAAC,CAAC,OAAO,EAAC,GACnB,KAAM,CACR,GAOa,EAA4B,EAAA,CAAC,CAAC,MAAM,CAAC,CAChD,QAAS,EAAA,CAAC,CAAC,OAAO,EAAC,GACnB,MAAO,EAAA,CAAC,CAAC,MAAM,CAAC,CACd,KAAM,EAAA,CAAC,CAAC,MAAM,GACd,QAAS,EAAA,CAAC,CAAC,MAAM,GACjB,QAAS,EAAA,CAAC,CAAC,MAAM,CAAC,EAAA,CAAC,CAAC,MAAM,GAAI,EAAA,CAAC,CAAC,OAAO,IAAI,QAAQ,EACrD,EACF,GAOoC,EAAA,CAAC,CAAC,KAAK,CAAC,CAC1C,EACA,EACD,EDvND,IAAA,EAAA,EAAA,CAAA,CAAA,OAgCA,IAAM,EAAqB,CACzB,oBACA,YACA,iBACA,YACD,CAIK,EAAkB,CACtB,CACE,MAAO,UACP,KAAM,iEACN,KAAM,OACN,MAAO,OACT,EACA,CACE,MAAO,gBACP,KAAM,2GACN,KAAM,aACN,MAAO,OACT,EACA,CACE,MAAO,cACP,KAAM,wFACN,KAAM,WACN,MAAO,KACT,EACD,CAgDM,SAAS,IACd,IAAM,EAAS,CAAA,EAAA,EAAA,SAAA,AAAS,IAClB,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAC,IACjC,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAc,QAC1C,CAAC,EAAQ,EAAU,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAwB,MACtD,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,MAC5C,CAAC,EAAgB,EAAkB,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAE/C,EAAY,EAAQ,MAAM,CAC1B,EAAc,EA3FH,IAAI,AA4Ff,EAAc,EA3FK,EA0FO,EA1FH,CA2FyB,KAAtB,EAC1B,EAAY,EAAQ,EADyC,EACrC,GAAG,GA5FkB,AADA,GA6FZ,EAAI,IAAM,CAAC,GAAyB,YAAV,EAU3D,EAAe,UACnB,GAAK,CAAD,EAEJ,EAAS,MAFO,KAGhB,EAAS,MACT,EAAU,MAEV,GAAI,CACF,IAAM,EAAW,MAAM,MAAM,kBAAmB,CAC9C,OAAQ,OACR,QAAS,CACP,eAAgB,kBAClB,EACA,KAAM,KAAK,SAAS,CAAC,CAAE,QAAS,EAAQ,IAAI,EAAG,EACjD,GAEM,EAAO,MAAM,EAAS,IAAI,GAEhC,GAAI,CAAC,EAAS,EAAE,CACd,CADgB,KACV,AAAI,MAAM,EAAK,KAAK,EAAI,yBAGhC,GAAI,EAAK,OAAO,EAAI,EAAK,IAAI,CAAE,CAC7B,IAAM,EAAe,EAAK,IAAI,CAC9B,EAAU,GACV,EAAS,WG3IV,AH8IC,SG9IQ,AAAkB,CAAsB,EACtD,GAAqC,CAAC,AAAlC,OAAyC,cAAc,CAEzD,CAF2D,MAC3D,AACO,QADC,IAAI,CAAC,KADO,2CAKtB,GAAI,CACF,IAAM,EAAa,KAAK,SAAS,CAAC,GAClC,OAAO,cAAc,CAAC,OAAO,CAAC,AAjBd,mBAiB2B,EAE7C,CAAE,MAAO,EAAO,CAEd,OADA,QAAQ,KAAK,CAAC,gDAAiD,IACxD,CACT,CACF,EHgI0B,EACpB,MACE,CADK,KACC,AAAI,MAAM,0BAEpB,CAAE,MAAO,EAAK,CACZ,QAAQ,KAAK,CAAC,8BAA+B,GAC7C,EAAS,aAAe,MAAQ,EAAI,OAAO,CAAG,4CAC9C,EAAS,QACX,EACF,EAwCA,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,QAAQ,KAAK,OAAO,cACxB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBAEb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mCACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,+HACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,WAAW,KAAK,MAAM,aAAW,yBAAgB,SAInE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mBACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,yEAAgE,qCAG9E,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,sDAA6C,qDAO9D,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,gBACb,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,oBACX,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,WAAQ,EAAA,wBAAwB,CAAC,KAAK,CAAC,OAAU,IAAE,EAAA,wBAAwB,CAAC,IAAI,MAKpF,CA1JmB,KAO1B,GAAI,CACF,IAAM,EAAkB,aAAa,OAAO,CAAC,qBAC7C,GAAwB,QAAQ,CAA5B,EACF,OAAO,CAEX,CAAE,MAAO,EAAO,CAIhB,CAGA,IAAM,EAAW,OAAO,QAAQ,CAAC,QAAQ,CACzC,MACe,cAAb,GACa,cAAb,GACA,EAAS,QAAQ,CAAC,YAClB,EAAS,QAAQ,CAAC,QAEtB,KAiIU,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8HACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,UAAU,KAAK,MAAM,aAAW,qBAAY,UAG5D,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,sEAA6D,iCAI7E,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,KAAK,SACL,QAAS,IAAM,EAAkB,CAAC,GAClC,UAAU,0KAET,EAAiB,OAAS,YAI9B,GACC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,6DAAoD,8EAGjE,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gCACZ,EAAgB,GAAG,CAAC,AAAC,gBACpB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAEC,KAAK,SACL,QAAS,IAAM,CA7IjC,EA6IoD,EAAK,IAAI,EA5I7D,CADW,CACF,QACT,EAAU,MACV,EAAS,OA2IS,SAAU,AAAU,cACpB,SAAA,EA3MY,AA2MD,EAAyB,EAAK,KAAK,CAlM3D,GAAG,WAAW,CAAC,+FAAE,CANJ,CAClB,MAAO,qHACP,MAAO,qHACP,IAAK,wGACP,EAEmC,CAAC,EAAM,EAAE,WAoMvB,EAAK,KAAK,EANN,EAAK,KAAK,MAUrB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,6DAAoD,qDASxE,CAAW,SAAV,GAAoB,AAAU,eAAa,AAAU,WAAA,CAAO,EAC5D,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WAEE,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gCACZ,EAAmB,GAAG,CAAC,AAAC,GACvB,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CAEC,KAAK,SACL,QAAS,IAAM,cAlGvB,EAkGuC,AAlGhC,EAAK,KAAK,CAAC,GAAG,IAAI,GAAG,KAC9B,EACF,EAAW,EAAU,GADV,EACiB,GAE5B,EAAW,KA+FC,OAnGqD,EAmGjC,YAAV,EACV,UAAU,2NAET,GANI,MAYX,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CACP,MAAO,EACP,SAAU,AAAC,GAAM,EAAW,EAAE,MAAM,CAAC,KAAK,EAC1C,YAAY,2EACZ,KAAM,EACN,SAAoB,YAAV,EACV,MAAO,EACP,aACE,EAAc,CAAC,QAAQ,EAAE,WAAW,aAAoB,EAE1D,CAFsD,CAAC,SAGrD,CAAC,GAAe,EACZ,CAAC,kBAAkB,EAAE,gBACrB,EAEN,CAH8C,QAAQ,CAAC,AAG5C,MAEb,CAAA,EAAA,EAAA,EAF0B,EAE1B,EAAC,MAAA,CAAI,UAAU,sDACb,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CACC,UAAW,CAAA,EACT,EACI,6CACA,EACE,qCACA,qCAAA,CACN,WAED,EAAU,UAAe,cAE3B,EAAQ,IAAI,GAAG,MAAM,CAAG,IAAM,EAAQ,IAAI,GAAG,MAAM,CAAG,GACrD,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,sDAA6C,6CAQlE,GACC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,iBACb,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,mBAAW,MAK5B,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CACL,QAAQ,UACR,SAAS,CAAA,CAAA,EACT,QAAS,EACT,SAAU,CAAC,EACX,QAAmB,YAAV,WAER,AAAU,cAAY,qBAAuB,2BAMnD,AAAU,eAAa,GACtB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBAEb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,mCACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CACC,UAAW,CAAC,oEAAoE,EAC9D,aAAhB,EAAO,IAAI,CACP,+DACA,AAAgB,iBAAT,IAAI,CACT,uEACA,uEAAA,CACN,UAED,AAAgB,eAAT,IAAI,CACR,cACgB,eAAhB,EAAO,IAAI,CACT,4BACA,oBAKV,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,uDACb,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,8DACV,EAAO,SAAS,KAKrB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,IAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAQ,UAAU,SAAS,CAAA,CAAA,EAAC,QA3NzB,CA2NkC,gBA1NvD,GAAI,CAAC,EAAQ,OAGb,GEQ6B,CFRzB,CAAC,AAAiB,EAAO,MEQkB,IFRR,EESlC,OAAO,MAAM,CAAC,GAAoB,QAAQ,CAAC,GFTN,CACxC,QAAQ,KAAK,CAAC,mCAAoC,CAAE,WAAY,EAAO,UAAU,AAAC,GAClF,EAAS,2DACT,MACF,CAGA,GAAM,CAAE,KAAG,CAAE,aAAW,CAAE,EEX1B,CFW6B,GEdnB,AA/BP,SAAS,AAAc,CAAkB,EAC9C,EA8B0B,CA9BpB,MAAE,CAAI,OAAE,CAAK,CAAE,CAAG,EAExB,GAAI,CAAC,GAAuC,GAAG,CAAjC,OAAO,IAAI,CAAC,GAAO,MAAM,CACrC,OAAO,EAGT,IAAM,EAAc,IAAI,gBAAgB,GAAO,QAAQ,GACvD,MAAO,CAAA,EAAG,EAAK,CAAC,EAAE,EAAA,CACpB,AADiC,EAsBzB,EAAQ,AApIT,SAAS,AACd,CAA4B,CAC5B,CAA4B,EAE5B,OAAQ,AAgI2B,GA/HjC,KAAK,EAAmB,EA+HqB,UA/HT,CAElC,MAAO,CACL,KAAM,qBACN,MAAO,CACL,SAAU,SACZ,EACA,MAAO,CACL,kBAAkB,EAClB,WAAY,EAAa,IAAI,AAC/B,EACA,YAAa,gCACf,CAEF,MAAK,EAAmB,cAAc,CAEpC,MAAO,CACL,KAAM,oCACN,MAAO,CACL,OAAQ,QACV,EACA,MAAO,CACL,gBAAiB,EAAa,SAAS,CACvC,WAAY,EAAa,IAAI,AAC/B,EACA,YAAa,iDACf,CAEF,MAAK,EAAmB,cAAc,CAEpC,MAAO,CACL,KAAM,wBACN,MAAO,CACL,OAAQ,QACV,EACA,MAAO,CACL,gBAAiB,EAAa,SAAS,CACvC,WAAY,EAAa,IAAI,AAC/B,EACA,YAAa,mCACf,CAEF,MAAK,EAAmB,aAAa,CAGnC,MAAO,CACL,KAAM,qBACN,MAAO,CACL,OAAQ,QACV,EACA,MAAO,CACL,gBAAiB,EAAa,SAAS,AACzC,EACA,YAAa,uCACf,CAEF,MAAK,EAAmB,eAAe,CAErC,MAAO,CACL,KAAM,mBACN,MAAO,CACL,OAAQ,SACR,KAAM,EAAa,IAAI,AACzB,EACA,MAAO,CACL,gBAAiB,EAAa,SAAS,CACvC,SAAU,EAAa,QAAQ,CAC/B,QAAQ,CACV,EACA,YAAa,yCACf,CAEF,SAKE,OAHA,QAAQ,IAAI,CAAC,+DAAgE,YAC3E,CACF,GACO,CACL,KAAM,qBACN,MAAO,CAAC,EACR,MAAO,CAAC,EACR,YAAa,wCACf,CACJ,CACF,EF0DqD,EAAO,UAAU,CAAE,IEVpE,MAAO,EAAM,KAAK,EAAI,CAAC,EACvB,YAAa,EAAM,WAAW,EFc9B,EAAO,IAAI,CAAC,EACd,YA2MqC,iBAAtB,EAAO,UAAU,EAAuB,qBACxC,AAAsB,qBAAf,UAAU,EAAyB,wBACpB,mBAAtB,EAAO,UAAU,EAAyB,+BACpB,kBAAtB,EAAO,UAAU,EAAwB,2BACzC,AAAsB,sBAAf,UAAU,EAA0B,+BAI9C,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,MAAM,CAAA,CAAC,QAAQ,YAAY,SAAS,CAAA,CAAA,EAAC,QAtM9B,CAsMuC,IArMzD,EAAW,IACX,EAAS,QACT,EAAU,MACV,EAAS,KACX,WAiMwE,+BAM7C,aAAhB,EAAO,IAAI,EACV,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAQ,iBACb,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,gCACX,CAAA,EAAA,EAAA,IAAA,EAAC,SAAA,WAAQ,EAAA,2BAA2B,CAAC,KAAK,CAAC,OAAW,IACrD,EAAA,2BAA2B,CAAC,IAAI,aASnD,CIrYO,SAAS,EAAa,UAAE,CAAQ,UAAE,CAAQ,CAAqB,EAEpE,GAAsB,QAAQ,CAA1B,EAAS,IAAI,CACf,OAAO,KAYT,IAAM,EARU,AAQH,CAPX,WAAY,KACZ,OAAQ,KACR,OAAQ,KACR,QAAS,KACT,KAAM,EACR,CAEoB,CAAC,EAAS,IAAI,CAAC,CAEnC,MACE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,QAAQ,KAAK,OAAO,KAAK,UAAU,uDACvC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,+GACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,WAAW,KAAK,MAAM,aAAW,qBAC9C,MAGL,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mBACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,oEAA2D,qBAGzE,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,sDAA8C,EAAS,KAAK,SAI5E,EAAS,MAAM,EACd,CAAA,EAAA,EAAA,GAAA,EAAC,SAAA,CACC,QAAS,EACT,UAAU,yHAET,EAAS,KAAK,OAM3B,CC/CO,SAAS,EAAiB,OAAE,CAAK,aAAE,CAAW,CAAyB,EAE5E,IAAM,EAAc,IAAI,EAAM,CAAC,IAAI,CAAC,CAAC,EAAG,IAAM,EAAE,QAAQ,CAAG,EAAE,QAAQ,EAG/D,EAAU,CACd,KAAM,KACN,OAAQ,IACR,UAAW,IACb,SAGA,AAAI,AAAiB,GAAG,GAAd,MAAM,CAEZ,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,6BACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yBAAgB,OAC/B,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,uEAA8D,iCAG5E,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,sDAA6C,6CAQ9D,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,oEAA2D,uBAGzE,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,oDACZ,EAAY,GAAG,CAAC,AAAC,GAChB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAEH,QAAQ,KACR,OAAO,KACP,YAAa,CAAC,CAAC,EAAK,YAAY,CAChC,QAAS,KACH,EAAK,YAAY,EAAI,GACvB,EAAY,EAEhB,MAHwC,KAKxC,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mCACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,yBAAyB,KAAK,MAAM,aAAY,EAAK,IAAI,UACtE,CAAO,CAAC,EAAK,IAAI,CAAC,GAErB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,wEACX,EAAK,KAAK,GAEZ,EAAK,WAAW,EACf,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,mEACV,EAAK,WAAW,SAKxB,EAAK,WAAW,EAAI,EAAK,YAAY,EACpC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,gEACb,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,CAAK,UAAU,+DACb,EAAK,WAAW,CAAC,cA7BrB,EAAK,EAAE,OAuCxB,CCxGA,IAAA,EAAA,EAAA,CAAA,CAAA,OAAA,EAAA,EAAA,CAAA,CAAA,OAiCO,SAAS,EAAgB,iBAC9B,CAAe,eACf,CAAa,eACb,CAAa,CACQ,EAErB,IAAM,EAAiB,CACrB,YAAa,UACb,YAAa,UACb,UAAW,SACb,EAEM,EAAe,CACnB,YAAa,iBACb,YAAa,iBACb,UAAW,eACb,EAeA,MACE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBAEb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,oEAA2D,qBAIxE,AAA2B,MAAX,MAAM,CACrB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,QAAQ,KAAK,OAAO,cACxB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,6BACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,yBAAgB,OAC/B,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,yEAAgE,2BAG9E,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,sDAA6C,+EAM9D,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qBACZ,EAAgB,GAAG,CAAC,AAAC,GACpB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAEH,QAAQ,KACR,OAAO,KACP,YAAa,AAAkB,kBAAX,MAAM,CAC1B,QAAS,KACe,gBAAlB,EAAO,MAAM,EAAsB,GACrC,EAAc,EAElB,QAHwD,GAKxD,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,mDACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,2BACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,+DACX,EAAO,KAAK,GAEd,EAAO,WAAW,EACjB,CAAA,EAAA,EAAA,GAAA,EAAC,IAAA,CAAE,UAAU,mEACV,EAAO,WAAW,MAIzB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,KAAK,CAAA,CAAC,QAAS,CAAc,CAAC,EAAO,MAAM,CAAC,CAAE,KAAK,cACjD,CAAY,CAAC,EAAO,MAAM,CAAC,MAI/B,EAAO,QAAQ,EACd,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,4EACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAK,gBACN,CAAA,EAAA,EAAA,IAAA,EAAC,OAAA,WACE,EAAO,QAAQ,CAAC,OAAO,CAAC,MAAI,EAAO,QAAQ,CAAC,KAAK,OAGtD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,QAAQ,CAAA,CACP,MAAQ,EAAO,QAAQ,CAAC,OAAO,CAAG,EAAO,QAAQ,CAAC,KAAK,CAAI,IAC3D,gBAAgB,EAChB,cAAc,OAKnB,EAAO,WAAW,EACjB,CAAA,EAAA,EAAA,IAAA,EAAC,IAAA,CAAE,UAAU,uDAA6C,oBACtC,IAAI,KAAK,EAAO,WAAW,EAAE,kBAAkB,CAAC,gBA7CnE,EAAO,IAAI,QAwD1B,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,GAAA,EAAC,KAAA,CAAG,UAAU,oEAA2D,kBAGzE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,IAAI,CAAA,CAAC,QAAQ,KAAK,OAAO,cACxB,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sBACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,8CACb,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAU,kEAAyD,YAGzE,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CAAK,UAAW,CAAC,sBAAsB,EAhG1B,AAgG4B,CA/FpD,QAAS,qCACT,gBAAiB,qCACjB,iBAAkB,oCACpB,CA4FuE,CAAC,EAAc,KAAK,CAAC,CAAA,CAAE,UAC/E,AAvGW,CACxB,QAAS,cACT,gBAAiB,6BACjB,iBAAkB,wBACpB,CAmGgC,CAAC,EAAc,KAAK,CAAC,MAI3C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wFACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wBACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iEACZ,EAAc,MAAM,CAAC,KAAK,GAE7B,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,2DAAkD,cAEnE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wBACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iEACZ,EAAc,MAAM,CAAC,aAAa,GAErC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,2DAAkD,qBAInE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,wBACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iEACZ,EAAc,MAAM,CAAC,cAAc,GAEtC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,2DAAkD,2BAUjF,CTrJe,SAAS,IACtB,IAAM,EAAS,CAAA,EAAA,EAAA,SAAA,AAAS,IAClB,EAAe,CAAA,EAAA,EAAA,eAAA,AAAe,IAG9B,CAAE,KAAM,CAAa,CAAE,OAAK,OAAE,CAAK,SAAE,CAAO,CAAE,SAAO,OAAE,CAAK,CAAE,CAAG,AUHlE,SAAS,AAAiB,EAAqB,EAAI,EACxD,GAAM,CAAC,EAAM,EAAQ,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAA8B,MACxD,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAa,QACzC,CAAC,EAAO,EAAS,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,EAAgB,MAC5C,CAAC,EAAS,EAAW,CAAG,CAAA,EAAA,EAAA,QAAA,AAAQ,GAAC,GAGjC,EAAqB,CAAA,EAAA,EAAA,MAAM,AAAN,GAAO,GAC5B,EAAqB,CAAA,EAAA,EAAA,MAAA,AAAM,EAAyB,MAEpD,EAAiB,CAAA,EAAA,EAAA,WAAA,AAAW,EAChC,MAAO,EAAwC,CAAC,CAAC,IAE/C,GAAI,EAAmB,OAAO,CAC5B,CAD8B,MAK5B,EAAmB,OAAO,EAAE,AAC9B,EAAmB,OAAO,CAAC,KAAK,GAGlC,EAAmB,OAAO,EAAG,EAC7B,IAAM,EAAkB,IAAI,gBAC5B,EAAmB,OAAO,CAAG,EAE7B,GAAI,CAEE,EAAQ,cAAc,EAAI,GAC5B,EAAS,CADyB,eAElC,GAAW,IAEX,EAAS,WAGX,EAAS,MAET,IAAM,EAAW,MAAM,MAAM,AAtDN,yBAsD8B,CACnD,YAAa,UACb,OAAQ,EAAgB,MAAM,AAChC,GAEA,GAAI,CAAC,EAAS,EAAE,CACd,CADgB,KACV,AAAI,MAAM,iCAGlB,IAAM,EAAS,MAAM,EAAS,IAAI,GAElC,GAAI,CAAC,EAAO,OAAO,CACjB,CADmB,KACb,AAAI,MAAM,EAAO,KAAK,EAAE,SAAW,4BAI3C,EAAQ,EAAO,IAAI,EACnB,EAAS,QACT,GAAW,GACX,EAAS,KACX,CAAE,MAAO,EAAK,CAEZ,GAAI,aAAe,OAAsB,cAAc,CAA3B,EAAI,IAAI,CAClC,OAGF,QAAQ,KAAK,CAAC,yCAA0C,GAGpD,AAAC,GAAS,EAAQ,GAAT,WAAuB,EAAE,AACpC,EAAQ,MAGV,EAAS,SACT,EACE,aAAe,MAAQ,EAAI,OAAO,CAAG,yCAEzC,QAAU,CACR,EAAmB,OAAO,EAAG,EAC7B,EAAmB,OAAO,CAAG,IAC/B,CACF,EACA,CAAC,EAAK,EAmCR,MA/BA,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACJ,GAAuB,SAAV,GAAoB,CAAC,GACpC,GAD0C,AAG9C,EAAG,CAAC,EAAW,EAAO,EAAM,EAAe,EAG3C,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,IACD,KACD,EAAmB,OAAO,EAAE,AAC9B,EAAmB,OAAO,CAAC,KAAK,EAEpC,EACC,EAAE,EAkBE,MACL,QACA,QACA,UACA,EACA,QAjBc,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,UAC1B,MAAM,EAAe,CAAE,gBAAgB,CAAK,EAC9C,EAAG,CAAC,EAAe,EAgBjB,MAVY,CAAA,EAAA,EAAA,WAAA,AAAW,EAAC,UACxB,MAAM,EAAe,CAAE,gBAAgB,CAAM,EAC/C,EAAG,CAAC,EAAe,CASnB,CACF,WCzIO,AXqBL,SWrBc,AAAY,CAAyB,CAAE,GAAmB,CAAI,EAC5E,IAAM,EAAc,CAAA,EAAA,EAAA,MAAA,AAAM,EAAC,GAG3B,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,EAAY,OAAO,CAAG,CACxB,EAAG,CAAC,EAAQ,EAEZ,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,GAAI,CAAC,EAAS,OAGd,IAAI,EAAa,CAAC,SAAS,MAAM,CAE3B,EAAyB,KAC7B,IAAM,EAAY,CAAC,SAAS,MAAM,AAG9B,EAAC,GAAc,GACjB,EAAY,MADgB,CACT,GAGrB,EAAa,CACf,EAEM,EAAc,KAEd,AAAC,SAAS,MAAM,EAAE,AACpB,EAAY,OAAO,EAEvB,EAQA,OALA,SAAS,gBAAgB,CAAC,mBAAoB,GAG9C,OAAO,gBAAgB,CAAC,QAAS,GAE1B,KACL,SAAS,mBAAmB,CAAC,mBAAoB,GACjD,OAAO,mBAAmB,CAAC,QAAS,EACtC,CACF,EAAG,CAAC,EAAQ,CACd,EXtBc,KACV,GACF,GAIA,CAAA,EAAA,EAAA,SAAA,AAAS,EAAC,KACR,IAAM,EAAiB,EAAa,GAAG,CAAC,WAClC,EAAW,EAAa,GAAG,CAAC,YAC5B,EAAS,EAAa,GAAG,CAAC,UAEhC,GAAuB,WAAnB,GAAkD,aAAnB,EAA+B,CAEhE,IAAM,EAAS,IAAI,IAAI,OAAO,QAAQ,CAAC,IAAI,EAC3C,EAAO,YAAY,CAAC,MAAM,CAAC,WAC3B,EAAO,OAAO,CAAC,EAAO,QAAQ,CAAG,EAAO,MAAM,CAAE,CAAE,QAAQ,CAAM,GAGhE,GACF,CAGA,GAAiB,YAAb,EAAwB,CAE1B,WAAW,KACT,IAAM,EAAiB,SAAS,cAAc,CAAC,iBAC3C,GACF,EAAe,WADG,GACW,CAAC,CAAE,SAAU,SAAU,MAAO,OAAQ,EAEvE,EAAG,KAGH,IAAM,EAAS,IAAI,IAAI,OAAO,QAAQ,CAAC,IAAI,EAC3C,EAAO,YAAY,CAAC,MAAM,CAAC,YAC3B,EAAO,OAAO,CAAC,EAAO,QAAQ,CAAG,EAAO,MAAM,CAAE,CAAE,QAAQ,CAAM,EAClE,CAGA,GAAe,WAAX,GAAuB,GAAe,UAAU,OAAQ,CAE1D,WAAW,KACT,EAAO,IAAI,CAAC,EAAc,QAAQ,CAAC,MAAM,CAC3C,EAAG,KAGH,IAAM,EAAS,IAAI,IAAI,OAAO,QAAQ,CAAC,IAAI,EAC3C,EAAO,YAAY,CAAC,MAAM,CAAC,UAC3B,EAAO,OAAO,CAAC,EAAO,QAAQ,CAAG,EAAO,MAAM,CAAE,CAAE,QAAQ,CAAM,EAClE,CACF,EAAG,CAAC,EAAc,EAAQ,EAAS,EAAc,EAoB/C,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,sLACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,OAAY,CAAA,CACX,QAAQ,aACR,MAAM,YACN,SAAS,yBACT,UAAU,IAGZ,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,CACC,UAAU,2CACV,MAAO,CAAE,cAAe,0CAA2C,WAEnE,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,+CAEF,YAAV,GAAuB,CAAC,GACvB,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,iBACb,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,cAAc,CAAA,CAAC,KAAK,KAAK,KAAK,4BAA4B,QAAQ,CAAA,CAAA,MAKtE,AAAU,oBAAkB,GAAW,GACtC,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,qFACb,CAAA,EAAA,EAAA,IAAA,EAAC,MAAA,CAAI,UAAU,oCACb,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,UAAU,mFACf,CAAA,EAAA,EAAA,GAAA,EAAC,OAAA,UAAK,mCAMX,GACC,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,UAAU,CAAA,CACT,MAAM,oBACN,QAAS,EACT,QAAS,EACT,SAAU,CAAC,IAMd,GACC,CAAA,EAAA,EAAA,IAAA,EAAA,EAAA,QAAA,CAAA,WAEE,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAA,GAGD,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CAAA,GAGA,EAAc,QAAQ,EACrB,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CACC,SAAU,EAAc,QAAQ,CAChC,SAxEa,CAwEH,IAvEpB,GAAe,UAAU,QAAQ,AACnC,EAAO,IAAI,CAAC,EAAc,QAAQ,CAAC,MAAM,CAE7C,IAyEY,CAAA,EAAA,EAAA,GAAA,EAAC,MAAA,CAAI,GAAG,yBACN,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CACC,MAAO,EAAc,YAAY,CACjC,YAtES,AAAD,CAsEK,GArEvB,EAAK,YAAY,EAAE,AACrB,EAAO,IAAI,CAAC,EAAK,YAAY,CAEjC,MAuEY,CAAA,EAAA,EAAA,GAAA,EAAC,EAAA,CACC,gBAAiB,EAAc,eAAe,CAC9C,cAAe,EAAc,aAAa,CAC1C,cAlFY,AAAC,CAkFE,GAjF3B,EAAO,IAAI,CAAC,CAAC,gBAAgB,EAAE,EAAO,IAAI,CAAA,CAAE,CAC9C,cAwFF","ignoreList":[0,2]}