(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,67488,e=>{"use strict";var t=e.i(18050),a=e.i(71645);e.i(180);var r=e.i(53012);let s=(0,a.forwardRef)(({variant:e="primary",size:a="md",fullWidth:s=!1,icon:l,loading:n=!1,disabled:i=!1,className:d="",children:o,type:c="button",onClick:u,onMouseDown:x,onMouseUp:m,onTouchStart:h,onTouchEnd:g,onKeyDown:b,onKeyUp:p,onFocus:v,onBlur:k,...j},f)=>{let y={sm:{padding:"0.5rem 1rem",fontSize:"0.875rem",minHeight:"36px"},md:{padding:"0.625rem 1.5rem",fontSize:"1rem",minHeight:r.componentTokens.navigationButton.minHeight},lg:{padding:"0.875rem 2rem",fontSize:"1.125rem",minHeight:"56px"}},N={primary:`
        bg-sky-600 dark:bg-sky-500 text-white 
        hover:bg-sky-700 dark:hover:bg-sky-600
        active:bg-sky-800 dark:active:bg-sky-700
        disabled:bg-slate-300 dark:disabled:bg-slate-700 disabled:text-slate-500 dark:disabled:text-slate-400
        shadow-md hover:shadow-lg
      `,secondary:`
        bg-slate-100 dark:bg-slate-700 text-slate-900 dark:text-slate-100
        hover:bg-slate-200 dark:hover:bg-slate-600
        active:bg-slate-300 dark:active:bg-slate-500
        disabled:bg-slate-50 dark:disabled:bg-slate-800 disabled:text-slate-400 dark:disabled:text-slate-600
        border-2 border-slate-200 dark:border-slate-600
      `,outline:`
        bg-transparent text-sky-600 dark:text-sky-400
        border-2 border-sky-600 dark:border-sky-500
        hover:bg-sky-50 dark:hover:bg-sky-900/30
        active:bg-sky-100 dark:active:bg-sky-900/50
        disabled:border-slate-300 dark:disabled:border-slate-600 disabled:text-slate-400 dark:disabled:text-slate-500
      `,ghost:`
        bg-transparent text-slate-700 dark:text-slate-300
        hover:bg-slate-100 dark:hover:bg-slate-700
        active:bg-slate-200 dark:active:bg-slate-600
        disabled:text-slate-400 dark:disabled:text-slate-500
      `,destructive:`
        bg-red-600 dark:bg-red-500 text-white
        hover:bg-red-700 dark:hover:bg-red-600
        active:bg-red-800 dark:active:bg-red-700
        disabled:bg-slate-300 dark:disabled:bg-slate-700 disabled:text-slate-500 dark:disabled:text-slate-400
        shadow-md hover:shadow-lg
      `,danger:`
        bg-red-600 dark:bg-red-500 text-white
        hover:bg-red-700 dark:hover:bg-red-600
        active:bg-red-800 dark:active:bg-red-700
        disabled:bg-slate-300 dark:disabled:bg-slate-700 disabled:text-slate-500 dark:disabled:text-slate-400
        shadow-md hover:shadow-lg
      `},w=y[a],z=N[e],_=`
      inline-flex items-center justify-center gap-2
      font-semibold rounded-xl
      transition-all duration-200
      focus:outline-none focus:ring-2 focus:ring-sky-500 focus:ring-offset-2
      disabled:cursor-not-allowed disabled:opacity-60
      active:scale-[0.98]
      touch-manipulation
      ${s?"w-full":""}
      ${z}
      ${d}
    `;return(0,t.jsxs)("button",{ref:f,type:c,disabled:i||n,className:_,style:{padding:w.padding,fontSize:w.fontSize,minHeight:w.minHeight},onClick:u,onMouseDown:x,onMouseUp:m,onTouchStart:h,onTouchEnd:g,onKeyDown:b,onKeyUp:p,onFocus:v,onBlur:k,"aria-busy":n,...j,children:[n&&(0,t.jsxs)("svg",{className:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","aria-hidden":"true",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),!n&&l&&(0,t.jsx)("span",{className:"flex-shrink-0",children:l}),(0,t.jsx)("span",{children:o})]})});s.displayName="Button",e.s(["Button",0,s])},12911,e=>{"use strict";var t=e.i(18050);e.i(180);var a=e.i(53012);function r({header:e,footer:r,children:s,padding:l="lg",radius:n="xl",shadow:i="sm",interactive:d=!1,border:o=!0,onClick:c,className:u="",...x}){let m={none:"0",sm:a.spacing.md,md:a.spacing.lg,lg:a.spacing.xl},h={none:a.shadows.none,sm:a.shadows.sm,md:a.shadows.md,lg:a.shadows.lg},g={md:a.radii.md,lg:a.radii.lg,xl:a.radii.xl,"2xl":a.radii["2xl"]},b=m[l],p=h[i],v=g[n],k=`bg-white dark:bg-slate-800 ${o?"border border-slate-200 dark:border-slate-700":""} transition-colors duration-150`,j=d?"cursor-pointer hover:border-sky-400 dark:hover:border-sky-500 hover:shadow-lg active:scale-[0.99] transition-all duration-200":"";return c?(0,t.jsxs)("button",{type:"button",className:`${k} ${j} ${u}`,style:{borderRadius:v,boxShadow:p},onClick:c,onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&(e.preventDefault(),c())},children:[e&&(0,t.jsx)("div",{className:"border-b border-slate-200 dark:border-slate-700",style:{padding:b},children:e}),(0,t.jsx)("div",{style:{padding:b},children:s}),r&&(0,t.jsx)("div",{className:"border-t border-slate-200 dark:border-slate-700",style:{padding:b},children:r})]}):(0,t.jsxs)("div",{className:`${k} ${j} ${u}`,style:{borderRadius:v,boxShadow:p},...x,children:[e&&(0,t.jsx)("div",{className:"border-b border-slate-200 dark:border-slate-700",style:{padding:b},children:e}),(0,t.jsx)("div",{style:{padding:b},children:s}),r&&(0,t.jsx)("div",{className:"border-t border-slate-200 dark:border-slate-700",style:{padding:b},children:r})]})}e.s(["Card",()=>r])},84584,52220,e=>{"use strict";var t=e.i(18050);function a({size:e="md",text:a,centered:r=!1,className:s="",...l}){let n={sm:{spinner:"h-4 w-4",text:"text-xs"},md:{spinner:"h-8 w-8",text:"text-sm"},lg:{spinner:"h-12 w-12",text:"text-base"},xl:{spinner:"h-16 w-16",text:"text-lg"}}[e],i=`
    ${r?"flex flex-col items-center justify-center min-h-[200px]":"inline-flex flex-col items-center"}
    ${s}
  `;return(0,t.jsxs)("div",{className:i,role:"status","aria-live":"polite",...l,children:[(0,t.jsxs)("svg",{className:`animate-spin text-sky-600 ${n.spinner}`,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","aria-hidden":"true",children:[(0,t.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,t.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),a&&(0,t.jsx)("p",{className:`mt-3 text-slate-600 font-medium ${n.text}`,children:a}),(0,t.jsx)("span",{className:"sr-only",children:a||"Laden..."})]})}e.s(["LoadingSpinner",()=>a],84584);var r=e.i(67488);function s({title:e="Ein Fehler ist aufgetreten",message:a="Bitte versuchen Sie es später erneut.",onRetry:s,retryText:l="Erneut versuchen",centered:n=!1,icon:i,className:d="",...o}){let c=`
    ${n?"flex flex-col items-center justify-center min-h-[300px] text-center":"flex flex-col items-center text-center"}
    ${d}
  `,u=(0,t.jsx)("svg",{className:"h-16 w-16 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})});return(0,t.jsxs)("div",{className:c,role:"alert","aria-live":"assertive",...o,children:[(0,t.jsx)("div",{className:"mb-4",children:i||u}),(0,t.jsx)("h2",{className:"text-xl md:text-2xl font-semibold text-slate-900 mb-2",children:e}),"string"==typeof a?(0,t.jsx)("p",{className:"text-sm md:text-base text-slate-600 mb-6 max-w-md",children:a}):(0,t.jsx)("div",{className:"text-sm md:text-base text-slate-600 mb-6 max-w-md",children:a}),s&&(0,t.jsx)(r.Button,{variant:"primary",onClick:s,icon:(0,t.jsx)("svg",{className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,t.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})}),children:l})]})}e.s(["ErrorState",()=>s],52220)},32796,76107,e=>{"use strict";var t=e.i(18050);function a({variant:e="default",size:a="md",children:r,className:s=""}){return(0,t.jsx)("span",{className:`
        inline-flex items-center justify-center
        rounded-full border font-medium
        whitespace-nowrap
        ${{default:"bg-slate-100 dark:bg-slate-700 text-slate-700 dark:text-slate-300 border-slate-200 dark:border-slate-600",success:"bg-emerald-100 dark:bg-emerald-900/30 text-emerald-800 dark:text-emerald-400 border-emerald-200 dark:border-emerald-700",warning:"bg-amber-100 dark:bg-amber-900/30 text-amber-800 dark:text-amber-400 border-amber-200 dark:border-amber-700",danger:"bg-red-100 dark:bg-red-900/30 text-red-800 dark:text-red-400 border-red-200 dark:border-red-700",info:"bg-sky-100 dark:bg-sky-900/30 text-sky-800 dark:text-sky-400 border-sky-200 dark:border-sky-700",secondary:"bg-slate-50 dark:bg-slate-800 text-slate-600 dark:text-slate-400 border-slate-200 dark:border-slate-700"}[e]}
        ${{sm:"px-2 py-0.5 text-xs",md:"px-3 py-1 text-sm"}[a]}
        ${s}
      `,children:r})}e.s(["Badge",()=>a],32796),e.i(180);var r=e.i(53012);function s({title:e,description:a,actions:s,className:l=""}){return(0,t.jsxs)("div",{className:`flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4 ${l}`,style:{marginBottom:r.spacing.xl},children:[(0,t.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,t.jsx)("h1",{className:"text-2xl md:text-3xl font-bold text-slate-900 dark:text-slate-50 mb-2",children:e}),a&&(0,t.jsx)("p",{className:"text-base text-slate-600 dark:text-slate-300",children:a})]}),s&&(0,t.jsx)("div",{className:"flex flex-wrap gap-3 items-start shrink-0",children:s})]})}e.s(["PageHeader",()=>s],76107)},87130,e=>{"use strict";let t=(0,e.i(68569).default)("funnel",[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]]);e.s(["Filter",()=>t],87130)},7233,e=>{"use strict";let t=(0,e.i(68569).default)("plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);e.s(["Plus",()=>t],7233)},45423,e=>{"use strict";let t=(0,e.i(68569).default)("bell",[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]]);e.s(["Bell",()=>t],45423)},16715,e=>{"use strict";let t=(0,e.i(68569).default)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);e.s(["RefreshCw",()=>t],16715)},88844,e=>{"use strict";let t=(0,e.i(68569).default)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]);e.s(["Package",()=>t],88844)},58415,e=>{"use strict";var t=e.i(18050),a=e.i(71645);e.i(47446);var r=e.i(67488),s=e.i(12911),l=e.i(87052),n=e.i(84584),i=e.i(52220),d=e.i(32796),o=e.i(88844),c=e.i(7233),u=e.i(45423),x=e.i(63209),m=e.i(87130),h=e.i(16715),g=e.i(81307);let b="ordered",p="shipped",v="in_transit",k="delivered",j="returned",f="cancelled",y=g.z.enum([b,p,v,k,j,f]);function N(e){switch(e){case b:return"Bestellt";case p:return"Versendet";case v:return"Unterwegs";case k:return"Zugestellt";case j:return"Zurückgesendet";case f:return"Storniert";default:return e}}function w(e){switch(e){case b:return"bg-blue-100 text-blue-800 dark:bg-blue-900/30 dark:text-blue-300";case p:return"bg-purple-100 text-purple-800 dark:bg-purple-900/30 dark:text-purple-300";case v:return"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-300";case k:return"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-300";case j:return"bg-orange-100 text-orange-800 dark:bg-orange-900/30 dark:text-orange-300";case f:return"bg-gray-100 text-gray-800 dark:bg-gray-900/30 dark:text-gray-300";default:return"bg-slate-100 text-slate-800 dark:bg-slate-900/30 dark:text-slate-300"}}function z(e){if(!e.expected_delivery_at||e.status===k||e.status===j||e.status===f)return!1;let t=new Date(e.expected_delivery_at);return new Date>t}g.z.enum(["status_changed","tracking_updated","reminder_sent","note_added","return_requested","return_shipped"]),g.z.object({id:g.z.string().uuid(),patient_id:g.z.string().uuid(),task_id:g.z.string().uuid().nullable(),organization_id:g.z.string().uuid(),created_by_user_id:g.z.string().uuid().nullable(),device_type:g.z.string(),device_serial_number:g.z.string().nullable(),tracking_number:g.z.string().nullable(),carrier:g.z.string().nullable(),shipping_address:g.z.string().nullable(),status:y,ordered_at:g.z.string(),shipped_at:g.z.string().nullable(),delivered_at:g.z.string().nullable(),expected_delivery_at:g.z.string().nullable(),return_requested_at:g.z.string().nullable(),returned_at:g.z.string().nullable(),return_tracking_number:g.z.string().nullable(),return_carrier:g.z.string().nullable(),return_reason:g.z.string().nullable(),reminder_sent_at:g.z.string().nullable(),last_reminder_at:g.z.string().nullable(),reminder_count:g.z.number().int().min(0),notes:g.z.string().nullable(),metadata:g.z.record(g.z.string(),g.z.any()),created_at:g.z.string(),updated_at:g.z.string()}),g.z.object({id:g.z.string().uuid(),shipment_id:g.z.string().uuid(),created_by_user_id:g.z.string().uuid().nullable(),event_type:g.z.string(),event_status:y.nullable(),event_description:g.z.string().nullable(),location:g.z.string().nullable(),carrier:g.z.string().nullable(),tracking_number:g.z.string().nullable(),metadata:g.z.record(g.z.string(),g.z.any()),event_at:g.z.string(),created_at:g.z.string()}),g.z.object({patient_id:g.z.string().uuid(),task_id:g.z.string().uuid().optional(),device_type:g.z.string().min(1,"Device type is required"),device_serial_number:g.z.string().optional(),tracking_number:g.z.string().optional(),carrier:g.z.string().optional(),shipping_address:g.z.string().optional(),expected_delivery_at:g.z.string().optional(),notes:g.z.string().optional(),metadata:g.z.record(g.z.string(),g.z.any()).optional()}),g.z.object({status:y.optional(),tracking_number:g.z.string().optional(),carrier:g.z.string().optional(),shipping_address:g.z.string().optional(),device_serial_number:g.z.string().optional(),shipped_at:g.z.string().nullable().optional(),delivered_at:g.z.string().nullable().optional(),expected_delivery_at:g.z.string().nullable().optional(),return_requested_at:g.z.string().nullable().optional(),returned_at:g.z.string().nullable().optional(),return_tracking_number:g.z.string().nullable().optional(),return_carrier:g.z.string().nullable().optional(),return_reason:g.z.string().nullable().optional(),notes:g.z.string().nullable().optional(),metadata:g.z.record(g.z.string(),g.z.any()).optional()}),g.z.object({event_type:g.z.string(),event_description:g.z.string().optional(),location:g.z.string().optional(),carrier:g.z.string().optional(),tracking_number:g.z.string().optional(),metadata:g.z.record(g.z.string(),g.z.any()).optional()}),g.z.object({patient_id:g.z.string().uuid().optional(),task_id:g.z.string().uuid().optional(),status:y.optional(),device_type:g.z.string().optional(),needs_reminder:g.z.boolean().optional(),limit:g.z.number().int().min(1).max(100).optional()});var _=e.i(64389),S=e.i(56561),C=e.i(34683),L=e.i(74339),D=e.i(37727);function B({onClose:e,onShipmentCreated:l,initialPatientId:n,initialTaskId:i}){let[d,c]=(0,a.useState)(!1),[u,x]=(0,a.useState)(!0),[m,h]=(0,a.useState)(null),[g,b]=(0,a.useState)([]),[p,v]=(0,a.useState)(n||""),[k,j]=(0,a.useState)(""),[f,y]=(0,a.useState)(""),[N,w]=(0,a.useState)(""),[z,B]=(0,a.useState)(""),[E,F]=(0,a.useState)(""),[P,A]=(0,a.useState)(""),[T,$]=(0,a.useState)("");(0,a.useEffect)(()=>{(async()=>{try{x(!0);let e=await fetch("/api/patient-profiles");if(!e.ok)throw Error("Failed to load patients");let t=await e.json();b(t.data??[])}catch(e){console.error("Failed to load patients:",e),h("Fehler beim Laden der Patienten")}finally{x(!1)}})()},[]);let H=(0,a.useCallback)(async e=>{e.preventDefault(),h(null),c(!0);try{if(!p||!k)throw Error("Bitte Patient:in und Gerätetyp auswählen");let e=await fetch("/api/shipments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:p,task_id:i,device_type:k,device_serial_number:f||void 0,tracking_number:N||void 0,carrier:z||void 0,shipping_address:E||void 0,expected_delivery_at:P||void 0,notes:T||void 0})}),t=await e.json();if(!e.ok)throw Error(t.error?.message||"Fehler beim Erstellen der Sendung");l()}catch(e){console.error(e),h(e instanceof Error?e.message:"Fehler beim Erstellen der Sendung.")}finally{c(!1)}},[p,k,f,N,z,E,P,T,i,l]),M=g.map(e=>({value:e.id,label:e.full_name||e.user_id}));return(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:(0,t.jsxs)(s.Card,{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto mx-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6 p-6 border-b border-slate-200 dark:border-slate-700",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(o.Package,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"}),(0,t.jsx)("h2",{className:"text-2xl font-bold text-slate-900 dark:text-slate-50",children:"Neue Sendung erstellen"})]}),(0,t.jsx)("button",{onClick:e,className:"p-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",children:(0,t.jsx)(D.X,{className:"w-5 h-5 text-slate-600 dark:text-slate-400"})})]}),(0,t.jsxs)("form",{onSubmit:H,className:"p-6 space-y-6",children:[m&&(0,t.jsx)("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:(0,t.jsx)("p",{className:"text-sm text-red-800 dark:text-red-200",children:m})}),(0,t.jsxs)("div",{children:[(0,t.jsx)(L.Label,{htmlFor:"patient",children:"Patient:in *"}),(0,t.jsxs)(S.Select,{id:"patient",value:p,onChange:e=>v(e.target.value),required:!0,disabled:u||!!n,children:[(0,t.jsx)("option",{value:"",disabled:!0,children:u?"Lade Patienten...":"Patient:in auswählen"}),M.map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(L.Label,{htmlFor:"deviceType",children:"Gerätetyp *"}),(0,t.jsxs)(S.Select,{id:"deviceType",value:k,onChange:e=>j(e.target.value),required:!0,children:[(0,t.jsx)("option",{value:"",disabled:!0,children:"Gerätetyp auswählen"}),[{value:"EKG-Gerät",label:"EKG-Gerät"},{value:"Blutdruckmessgerät",label:"Blutdruckmessgerät"},{value:"Blutzuckermessgerät",label:"Blutzuckermessgerät"},{value:"Fitness-Tracker",label:"Fitness-Tracker"},{value:"Pulsoximeter",label:"Pulsoximeter"},{value:"Andere",label:"Andere"}].map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(L.Label,{htmlFor:"serialNumber",children:"Seriennummer (optional)"}),(0,t.jsx)(_.Input,{id:"serialNumber",type:"text",value:f,onChange:e=>y(e.target.value),placeholder:"z.B. SN123456"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(L.Label,{htmlFor:"carrier",children:"Versanddienstleister (optional)"}),(0,t.jsxs)(S.Select,{id:"carrier",value:z,onChange:e=>B(e.target.value),children:[(0,t.jsx)("option",{value:"",children:"Versanddienstleister auswählen"}),[{value:"DHL",label:"DHL"},{value:"DPD",label:"DPD"},{value:"Hermes",label:"Hermes"},{value:"UPS",label:"UPS"},{value:"FedEx",label:"FedEx"},{value:"GLS",label:"GLS"},{value:"Deutsche Post",label:"Deutsche Post"},{value:"Andere",label:"Andere"}].map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(L.Label,{htmlFor:"trackingNumber",children:"Tracking-Nummer (optional)"}),(0,t.jsx)(_.Input,{id:"trackingNumber",type:"text",value:N,onChange:e=>w(e.target.value),placeholder:"z.B. 1234567890"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(L.Label,{htmlFor:"shippingAddress",children:"Lieferadresse (optional)"}),(0,t.jsx)(C.Textarea,{id:"shippingAddress",value:E,onChange:e=>F(e.target.value),placeholder:"Straße, PLZ, Ort",rows:3})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(L.Label,{htmlFor:"expectedDeliveryDate",children:"Erwartete Lieferung (optional)"}),(0,t.jsx)(_.Input,{id:"expectedDeliveryDate",type:"date",value:P,onChange:e=>A(e.target.value)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(L.Label,{htmlFor:"notes",children:"Notizen (optional)"}),(0,t.jsx)(C.Textarea,{id:"notes",value:T,onChange:e=>$(e.target.value),placeholder:"Zusätzliche Informationen zur Sendung",rows:3})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,t.jsx)(r.Button,{type:"submit",disabled:d||!p||!k,className:"flex-1",children:d?"Wird erstellt...":"Sendung erstellen"}),(0,t.jsx)(r.Button,{type:"button",variant:"outline",onClick:e,disabled:d,children:"Abbrechen"})]})]})]})})}function E({shipment:e,onClose:l,onShipmentUpdated:n}){let[i,c]=(0,a.useState)(!1),[m,h]=(0,a.useState)(null),[g,y]=(0,a.useState)(null),[B,E]=(0,a.useState)(e.status),[F,P]=(0,a.useState)(e.tracking_number||""),[A,T]=(0,a.useState)(e.carrier||""),[$,H]=(0,a.useState)(e.return_tracking_number||""),[M,R]=(0,a.useState)(e.return_reason||""),[G,U]=(0,a.useState)(e.notes||""),K=z(e),V=function(e){switch(e){case b:return[p,f];case p:return[v,k,f];case v:return[k,f];case k:return[j];default:return[]}}(e.status),q=(0,a.useCallback)(async()=>{h(null),y(null),c(!0);try{let t={};if(B!==e.status&&(t.status=B),F!==e.tracking_number&&(t.tracking_number=F||null),A!==e.carrier&&(t.carrier=A||null),$!==e.return_tracking_number&&(t.return_tracking_number=$||null),M!==e.return_reason&&(t.return_reason=M||null),G!==e.notes&&(t.notes=G||null),0===Object.keys(t).length){h("Keine Änderungen vorgenommen"),c(!1);return}let a=await fetch(`/api/shipments/${e.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}),r=await a.json();if(!a.ok)throw Error(r.error?.message||"Fehler beim Aktualisieren der Sendung");y("Sendung erfolgreich aktualisiert"),setTimeout(()=>{n()},1500)}catch(e){console.error(e),h(e instanceof Error?e.message:"Fehler beim Aktualisieren der Sendung.")}finally{c(!1)}},[B,F,A,$,M,G,e,n]);return(0,t.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:(0,t.jsxs)(s.Card,{className:"w-full max-w-3xl max-h-[90vh] overflow-y-auto mx-4",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-6 p-6 border-b border-slate-200 dark:border-slate-700",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)(o.Package,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold text-slate-900 dark:text-slate-50",children:e.device_type}),(0,t.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,t.jsx)(d.Badge,{className:w(e.status),children:N(e.status)}),K&&(0,t.jsxs)("span",{className:"text-sm text-orange-600 font-medium flex items-center gap-1",children:[(0,t.jsx)(x.AlertCircle,{className:"w-4 h-4"}),"Überfällig"]})]})]})]}),(0,t.jsx)("button",{onClick:l,className:"p-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",children:(0,t.jsx)(D.X,{className:"w-5 h-5 text-slate-600 dark:text-slate-400"})})]}),(0,t.jsxs)("div",{className:"p-6 space-y-6",children:[m&&(0,t.jsx)("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:(0,t.jsx)("p",{className:"text-sm text-red-800 dark:text-red-200",children:m})}),g&&(0,t.jsx)("div",{className:"p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg",children:(0,t.jsx)("p",{className:"text-sm text-green-800 dark:text-green-200",children:g})}),(0,t.jsxs)("div",{children:[(0,t.jsx)(L.Label,{htmlFor:"status",children:"Status aktualisieren"}),(0,t.jsx)(S.Select,{id:"status",value:B,onChange:e=>E(e.target.value),children:Array.from(new Set([e.status,...V])).map(e=>(0,t.jsx)("option",{value:e,children:N(e)},e))})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"font-semibold text-slate-900 dark:text-slate-50",children:"Tracking-Informationen"}),(0,t.jsxs)("div",{children:[(0,t.jsx)(L.Label,{htmlFor:"carrier",children:"Versanddienstleister"}),(0,t.jsx)(S.Select,{id:"carrier",value:A,onChange:e=>T(e.target.value),children:[{value:"",label:"Kein Versanddienstleister"},{value:"DHL",label:"DHL"},{value:"DPD",label:"DPD"},{value:"Hermes",label:"Hermes"},{value:"UPS",label:"UPS"},{value:"FedEx",label:"FedEx"},{value:"GLS",label:"GLS"},{value:"Deutsche Post",label:"Deutsche Post"},{value:"Andere",label:"Andere"}].map(e=>(0,t.jsx)("option",{value:e.value,children:e.label},e.value))})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(L.Label,{htmlFor:"trackingNumber",children:"Tracking-Nummer"}),(0,t.jsx)(_.Input,{id:"trackingNumber",type:"text",value:F,onChange:e=>P(e.target.value),placeholder:"z.B. 1234567890"})]})]}),(B===j||e.status===j)&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("h3",{className:"font-semibold text-slate-900 dark:text-slate-50",children:"Rücksendeinformationen"}),(0,t.jsxs)("div",{children:[(0,t.jsx)(L.Label,{htmlFor:"returnTrackingNumber",children:"Rücksende-Tracking-Nummer"}),(0,t.jsx)(_.Input,{id:"returnTrackingNumber",type:"text",value:$,onChange:e=>H(e.target.value),placeholder:"z.B. 1234567890"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(L.Label,{htmlFor:"returnReason",children:"Grund für Rücksendung"}),(0,t.jsx)(C.Textarea,{id:"returnReason",value:M,onChange:e=>R(e.target.value),placeholder:"z.B. defekt, ungenutzt, etc.",rows:3})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)(L.Label,{htmlFor:"notes",children:"Notizen"}),(0,t.jsx)(C.Textarea,{id:"notes",value:G,onChange:e=>U(e.target.value),placeholder:"Zusätzliche Informationen zur Sendung",rows:3})]}),(0,t.jsxs)("div",{className:"bg-slate-50 dark:bg-slate-800/50 rounded-lg p-4 space-y-2",children:[(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-slate-600 dark:text-slate-400",children:"Erstellt am:"}),(0,t.jsx)("span",{className:"font-medium",children:new Date(e.created_at).toLocaleString("de-DE")})]}),e.expected_delivery_at&&(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-slate-600 dark:text-slate-400",children:"Erwartete Lieferung:"}),(0,t.jsx)("span",{className:`font-medium ${K?"text-orange-600":""}`,children:new Date(e.expected_delivery_at).toLocaleDateString("de-DE")})]}),(0,t.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,t.jsx)("span",{className:"text-slate-600 dark:text-slate-400",children:"Erinnerungen gesendet:"}),(0,t.jsxs)("span",{className:"font-medium flex items-center gap-1",children:[(0,t.jsx)(u.Bell,{className:"w-4 h-4"}),e.reminder_count]})]})]}),(0,t.jsxs)("div",{className:"flex gap-3 pt-4",children:[(0,t.jsx)(r.Button,{onClick:q,disabled:i,className:"flex-1",children:i?"Wird gespeichert...":"Änderungen speichern"}),(0,t.jsx)(r.Button,{variant:"outline",onClick:l,disabled:i,children:"Schließen"})]})]})]})})}function F(){let[e,g]=(0,a.useState)(!0),[y,_]=(0,a.useState)(null),[S,C]=(0,a.useState)([]),[L,D]=(0,a.useState)(!1),[F,P]=(0,a.useState)(null),[A,T]=(0,a.useState)("all"),[$,H]=(0,a.useState)(!1),M=(0,a.useCallback)(async()=>{try{g(!0),_(null);let e=new URLSearchParams;"all"!==A&&e.append("status",A),$&&e.append("needs_reminder","true");let t=await fetch(`/api/shipments?${e.toString()}`),a=await t.json();if(!t.ok)throw Error(a.error?.message||"Fehler beim Laden der Sendungen");C(a.data??[])}catch(e){console.error("Failed to load shipments:",e),_(e instanceof Error?e.message:"Fehler beim Laden der Sendungen.")}finally{g(!1)}},[A,$]);(0,a.useEffect)(()=>{M()},[M]);let R=(0,a.useCallback)(()=>{D(!1),M()},[M]),G=(0,a.useCallback)(()=>{P(null),M()},[M]),U=[{header:"Patient:in",accessor:e=>(0,t.jsx)("span",{className:"font-medium",children:e.patient_profiles?.full_name||e.patient_profiles?.user_id||"Unbekannt"})},{header:"Gerät",accessor:e=>(0,t.jsx)("span",{className:"text-sm",children:e.device_type})},{header:"Status",accessor:e=>{let a=z(e);return(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(d.Badge,{className:w(e.status),children:N(e.status)}),a&&(0,t.jsx)("span",{title:"Überfällig",className:"inline-flex",children:(0,t.jsx)(x.AlertCircle,{className:"w-4 h-4 text-orange-500"})})]})}},{header:"Tracking-Nr.",accessor:e=>(0,t.jsx)("span",{className:"text-sm font-mono",children:e.tracking_number||(0,t.jsx)("span",{className:"text-slate-400",children:"—"})})},{header:"Erwartete Lieferung",accessor:e=>{let a=e.expected_delivery_at;if(!a)return(0,t.jsx)("span",{className:"text-slate-400",children:"—"});let r=new Date(a),s=r<new Date;return(0,t.jsx)("span",{className:s?"text-orange-600 font-medium":"text-sm",children:r.toLocaleDateString("de-DE")})}},{header:"Erinnerungen",accessor:e=>(0,t.jsxs)("div",{className:"flex items-center gap-1",children:[(0,t.jsx)(u.Bell,{className:"w-4 h-4 text-slate-400"}),(0,t.jsx)("span",{className:"text-sm",children:e.reminder_count||0})]})},{header:"Erstellt am",accessor:e=>(0,t.jsx)("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:new Date(e.created_at).toLocaleDateString("de-DE")})}];return(0,t.jsxs)("div",{className:"container mx-auto px-4 py-8 max-w-7xl",children:[(0,t.jsxs)("div",{className:"flex items-center justify-between mb-8",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3",children:[(0,t.jsx)("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/30 rounded-lg",children:(0,t.jsx)(o.Package,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold text-slate-900 dark:text-slate-50",children:"Geräteversand"}),(0,t.jsx)("p",{className:"text-slate-600 dark:text-slate-400 mt-1",children:"Versandstatus verwalten und Erinnerungen senden"})]})]}),(0,t.jsx)(r.Button,{onClick:()=>D(!0),icon:(0,t.jsx)(c.Plus,{className:"w-4 h-4"}),children:"Neue Sendung"})]}),(0,t.jsx)(s.Card,{className:"mb-6 p-4",children:(0,t.jsxs)("div",{className:"flex items-center gap-4 flex-wrap",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(m.Filter,{className:"w-4 h-4 text-slate-500"}),(0,t.jsx)("label",{className:"text-sm font-medium text-slate-700 dark:text-slate-300",children:"Status:"}),(0,t.jsxs)("select",{value:A,onChange:e=>T(e.target.value),className:"px-3 py-1.5 border border-slate-300 dark:border-slate-600 rounded-lg bg-white dark:bg-slate-800 text-sm",children:[(0,t.jsx)("option",{value:"all",children:"Alle"}),(0,t.jsx)("option",{value:b,children:"Bestellt"}),(0,t.jsx)("option",{value:p,children:"Versendet"}),(0,t.jsx)("option",{value:v,children:"Unterwegs"}),(0,t.jsx)("option",{value:k,children:"Zugestellt"}),(0,t.jsx)("option",{value:j,children:"Zurückgesendet"}),(0,t.jsx)("option",{value:f,children:"Storniert"})]})]}),(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("input",{type:"checkbox",id:"overdueOnly",checked:$,onChange:e=>H(e.target.checked),className:"rounded border-slate-300 text-blue-600 focus:ring-blue-500"}),(0,t.jsx)("label",{htmlFor:"overdueOnly",className:"text-sm font-medium text-slate-700 dark:text-slate-300 cursor-pointer",children:"Nur überfällige Sendungen"})]}),(0,t.jsx)(r.Button,{variant:"outline",size:"sm",onClick:M,icon:(0,t.jsx)(h.RefreshCw,{className:"w-4 h-4"}),children:"Aktualisieren"})]})}),e?(0,t.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,t.jsx)(n.LoadingSpinner,{size:"lg"})}):y?(0,t.jsx)(i.ErrorState,{title:"Fehler beim Laden",message:y,retryText:"Erneut versuchen",onRetry:()=>{M()}}):0===S.length?(0,t.jsxs)(s.Card,{className:"p-12 text-center",children:[(0,t.jsx)(o.Package,{className:"w-12 h-12 text-slate-400 mx-auto mb-4"}),(0,t.jsx)("h3",{className:"text-lg font-semibold text-slate-900 dark:text-slate-50 mb-2",children:"Keine Sendungen vorhanden"}),(0,t.jsx)("p",{className:"text-slate-600 dark:text-slate-400 mb-6",children:"all"!==A||$?"Keine Sendungen entsprechen den Filterkriterien.":"Erstellen Sie eine neue Sendung, um zu beginnen."}),(0,t.jsx)(r.Button,{onClick:()=>D(!0),icon:(0,t.jsx)(c.Plus,{className:"w-4 h-4"}),children:"Neue Sendung erstellen"})]}):(0,t.jsxs)(s.Card,{children:[(0,t.jsx)(l.Table,{data:S,columns:U,onRowClick:e=>P(e),className:"cursor-pointer"}),(0,t.jsx)("div",{className:"px-6 py-4 border-t border-slate-200 dark:border-slate-700",children:(0,t.jsxs)("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:[S.length," ",1===S.length?"Sendung":"Sendungen"," angezeigt"]})})]}),L&&(0,t.jsx)(B,{onClose:()=>D(!1),onShipmentCreated:R}),F&&(0,t.jsx)(E,{shipment:F,onClose:()=>P(null),onShipmentUpdated:G})]})}e.s(["default",()=>F],58415)}]);

//# sourceMappingURL=b9a37e1224a2bb56.js.map