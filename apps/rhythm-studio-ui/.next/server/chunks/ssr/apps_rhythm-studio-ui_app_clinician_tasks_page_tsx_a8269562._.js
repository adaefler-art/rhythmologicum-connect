module.exports=[79097,a=>{"use strict";var b=a.i(87924),c=a.i(72131);a.i(59620);var d=a.i(8184),e=a.i(63548),f=a.i(61160),g=a.i(86071),h=a.i(63156),i=a.i(3706),j=a.i(11300),k=a.i(15618),l=a.i(16201),m=a.i(41710);let n=(0,a.i(70106).default)("circle-play",[["path",{d:"M9 9.003a1 1 0 0 1 1.517-.859l4.997 2.997a1 1 0 0 1 0 1.718l-4.997 2.997A1 1 0 0 1 9 14.996z",key:"kmsa83"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);var o=a.i(62722),p=a.i(69012),q=a.i(56757);let r="pending",s="in_progress",t="completed",u="cancelled",v=q.z.enum([r,s,t,u]),w={LDL_MEASUREMENT:"ldl_measurement",VIDEO_CALL:"video_call",DEVICE_SHIPMENT:"device_shipment",FOLLOW_UP:"follow_up",REVIEW_ASSESSMENT:"review_assessment",CONTACT_PATIENT:"contact_patient",SUPPORT_CASE:"support_case"},x=q.z.enum([w.LDL_MEASUREMENT,w.VIDEO_CALL,w.DEVICE_SHIPMENT,w.FOLLOW_UP,w.REVIEW_ASSESSMENT,w.CONTACT_PATIENT,w.SUPPORT_CASE]),y="clinician",z="nurse",A="admin",B=q.z.enum([y,z,A]);function C(a){switch(a){case w.LDL_MEASUREMENT:return"LDL-Messung";case w.VIDEO_CALL:return"Video-Call";case w.DEVICE_SHIPMENT:return"Geräteversand";case w.FOLLOW_UP:return"Follow-up";case w.REVIEW_ASSESSMENT:return"Assessment prüfen";case w.CONTACT_PATIENT:return"Patient kontaktieren";case w.SUPPORT_CASE:return"Support-Fall";default:return a}}function D(a){switch(a){case y:return"Arzt/Ärztin";case z:return"Pflegekraft";case A:return"Administrator";default:return a}}q.z.object({instructions:q.z.string().optional(),target_date:q.z.string().optional()}),q.z.object({meeting_link:q.z.string().url().optional(),scheduled_time:q.z.string().optional(),duration_minutes:q.z.number().int().positive().optional(),notes:q.z.string().optional()}),q.z.object({device_type:q.z.string(),tracking_number:q.z.string().optional(),shipping_address:q.z.string().optional(),notes:q.z.string().optional()}),q.z.object({description:q.z.string().optional(),notes:q.z.string().optional()}),q.z.object({id:q.z.string().uuid(),patient_id:q.z.string().uuid(),assessment_id:q.z.string().uuid().nullable(),created_by_role:B.nullable(),assigned_to_role:B,assigned_to_user_id:q.z.string().uuid().nullable(),task_type:x,payload:q.z.record(q.z.string(),q.z.any()),status:v,due_at:q.z.string().nullable(),created_at:q.z.string(),updated_at:q.z.string().nullable()}),q.z.object({patient_id:q.z.string().uuid(),assessment_id:q.z.string().uuid().optional(),assigned_to_role:B,assigned_to_user_id:q.z.string().uuid().optional(),task_type:x,payload:q.z.record(q.z.string(),q.z.any()).optional(),due_at:q.z.string().optional()}),q.z.object({status:v.optional(),payload:q.z.record(q.z.string(),q.z.any()).optional(),due_at:q.z.string().nullable().optional()}),q.z.object({patient_id:q.z.string().uuid().optional(),assessment_id:q.z.string().uuid().optional(),assigned_to_role:B.optional(),task_type:x.optional(),status:v.optional()}),a.i(53547);var E=a.i(28914),F=a.i(79341),G=a.i(98595),H=a.i(14300),I=a.i(26818),J=a.i(62497),K=a.i(33508);function L({onClose:a,onTaskCreated:f}){let[g,h]=(0,c.useState)(!1),[i,j]=(0,c.useState)(!0),[k,l]=(0,c.useState)(null),[m,n]=(0,c.useState)([]),[o,p]=(0,c.useState)(""),[q,r]=(0,c.useState)(w.LDL_MEASUREMENT),[s,t]=(0,c.useState)(y),[u,v]=(0,c.useState)(""),[x,A]=(0,c.useState)("");(0,c.useEffect)(()=>{(async()=>{try{j(!0);let a=await fetch("/api/patient-profiles");if(!a.ok)throw Error("Failed to load patients");let b=await a.json();n(b.data??[])}catch(a){console.error("Failed to load patients:",a),l("Fehler beim Laden der Patienten")}finally{j(!1)}})()},[]);let B=(0,c.useCallback)(async a=>{a.preventDefault(),l(null),h(!0);try{let a=await fetch("/api/tasks",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({patient_id:o,assigned_to_role:s,task_type:q,payload:x?{notes:x}:void 0,due_at:u||void 0})}),b=await a.json();if(!a.ok)throw Error(b.error?.message||"Failed to create task");f()}catch(a){console.error(a),l(a instanceof Error?a.message:"Fehler beim Erstellen der Aufgabe.")}finally{h(!1)}},[o,s,q,x,u,f]),E=Object.values(w).map(a=>({value:a,label:C(a)})),F=[y,z].map(a=>({value:a,label:D(a)})),L=m.map(a=>({value:a.id,label:a.full_name||a.user_id}));return(0,b.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50",children:(0,b.jsxs)(e.Card,{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto mx-4",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between mb-6 p-6 border-b border-slate-200 dark:border-slate-700",children:[(0,b.jsx)("h2",{className:"text-2xl font-bold text-slate-900 dark:text-slate-50",children:"Neue Aufgabe erstellen"}),(0,b.jsx)("button",{onClick:a,className:"p-2 rounded-lg hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors",children:(0,b.jsx)(K.X,{className:"w-5 h-5 text-slate-600 dark:text-slate-400"})})]}),(0,b.jsxs)("form",{onSubmit:B,className:"p-6 space-y-6",children:[k&&(0,b.jsx)("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg",children:(0,b.jsx)("p",{className:"text-sm text-red-800 dark:text-red-200",children:k})}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{htmlFor:"patient",children:"Patient:in *"}),(0,b.jsxs)(H.Select,{id:"patient",value:o,onChange:a=>p(a.target.value),required:!0,disabled:i,children:[(0,b.jsx)("option",{value:"",children:"Bitte wählen..."}),L.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))]}),i&&(0,b.jsx)("p",{className:"text-sm text-slate-500 dark:text-slate-400 mt-1",children:"Patienten werden geladen..."})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{htmlFor:"taskType",children:"Aufgabentyp *"}),(0,b.jsx)(H.Select,{id:"taskType",value:q,onChange:a=>r(a.target.value),required:!0,children:E.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{htmlFor:"assignedToRole",children:"Zuweisen an *"}),(0,b.jsx)(H.Select,{id:"assignedToRole",value:s,onChange:a=>t(a.target.value),required:!0,children:F.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{htmlFor:"dueDate",children:"Fälligkeitsdatum"}),(0,b.jsx)(G.Input,{id:"dueDate",type:"datetime-local",value:u,onChange:a=>v(a.target.value)})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(J.Label,{htmlFor:"notes",children:"Notizen"}),(0,b.jsx)(I.Textarea,{id:"notes",value:x,onChange:a=>A(a.target.value),placeholder:"Zusätzliche Informationen zur Aufgabe...",rows:4})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-3 pt-4 border-t border-slate-200 dark:border-slate-700",children:[(0,b.jsx)(d.Button,{type:"button",variant:"secondary",onClick:a,disabled:g,children:"Abbrechen"}),(0,b.jsx)(d.Button,{type:"submit",variant:"primary",loading:g,children:"Aufgabe erstellen"})]})]})]})})}function M(){let[a,q]=(0,c.useState)(!0),[v,w]=(0,c.useState)(null),[x,y]=(0,c.useState)([]),[z,A]=(0,c.useState)(!1),[B,G]=(0,c.useState)("all"),[H,I]=(0,c.useState)(null);(0,c.useEffect)(()=>{(async()=>{let{data:{user:a}}=await E.supabase.auth.getUser();a&&I((0,F.getUserRole)(a))})()},[]);let J=(0,c.useCallback)(async()=>{try{q(!0),w(null);let a=new URLSearchParams;"all"!==B&&a.append("status",B);let b=await fetch(`/api/tasks?${a.toString()}`),c=await b.json();if(!b.ok)throw Error(c.error?.message||"Fehler beim Laden der Aufgaben");y(c.data??[])}catch(a){console.error("Failed to load tasks:",a),w(a instanceof Error?a.message:"Fehler beim Laden der Aufgaben.")}finally{q(!1)}},[B]);(0,c.useEffect)(()=>{J()},[J]);let K=(0,c.useCallback)(()=>{A(!1),J()},[J]),M=(0,c.useCallback)(async(a,b)=>{try{let c=await fetch(`/api/tasks/${a}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:b})}),d=await c.json();if(!c.ok)throw Error(d.error?.message||"Fehler beim Aktualisieren der Aufgabe");J()}catch(a){console.error("Failed to update task status:",a),w(a instanceof Error?a.message:"Fehler beim Aktualisieren der Aufgabe.")}},[J]),N=(0,c.useCallback)(a=>{switch(a){case r:return"warning";case s:return"info";case t:return"success";case u:return"secondary";default:return"default"}},[]),O=(0,c.useCallback)(a=>{try{return new Intl.DateTimeFormat("de-DE",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}).format(new Date(a))}catch{return"Datum unbekannt"}},[]),P=(0,c.useMemo)(()=>{let a=x.length,b=x.filter(a=>a.status===r).length;return{total:a,pending:b,inProgress:x.filter(a=>a.status===s).length,completed:x.filter(a=>a.status===t).length}},[x]),Q=(0,c.useMemo)(()=>[{header:"Patient:in",accessor:a=>(0,b.jsx)("span",{className:"font-medium text-slate-900 dark:text-slate-50",children:a.patient_profiles?.full_name??"Unbekannt"}),sortable:!0},{header:"Aufgabe",accessor:a=>(0,b.jsx)("span",{className:"text-slate-900 dark:text-slate-50",children:C(a.task_type)}),sortable:!0},{header:"Zugewiesen an",accessor:a=>(0,b.jsx)("span",{className:"text-slate-700 dark:text-slate-300",children:D(a.assigned_to_role)}),sortable:!0},{header:"Status",accessor:a=>(0,b.jsx)(i.Badge,{variant:N(a.status),children:function(a){switch(a){case r:return"Ausstehend";case s:return"In Bearbeitung";case t:return"Abgeschlossen";case u:return"Abgebrochen";default:return a}}(a.status)}),sortable:!0},{header:"Fällig am",accessor:a=>a.due_at?(0,b.jsx)("span",{className:"text-slate-700 dark:text-slate-300 whitespace-nowrap",children:O(a.due_at)}):(0,b.jsx)("span",{className:"text-slate-400 dark:text-slate-500",children:"—"}),sortable:!0},{header:"Erstellt",accessor:a=>(0,b.jsx)("span",{className:"text-slate-600 dark:text-slate-400 text-sm whitespace-nowrap",children:O(a.created_at)}),sortable:!0},{header:"Aktionen",accessor:a=>(0,b.jsxs)("div",{className:"flex gap-2",children:[a.status===r&&(0,b.jsx)(d.Button,{variant:"secondary",size:"sm",icon:(0,b.jsx)(n,{className:"w-3 h-3"}),onClick:()=>M(a.id,s),children:"Starten"}),a.status===s&&(0,b.jsx)(d.Button,{variant:"primary",size:"sm",icon:(0,b.jsx)(l.CheckCircle,{className:"w-3 h-3"}),onClick:()=>M(a.id,t),children:"Erledigt"}),(a.status===r||a.status===s)&&(0,b.jsx)(d.Button,{variant:"danger",size:"sm",icon:(0,b.jsx)(o.XCircle,{className:"w-3 h-3"}),onClick:()=>M(a.id,u),children:"Abbrechen"})]})}],[N,O,M]);return a?(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsx)(g.LoadingSpinner,{size:"md",text:"Aufgaben werden geladen…"})}):v?(0,b.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,b.jsx)(h.ErrorState,{title:"Fehler beim Laden",message:v,onRetry:J,retryText:"Neu laden"})}):(0,b.jsxs)("div",{className:"w-full",children:[(0,b.jsxs)("div",{className:"mb-8 flex flex-col sm:flex-row sm:items-start sm:justify-between gap-4",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-3xl font-bold text-slate-900 dark:text-slate-50 mb-2",children:"Aufgaben"}),(0,b.jsx)("p",{className:"text-slate-600 dark:text-slate-300",children:"Verwalten Sie Aufgaben für Patienten"})]}),(0,b.jsx)(d.Button,{variant:"primary",size:"md",icon:(0,b.jsx)(k.Plus,{className:"w-4 h-4"}),onClick:()=>A(!0),children:"Neue Aufgabe"})]}),(0,b.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,b.jsx)(e.Card,{padding:"lg",shadow:"md",radius:"lg",children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-slate-500 dark:text-slate-400 mb-1",children:"Gesamt"}),(0,b.jsx)("p",{className:"text-3xl font-bold text-slate-900 dark:text-slate-50",children:P.total})]}),(0,b.jsx)("div",{className:"p-3 bg-slate-100 dark:bg-slate-800 rounded-lg",children:(0,b.jsx)(j.ClipboardList,{className:"w-5 h-5 text-slate-600 dark:text-slate-400"})})]})}),(0,b.jsx)(e.Card,{padding:"lg",shadow:"md",radius:"lg",children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-slate-500 dark:text-slate-400 mb-1",children:"Ausstehend"}),(0,b.jsx)("p",{className:"text-3xl font-bold text-slate-900 dark:text-slate-50",children:P.pending})]}),(0,b.jsx)("div",{className:"p-3 bg-amber-100 dark:bg-amber-900/30 rounded-lg",children:(0,b.jsx)(m.Clock,{className:"w-5 h-5 text-amber-600 dark:text-amber-400"})})]})}),(0,b.jsx)(e.Card,{padding:"lg",shadow:"md",radius:"lg",children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-slate-500 dark:text-slate-400 mb-1",children:"In Bearbeitung"}),(0,b.jsx)("p",{className:"text-3xl font-bold text-slate-900 dark:text-slate-50",children:P.inProgress})]}),(0,b.jsx)("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/30 rounded-lg",children:(0,b.jsx)(n,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})})]})}),(0,b.jsx)(e.Card,{padding:"lg",shadow:"md",radius:"lg",children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-slate-500 dark:text-slate-400 mb-1",children:"Abgeschlossen"}),(0,b.jsx)("p",{className:"text-3xl font-bold text-slate-900 dark:text-slate-50",children:P.completed})]}),(0,b.jsx)("div",{className:"p-3 bg-green-100 dark:bg-green-900/30 rounded-lg",children:(0,b.jsx)(l.CheckCircle,{className:"w-5 h-5 text-green-600 dark:text-green-400"})})]})})]}),(0,b.jsx)("div",{className:"mb-6",children:(0,b.jsx)(e.Card,{padding:"md",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(p.Filter,{className:"w-4 h-4 text-slate-500 dark:text-slate-400"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(d.Button,{variant:"all"===B?"primary":"secondary",size:"sm",onClick:()=>G("all"),children:"Alle"}),(0,b.jsx)(d.Button,{variant:B===r?"primary":"secondary",size:"sm",onClick:()=>G(r),children:"Ausstehend"}),(0,b.jsx)(d.Button,{variant:B===s?"primary":"secondary",size:"sm",onClick:()=>G(s),children:"In Bearbeitung"}),(0,b.jsx)(d.Button,{variant:B===t?"primary":"secondary",size:"sm",onClick:()=>G(t),children:"Abgeschlossen"})]})]})})}),"nurse"===H&&(0,b.jsx)("div",{className:"mb-6 p-4 bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg",children:(0,b.jsxs)("p",{className:"text-sm text-blue-900 dark:text-blue-100",children:[(0,b.jsx)("strong",{children:"Hinweis:"})," Sie sehen nur Aufgaben, die Ihnen zugewiesen wurden."]})}),(0,b.jsx)(f.Table,{columns:Q,data:x,keyExtractor:a=>a.id,hoverable:!0,bordered:!0,emptyMessage:"Noch keine Aufgaben vorhanden"}),z&&(0,b.jsx)(L,{onClose:()=>A(!1),onTaskCreated:K})]})}a.s(["default",()=>M],79097)}];

//# sourceMappingURL=apps_rhythm-studio-ui_app_clinician_tasks_page_tsx_a8269562._.js.map