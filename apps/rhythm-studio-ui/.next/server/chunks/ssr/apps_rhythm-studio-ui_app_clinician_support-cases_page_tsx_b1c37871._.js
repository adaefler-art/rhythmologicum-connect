module.exports=[43685,a=>{"use strict";var b=a.i(87924),c=a.i(72131);a.i(59620);var d=a.i(8184),e=a.i(63548),f=a.i(3706),g=a.i(86071),h=a.i(63156),i=a.i(92e3),j=a.i(69012),k=a.i(56757);let l={OPEN:"open",IN_PROGRESS:"in_progress",ESCALATED:"escalated",RESOLVED:"resolved",CLOSED:"closed"},m=k.z.enum([l.OPEN,l.IN_PROGRESS,l.ESCALATED,l.RESOLVED,l.CLOSED]),n={LOW:"low",MEDIUM:"medium",HIGH:"high",URGENT:"urgent"},o=k.z.enum([n.LOW,n.MEDIUM,n.HIGH,n.URGENT]),p="technical",q="medical",r="administrative",s="billing",t="general",u="other",v=k.z.enum([p,q,r,s,t,u]);function w(a){switch(a){case l.OPEN:return"Offen";case l.IN_PROGRESS:return"In Bearbeitung";case l.ESCALATED:return"Eskaliert";case l.RESOLVED:return"Gelöst";case l.CLOSED:return"Geschlossen";default:return a}}function x(a){switch(a){case n.LOW:return"Niedrig";case n.MEDIUM:return"Mittel";case n.HIGH:return"Hoch";case n.URGENT:return"Dringend";default:return a}}k.z.object({id:k.z.string().uuid(),patient_id:k.z.string().uuid(),organization_id:k.z.string().uuid().nullable(),created_by_user_id:k.z.string().uuid().nullable(),assigned_to_user_id:k.z.string().uuid().nullable(),escalated_task_id:k.z.string().uuid().nullable(),category:v,priority:o,status:m,subject:k.z.string(),description:k.z.string().nullable(),notes:k.z.string().nullable(),resolution_notes:k.z.string().nullable(),metadata:k.z.record(k.z.string(),k.z.any()).nullable(),escalated_at:k.z.string().nullable(),escalated_by_user_id:k.z.string().uuid().nullable(),created_at:k.z.string(),updated_at:k.z.string().nullable(),resolved_at:k.z.string().nullable(),closed_at:k.z.string().nullable()}),k.z.object({patient_id:k.z.string().uuid(),category:v.optional(),priority:o.optional(),subject:k.z.string().min(1,"Subject is required").max(200,"Subject too long"),description:k.z.string().optional(),metadata:k.z.record(k.z.string(),k.z.any()).optional()}),k.z.object({status:m.optional(),priority:o.optional(),assigned_to_user_id:k.z.string().uuid().nullable().optional(),description:k.z.string().nullable().optional(),notes:k.z.string().nullable().optional(),resolution_notes:k.z.string().nullable().optional(),metadata:k.z.record(k.z.string(),k.z.any()).optional()}),k.z.object({assigned_to_role:k.z.enum(["clinician","admin"]),assigned_to_user_id:k.z.string().uuid().optional(),escalation_notes:k.z.string().optional(),task_due_at:k.z.string().optional()}),k.z.object({patient_id:k.z.string().uuid().optional(),organization_id:k.z.string().uuid().optional(),assigned_to_user_id:k.z.string().uuid().optional(),category:v.optional(),priority:o.optional(),status:m.optional(),is_escalated:k.z.boolean().optional()});var y=a.i(33508),z=a.i(73570);function A({supportCase:a,onClose:e,onEscalate:f}){let[g,h]=(0,c.useState)("clinician"),[i,j]=(0,c.useState)(""),[k,l]=(0,c.useState)(!1),[m,n]=(0,c.useState)(null);async function o(a){a.preventDefault();try{l(!0),n(null),await f({assigned_to_role:g,escalation_notes:i.trim()||void 0})}catch(a){console.error("Error escalating:",a),n(a instanceof Error?a.message:"Fehler beim Eskalieren"),l(!1)}}return(0,b.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full",children:[(0,b.jsxs)("div",{className:"border-b border-gray-200 p-6 flex justify-between items-center",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(z.AlertTriangle,{size:24,className:"text-orange-600"}),(0,b.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Support-Fall eskalieren"})]}),(0,b.jsx)("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors",disabled:k,children:(0,b.jsx)(y.X,{size:24})})]}),(0,b.jsxs)("form",{onSubmit:o,className:"p-6 space-y-6",children:[m&&(0,b.jsx)("div",{className:"p-4 bg-red-50 border border-red-200 rounded text-red-800 text-sm",children:m}),(0,b.jsxs)("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded",children:[(0,b.jsxs)("p",{className:"text-sm text-blue-900",children:[(0,b.jsx)("strong",{children:"Betreff:"})," ",a.subject]}),a.description&&(0,b.jsxs)("p",{className:"text-sm text-blue-800 mt-2",children:[(0,b.jsx)("strong",{children:"Beschreibung:"})," ",a.description]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"assigned_to_role",className:"block text-sm font-medium text-gray-700 mb-2",children:"Rolle zuweisen"}),(0,b.jsxs)("select",{id:"assigned_to_role",value:g,onChange:a=>h(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:k,children:[(0,b.jsx)("option",{value:"clinician",children:"Arzt/Ärztin"}),(0,b.jsx)("option",{value:"admin",children:"Administrator"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"escalation_notes",className:"block text-sm font-medium text-gray-700 mb-2",children:"Eskalationsnotizen"}),(0,b.jsx)("textarea",{id:"escalation_notes",value:i,onChange:a=>j(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 min-h-[100px]",placeholder:"Grund für die Eskalation, wichtige Hinweise...",disabled:k})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[(0,b.jsx)(d.Button,{type:"button",onClick:e,disabled:k,className:"bg-gray-200 text-gray-700 hover:bg-gray-300",children:"Abbrechen"}),(0,b.jsx)(d.Button,{type:"submit",disabled:k,className:"bg-orange-600 hover:bg-orange-700",children:k?"Wird eskaliert...":"Eskalieren"})]})]})]})})}let B=(0,a.i(70106).default)("square-pen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]);function C({supportCase:a,onClose:e,onUpdate:f}){let[g,h]=(0,c.useState)(a.status),[i,j]=(0,c.useState)(a.priority),[k,m]=(0,c.useState)(a.notes||""),[o,p]=(0,c.useState)(a.resolution_notes||""),[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)(null),u=function(a){switch(a){case l.OPEN:return[l.IN_PROGRESS,l.ESCALATED,l.RESOLVED,l.CLOSED];case l.IN_PROGRESS:return[l.ESCALATED,l.RESOLVED,l.CLOSED];case l.ESCALATED:return[l.IN_PROGRESS,l.RESOLVED,l.CLOSED];case l.RESOLVED:return[l.CLOSED,l.OPEN];case l.CLOSED:return[l.OPEN];default:return[]}}(a.status);async function v(b){b.preventDefault();try{r(!0),t(null);let b={};g!==a.status&&(b.status=g),i!==a.priority&&(b.priority=i),k!==(a.notes||"")&&(b.notes=k.trim()||null),o!==(a.resolution_notes||"")&&(b.resolution_notes=o.trim()||null),await f(b)}catch(a){console.error("Error updating:",a),t(a instanceof Error?a.message:"Fehler beim Aktualisieren"),r(!1)}}return(0,b.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,b.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,b.jsxs)("div",{className:"sticky top-0 bg-white border-b border-gray-200 p-6 flex justify-between items-center",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(B,{size:24,className:"text-blue-600"}),(0,b.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Support-Fall bearbeiten"})]}),(0,b.jsx)("button",{onClick:e,className:"text-gray-400 hover:text-gray-600 transition-colors",disabled:q,children:(0,b.jsx)(y.X,{size:24})})]}),(0,b.jsxs)("form",{onSubmit:v,className:"p-6 space-y-6",children:[s&&(0,b.jsx)("div",{className:"p-4 bg-red-50 border border-red-200 rounded text-red-800 text-sm",children:s}),(0,b.jsx)("div",{className:"p-4 bg-gray-50 border border-gray-200 rounded",children:(0,b.jsxs)("p",{className:"text-sm text-gray-900",children:[(0,b.jsx)("strong",{children:"Betreff:"})," ",a.subject]})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),(0,b.jsxs)("select",{id:"status",value:g,onChange:a=>h(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:q,children:[(0,b.jsxs)("option",{value:a.status,children:[w(a.status)," (Aktuell)"]}),u.filter(b=>b!==a.status).map(a=>(0,b.jsx)("option",{value:a,children:w(a)},a))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"priority",className:"block text-sm font-medium text-gray-700 mb-2",children:"Priorität"}),(0,b.jsx)("select",{id:"priority",value:i,onChange:a=>j(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:q,children:Object.values(n).map(a=>(0,b.jsx)("option",{value:a,children:x(a)},a))})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700 mb-2",children:"Interne Notizen"}),(0,b.jsx)("textarea",{id:"notes",value:k,onChange:a=>m(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 min-h-[100px]",placeholder:"Interne Notizen (nicht für Patient sichtbar)...",disabled:q})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"resolution_notes",className:"block text-sm font-medium text-gray-700 mb-2",children:"Lösungsnotizen"}),(0,b.jsx)("textarea",{id:"resolution_notes",value:o,onChange:a=>p(a.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 min-h-[100px]",placeholder:"Wie wurde der Fall gelöst? (für Patient sichtbar)...",disabled:q})]}),(0,b.jsxs)("div",{className:"flex justify-end gap-3 pt-4 border-t border-gray-200",children:[(0,b.jsx)(d.Button,{type:"button",onClick:e,disabled:q,className:"bg-gray-200 text-gray-700 hover:bg-gray-300",children:"Abbrechen"}),(0,b.jsx)(d.Button,{type:"submit",disabled:q,children:q?"Wird gespeichert...":"Speichern"})]})]})]})})}function D(){let[a,k]=(0,c.useState)(!0),[m,o]=(0,c.useState)(null),[v,y]=(0,c.useState)([]),[z,B]=(0,c.useState)("all"),[D,E]=(0,c.useState)("all"),[F,G]=(0,c.useState)(null),[H,I]=(0,c.useState)(!1),[J,K]=(0,c.useState)(!1);async function L(){try{k(!0),o(null);let a=new URLSearchParams;"all"!==z&&a.append("status",z),"all"!==D&&a.append("priority",D);let b=await fetch(`/api/support-cases?${a.toString()}`),c=await b.json();if(!c.success)throw Error(c.error?.message||"Failed to load support cases");y(c.data||[])}catch(a){console.error("Error loading support cases:",a),o(a instanceof Error?a.message:"Failed to load support cases")}finally{k(!1)}}async function M(a,b){try{let c=await fetch(`/api/support-cases/${a}/escalate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)}),d=await c.json();if(!d.success)throw Error(d.error?.message||"Failed to escalate support case");await L(),I(!1),G(null)}catch(a){throw console.error("Error escalating support case:",a),a}}async function N(a,b){try{let c=await fetch(`/api/support-cases/${a}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)}),d=await c.json();if(!d.success)throw Error(d.error?.message||"Failed to update support case");await L(),K(!1),G(null)}catch(a){throw console.error("Error updating support case:",a),a}}return((0,c.useEffect)(()=>{L()},[z,D]),a)?(0,b.jsx)(g.LoadingSpinner,{text:"Lade Support-Fälle..."}):m?(0,b.jsx)(h.ErrorState,{message:m,onRetry:L}):(0,b.jsxs)("div",{className:"max-w-7xl mx-auto p-6 space-y-6",children:[(0,b.jsx)("div",{className:"flex justify-between items-center",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Support-Fälle"}),(0,b.jsx)("p",{className:"text-gray-600 mt-1",children:"Übersicht und Verwaltung aller Support-Anfragen"})]})}),(0,b.jsx)(e.Card,{className:"p-4",children:(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsx)(j.Filter,{size:20,className:"text-gray-500"}),(0,b.jsxs)("div",{className:"flex gap-4 flex-1",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"status-filter",className:"text-sm font-medium text-gray-700 mr-2",children:"Status:"}),(0,b.jsxs)("select",{id:"status-filter",value:z,onChange:a=>B(a.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm",children:[(0,b.jsx)("option",{value:"all",children:"Alle"}),Object.values(l).map(a=>(0,b.jsx)("option",{value:a,children:w(a)},a))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{htmlFor:"priority-filter",className:"text-sm font-medium text-gray-700 mr-2",children:"Priorität:"}),(0,b.jsxs)("select",{id:"priority-filter",value:D,onChange:a=>E(a.target.value),className:"px-3 py-1 border border-gray-300 rounded-md text-sm",children:[(0,b.jsx)("option",{value:"all",children:"Alle"}),Object.values(n).map(a=>(0,b.jsx)("option",{value:a,children:x(a)},a))]})]})]}),(0,b.jsxs)("div",{className:"text-sm text-gray-600",children:[v.length," ",1===v.length?"Fall":"Fälle"]})]})}),(0,b.jsx)("div",{className:"space-y-4",children:0===v.length?(0,b.jsxs)(e.Card,{className:"p-8 text-center",children:[(0,b.jsx)(i.AlertCircle,{size:48,className:"mx-auto text-gray-400 mb-4"}),(0,b.jsx)("p",{className:"text-gray-600",children:"Keine Support-Fälle gefunden."})]}):v.map(a=>(0,b.jsx)(e.Card,{className:"p-6 hover:shadow-md transition-shadow",children:(0,b.jsxs)("div",{className:"flex justify-between items-start",children:[(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,b.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:a.subject}),(0,b.jsx)(f.Badge,{className:function(a){switch(a){case l.OPEN:return"bg-blue-100 text-blue-800";case l.IN_PROGRESS:return"bg-yellow-100 text-yellow-800";case l.ESCALATED:return"bg-red-100 text-red-800";case l.RESOLVED:return"bg-green-100 text-green-800";case l.CLOSED:default:return"bg-gray-100 text-gray-800"}}(a.status),children:w(a.status)}),(0,b.jsx)(f.Badge,{className:function(a){switch(a){case n.LOW:return"bg-gray-100 text-gray-800";case n.MEDIUM:return"bg-blue-100 text-blue-800";case n.HIGH:return"bg-orange-100 text-orange-800";case n.URGENT:return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}}(a.priority),children:x(a.priority)})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600 mb-3",children:[(0,b.jsx)("span",{children:function(a){switch(a){case p:return"Technisch";case q:return"Medizinisch";case r:return"Administrativ";case s:return"Abrechnung";case t:return"Allgemein";case u:return"Sonstiges";default:return a}}(a.category)}),(0,b.jsx)("span",{children:"•"}),(0,b.jsxs)("span",{children:["Patient: ",a.patient_profiles?.full_name||"Unbekannt"]}),(0,b.jsx)("span",{children:"•"}),(0,b.jsx)("span",{children:new Date(a.created_at).toLocaleDateString("de-DE")}),a.escalated_at&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("span",{children:"•"}),(0,b.jsxs)("span",{className:"text-orange-600",children:["Eskaliert am"," ",new Date(a.escalated_at).toLocaleDateString("de-DE")]})]})]}),a.description&&(0,b.jsx)("p",{className:"text-gray-700 text-sm mb-3",children:a.description}),a.notes&&(0,b.jsxs)("div",{className:"mt-3 p-3 bg-blue-50 border border-blue-200 rounded",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-blue-800 mb-1",children:"Interne Notizen:"}),(0,b.jsx)("p",{className:"text-sm text-blue-700",children:a.notes})]}),a.resolution_notes&&(0,b.jsxs)("div",{className:"mt-3 p-3 bg-green-50 border border-green-200 rounded",children:[(0,b.jsx)("p",{className:"text-sm font-medium text-green-800 mb-1",children:"Lösung:"}),(0,b.jsx)("p",{className:"text-sm text-green-700",children:a.resolution_notes})]})]}),(0,b.jsxs)("div",{className:"flex gap-2 ml-4",children:[a.status!==l.ESCALATED&&a.status!==l.CLOSED&&!a.escalated_task_id&&(0,b.jsx)(d.Button,{onClick:()=>{G(a),I(!0)},className:"bg-orange-600 hover:bg-orange-700 text-white text-sm px-3 py-1",children:"Eskalieren"}),(0,b.jsx)(d.Button,{onClick:()=>{G(a),K(!0)},className:"bg-blue-600 hover:bg-blue-700 text-white text-sm px-3 py-1",children:"Bearbeiten"})]})]})},a.id))}),H&&F&&(0,b.jsx)(A,{supportCase:F,onClose:()=>{I(!1),G(null)},onEscalate:a=>M(F.id,a)}),J&&F&&(0,b.jsx)(C,{supportCase:F,onClose:()=>{K(!1),G(null)},onUpdate:a=>N(F.id,a)})]})}a.s(["default",()=>D],43685)}];

//# sourceMappingURL=apps_rhythm-studio-ui_app_clinician_support-cases_page_tsx_b1c37871._.js.map