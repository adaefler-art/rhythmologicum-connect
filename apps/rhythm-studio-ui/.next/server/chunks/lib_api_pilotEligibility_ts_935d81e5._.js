module.exports=[98473,e=>{"use strict";var r=e.i(19551),t=e.i(12892);function i(){return"true"===t.env.NEXT_PUBLIC_PILOT_ENABLED}function n(e){if(!i())return!1;let r=(t.env.PILOT_USER_ALLOWLIST||"").split(",").filter(Boolean);return!!(e.email&&r.includes(e.email)||r.includes(e.id))}function l(e){return!!i()&&(t.env.PILOT_ORG_ALLOWLIST||"").split(",").filter(Boolean).includes(e)}async function a(e){try{let t=await (0,r.createServerSupabaseClient)(),{data:i,error:n}=await t.from("user_profiles").select("metadata").eq("user_id",e).single();if(n||!i)return!1;let l=i.metadata;return l?.pilot_enabled===!0}catch(e){return console.error("Error checking user pilot flag:",e),!1}}async function o(e){try{let t=await (0,r.createServerSupabaseClient)(),{data:i,error:n}=await t.from("user_org_membership").select("organization_id, is_active").eq("user_id",e).eq("is_active",!0);if(n||!i||0===i.length)return!1;let l=i.map(e=>e.organization_id),{data:a,error:o}=await t.from("organizations").select("id, settings").in("id",l);if(o||!a)return!1;return a.some(e=>{let r=e.settings;return r?.pilot_enabled===!0})}catch(e){return console.error("Error checking org pilot flag:",e),!1}}async function s(e){return!!i()&&!!(n(e)||await a(e.id)||await o(e.id))}function c(){let e=t.env.NEXT_PUBLIC_PILOT_ENV||"production",r=t.env.NODE_ENV;return"all"===e||"staging"===e&&"production"!==r||"production"===e}async function u(e){return!!c()&&s(e)}e.s(["checkOrgPilotFlag",()=>o,"checkUserPilotFlag",()=>a,"isOrgInAllowlist",()=>l,"isPilotEligible",()=>s,"isPilotEligibleFull",()=>u,"isPilotEnabled",()=>i,"isPilotEnvironment",()=>c,"isUserInAllowlist",()=>n])}];

//# sourceMappingURL=lib_api_pilotEligibility_ts_935d81e5._.js.map